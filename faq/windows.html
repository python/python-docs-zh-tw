<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>在 Windows 使用 Python 的常見問答集 &#8212; Python 3.12.4 說明文件</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=41b4f12d" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=b20cc3f5" />
    
    <script src="../_static/documentation_options.js?v=6bff4b4f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=f1e884e3"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.12.4 說明文件 中搜尋"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="關於這些文件" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="copyright" title="版權" href="../copyright.html" />
    <link rel="next" title="圖形使用者介面常見問答集" href="gui.html" />
    <link rel="prev" title="擴充/嵌入常見問題集" href="extending.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/faq/windows.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" />
                <input type="submit" value="前往"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#">在 Windows 使用 Python 的常見問答集</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">如何在 Windows 作業系統裡運行 Python 程式？</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">如何使 Python 腳本可以執行？</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">為什麼 Python 有時需要這麼長的時間才能開始？</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">如何從 Python 腳本製作可執行檔？</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll"><code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> 檔是否與 DLL 相同？</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">如何將 Python 嵌入 Windows 應用程式中？</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">如何防止編輯器在我的 Python 原始碼中插入 tab？</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">如何在不阻塞的情況下檢查 keypress？</a></li>
<li><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">如何解決遺漏 api-ms-win-crt-runtime-l1-1-0.dll 的錯誤？</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="extending.html"
                          title="上一章">擴充/嵌入常見問題集</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="gui.html"
                          title="下一章">圖形使用者介面常見問答集</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/windows.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="gui.html" title="圖形使用者介面常見問答集"
             accesskey="N">下一頁</a> |</li>
        <li class="right" >
          <a href="extending.html" title="擴充/嵌入常見問題集"
             accesskey="P">上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python 常見問題</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">在 Windows 使用 Python 的常見問答集</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="python-on-windows-faq">
<span id="windows-faq"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">在 Windows 使用 Python 的常見問答集</a><a class="headerlink" href="#python-on-windows-faq" title="連結到這個標頭">¶</a></h1>
<nav class="contents" id="id1">
<p class="topic-title">目錄</p>
<ul class="simple">
<li><p><a class="reference internal" href="#python-on-windows-faq" id="id2">在 Windows 使用 Python 的常見問答集</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows" id="id3">如何在 Windows 作業系統裡運行 Python 程式？</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-python-scripts-executable" id="id4">如何使 Python 腳本可以執行？</a></p></li>
<li><p><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start" id="id5">為什麼 Python 有時需要這麼長的時間才能開始？</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script" id="id6">如何從 Python 腳本製作可執行檔？</a></p></li>
<li><p><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll" id="id7"><code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> 檔是否與 DLL 相同？</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application" id="id8">如何將 Python 嵌入 Windows 應用程式中？</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" id="id9">如何防止編輯器在我的 Python 原始碼中插入 tab？</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking" id="id10">如何在不阻塞的情況下檢查 keypress？</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error" id="id11">如何解決遺漏 api-ms-win-crt-runtime-l1-1-0.dll 的錯誤？</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="how-do-i-run-a-python-program-under-windows">
<span id="faq-run-program-under-windows"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">如何在 Windows 作業系統裡運行 Python 程式？</a><a class="headerlink" href="#how-do-i-run-a-python-program-under-windows" title="連結到這個標頭">¶</a></h2>
<p>這個問題的答案可能有點複雜。如果你經常使用「命令提示字元」執行程式，那這對你來說不會是什麼難事。如果不然，那就需要更仔細的說明了。</p>
<p>除非你使用某種整合開發環境，否則你最終將會在所謂的「命令提示字元視窗」中 <em>打字輸入</em> Windows 命令。通常，你可以透過從搜尋欄中搜尋 <code class="docutils literal notranslate"><span class="pre">cmd</span></code> 來建立這樣的視窗。你應該能夠認出何時已啟動這樣的視窗，因為你將看到 Windows「命令提示字元」，它通常看起來像這樣：</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span>
</pre></div>
</div>
<p>第一個字母可能不一樣，且後面也可能還有其他內容，因此你可能會很容易看到類似以下的文字：</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">D:\YourName\Projects\Python&gt;</span>
</pre></div>
</div>
<p>取決於你的電腦如何被設置，以及你最近對它所做的其他操作。一旦你啟動了這樣一個視窗，你就即將可以運行 Python 程式了。</p>
<p>你需要了解，你的 Python 腳本必須被另一個稱為 Python <em>直譯器</em>的程序來處理。直譯器會讀取你的腳本，將其編譯為位元組碼，然後執行該位元組碼以運行你的程式。那麼，你要如何安排直譯器來處理你的 Python 呢？</p>
<p>首先，你需要確保你的命令視窗會將單字 &quot;py&quot; 識別為啟動直譯器的指令。如果你已經開啟一個命令視窗，則你應該試試輸入命令 <code class="docutils literal notranslate"><span class="pre">py</span></code> 並按下 return 鍵：</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\Users\YourName&gt;</span> py
</pre></div>
</div>
<p>然後，你應該看到類似下面的內容：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45) [MSC v.1900 32 bit (Intel)] on win32</span>
<span class="go">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>你已經啟動直譯器中的「互動模式」。這表示你能夠以互動方式輸入 Python 陳述式或運算式，並在等待時執行或計算它們。這是 Python 最強大的功能之一。輸入你所選的幾個運算式並查看結果，可以檢驗此功能：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;Hello&quot;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="go">&#39;HelloHelloHello&#39;</span>
</pre></div>
</div>
<p>許多人將互動模式作為方便但可高度程式化的計算機。如果你要結束互動式 Python 對話，請呼叫 <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> 函式或是按住 <kbd class="kbd docutils literal notranslate">Ctrl</kbd> 鍵再輸入 <kbd class="kbd docutils literal notranslate">Z</kbd>，然後按下 &quot;<kbd class="kbd docutils literal notranslate">Enter</kbd>&quot; 鍵以返回 Windows 命令提示字元。</p>
<p>你可能還會發現你有一個開始功能表項目，像是：<span class="menuselection">開始 ‣ 所有程式 ‣ Python 3.x ‣ Python（命令行）</span>，它會讓你在一個新視窗中看到 <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> 提示字元。如果是這樣，該視窗將在你呼叫 <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> 函式或輸入 <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>-<kbd class="kbd docutils literal notranslate">Z</kbd></kbd> 字元後消失；Windows 正在該視窗中運行單一個「python」命令，並在你終止直譯器時將其關閉。</p>
<p>現在我們知道 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令已被識別，而你可以將你的 Python 腳本提供給它。你必須為 Python 腳本給定絕對路徑或相對路徑。假設你的 Python 腳本位於桌面上，並被命名為 <code class="docutils literal notranslate"><span class="pre">hello.py</span></code>，且你的命令提示字元在你的家目錄 (home directory) 中順利地被開啟，那麼你就會看到類似以下的內容：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt;
</pre></div>
</div>
<p>因此，現在你將透過鍵入 <code class="docutils literal notranslate"><span class="pre">py</span></code> 加上腳本路徑，來使用 <code class="docutils literal notranslate"><span class="pre">py</span></code> 命令將你的腳本提供給 Python：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt; py Desktop\hello.py
hello
</pre></div>
</div>
</section>
<section id="how-do-i-make-python-scripts-executable">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">如何使 Python 腳本可以執行？</a><a class="headerlink" href="#how-do-i-make-python-scripts-executable" title="連結到這個標頭">¶</a></h2>
<p>在 Windows 上，標準的 Python 安裝程式已將 .py 副檔名與一種檔案類型 (Python.File) 進行關聯，並為該檔案類型提供一個開啟命令來運行直譯器 (<code class="docutils literal notranslate"><span class="pre">D:\Program</span> <span class="pre">Files\Python\python.exe</span> <span class="pre">&quot;%1&quot;</span> <span class="pre">%*</span></code>)。這足以使腳本能以類似 'foo.py' 的形式從命令提示字元被執行。如果你希望能夠簡單地輸入 'foo' 來執行腳本，而不用加上副檔名，則需要將 .py 新增至 PATHEXT 環境變數中。</p>
</section>
<section id="why-does-python-sometimes-take-so-long-to-start">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">為什麼 Python 有時需要這麼長的時間才能開始？</a><a class="headerlink" href="#why-does-python-sometimes-take-so-long-to-start" title="連結到這個標頭">¶</a></h2>
<p>通常 Python 在 Windows 上啟動得非常快，但偶爾會有一些錯誤報告，內容是 Python 突然開始需要很長的時間才能啟動。這種情形更令人費解，因為 Python 在其他 Windows 系統上可以正常工作，而那些系統似乎也有相同的配置。</p>
<p>這個問題可能是由發生此問題的電腦上的病毒檢查軟體配置錯誤所引起的。目前已知某些病毒掃描程式，在它們被配置為監視來自檔案系統的所有讀取時，會引入兩個數量級的啟動負擔。請試著檢查您系統上的病毒掃描軟體配置，以確保它們的配置確實相同。當 McAfee 被配置為掃描所有檔案系統的讀取活動時，它是一個特定的違規者。</p>
</section>
<section id="how-do-i-make-an-executable-from-a-python-script">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">如何從 Python 腳本製作可執行檔？</a><a class="headerlink" href="#how-do-i-make-an-executable-from-a-python-script" title="連結到這個標頭">¶</a></h2>
<p>請參閱<a class="reference internal" href="programming.html#faq-create-standalone-binary"><span class="std std-ref">如何從 Python 腳本建立獨立的二進位檔案？</span></a>該章節列出了用於製作可執行檔的工具清單。</p>
</section>
<section id="is-a-pyd-file-the-same-as-a-dll">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> 檔是否與 DLL 相同？</a><a class="headerlink" href="#is-a-pyd-file-the-same-as-a-dll" title="連結到這個標頭">¶</a></h2>
<p>是的，.pyd 檔類似於 dll，但也有一些區別。如果你有一個名為 <code class="docutils literal notranslate"><span class="pre">foo.pyd</span></code> 的 DLL，則它必須具有函式 <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code>。接著你可以將 &quot;import foo&quot; 寫入 Python 腳本，Python 將會搜尋 foo.pyd（以及 foo.py、foo.pyc），如果 Python 找到它，將會嘗試呼叫 <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code> 來將它初始化。你並不會將你的 .exe 與 foo.lib 連結 (link)，因為這會導致 Windows 要求 DLL 的存在。</p>
<p>請注意，foo.pyd 的搜尋路徑是 PYTHONPATH，與 Windows 用於搜尋 foo.dll 的路徑不同。此外，foo.pyd 不需存在即可運行你的程式，然而如果你將程式連結了一個 dll，則該 dll 會是必要的。當然，如果你想要 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">foo</span></code>，foo.pyd 就是必要的。在 DLL 中，連結是以 <code class="docutils literal notranslate"><span class="pre">__declspec(dllexport)</span></code> 在原始碼中被宣告。在 .pyd 中，連結是在一個可用函式的 list（串列）中被定義。</p>
</section>
<section id="how-can-i-embed-python-into-a-windows-application">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">如何將 Python 嵌入 Windows 應用程式中？</a><a class="headerlink" href="#how-can-i-embed-python-into-a-windows-application" title="連結到這個標頭">¶</a></h2>
<p>在 Windows 應用程式中嵌入 Python 直譯器的過程可以總結如下：</p>
<ol class="arabic">
<li><p><strong>不要</strong>直接將 Python 建置到你的 .exe 檔中。在 Windows 上，Python 必須是一個 DLL 來處理模組的 import，而那些模組本身也是 DLL。（這是第一個未正式記載的關鍵事實。）請改為連結到 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>；它通常被安裝在 <code class="docutils literal notranslate"><span class="pre">C:\Windows\System</span></code> 中。<em>NN</em> 是 Python 版本，例如 &quot;33&quot; 就是指 Python 3.3。</p>
<p>你可以透過兩種不同的方式連結到 Python。載入時連結 (load-time linking) 表示要連結到 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code>，而執行環境連結 (run-time linking) 表示要連結到 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>。（一般註解：<code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code> 是 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> 相對應的所謂 &quot;import lib&quot;。它只會為鏈接器定義符號。）</p>
<p>執行環境連結大大簡化了連結選項；所有事情都會發生在執行環境。你的程式碼必須使用 Windows <code class="docutils literal notranslate"><span class="pre">LoadLibraryEx()</span></code> 常式 (routine) 來載入 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>。該程式碼也必須用 Windows <code class="docutils literal notranslate"><span class="pre">GetProcAddress()</span></code> 常式所取得的指標，來使用 <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> 中的（即為 Python C API 的）存取常式和資料。對於任何呼叫 Python C API 常式的 C 程式碼，巨集可以讓使用這些指標的過程透明化。</p>
</li>
<li><p>如果你使用 SWIG，則可輕鬆地建立一個 Python 「擴充模組」，該模組將使應用程式的資料和 method（方法）可供 Python 使用。SWIG 會為你處理幾乎所有的繁瑣細節。結果就是，你會將 C 程式碼連結<em>到</em>你的 .exe 檔裡（！）你<strong>不必</strong>建立 DLL 檔，而這也簡化了連結。</p></li>
<li><p>SWIG 將建立一個 init 函式（一個 C 函式），其名稱取決於擴充模組的名稱。例如，如果模組的名稱是 leo，則該 init 函式會命名為 initleo()。如果你使用 SWIG shadow class（類別），則 init 函式會命名為 initleoc()。這會初始化被 shadow class 所用的大多數隱藏的 helper class。</p>
<p>你可以將步驟 2 中的 C 程式碼連結到 .exe 檔中的原因是，呼叫初始化函式就等效於 import 模組進 Python！（這是第二個未正式記載的關鍵事實。）</p>
</li>
<li><p>簡而言之，你可以使用以下程式碼，以你的擴充模組初始化 Python 直譯器。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Python.h&gt;</span>
<span class="p">...</span>
<span class="n">Py_Initialize</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize Python.</span>
<span class="n">initmyAppc</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize (import) the helper class.</span>
<span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">&quot;import myApp&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Import the shadow class.</span>
</pre></div>
</div>
</li>
<li><p>Python 的 C API 有兩個問題，如果你使用 MSVC（用於建置 pythonNN.dll 的編譯器）以外的編譯器，這些問題將會變得明顯。</p>
<p>問題 1：使用 <code class="docutils literal notranslate"><span class="pre">FILE</span> <span class="pre">*</span></code> 引數的所謂「非常高階」的函式，在多編譯器 (multi-compiler) 的環境中會無法作用，因為每個編譯器對 <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">FILE</span></code> 的概念不同。從實作的觀點來看，這些都是非常_低階_的函式。</p>
<p>問題 2：SWIG 在為 void 函式產生包裝函式 (wrapper) 時會產生以下程式碼：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">Py_None</span><span class="p">);</span>
<span class="n">_resultobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_None</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="n">_resultobj</span><span class="p">;</span>
</pre></div>
</div>
<p>唉，Py_None 是一個巨集，它會延伸到一個參照，指向 pythonNN.dll 內部的一種稱為 _Py_NoneStruct 的複雜資料結構。同樣的，此程式碼在多編譯器環境中將會失效。請將此類程式碼替換為：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">return</span><span class="w"> </span><span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>有可能可以使用 SWIG 的 <code class="docutils literal notranslate"><span class="pre">%typemap</span></code> 命令以自動進行程式碼變更，雖然我未曾這樣正常運作過（我是一個完全的 SWIG 新手）。</p>
</li>
<li><p>使用 Python shell 腳本從你的 Windows 應用程式內部建造一個 Python 直譯器視窗不是一個好主意；該視窗將會獨立於你的應用程式視窗系統。與其如此，你（或 wxPythonWindow class）應該要建立一個「本機」直譯器視窗。將該視窗連接到 Python 直譯器是很容易的。你可以將 Python 的 i/o 重定向 (redirect) 到可支援讀取和寫入的任何物件，因此你只需要一個包含 read() 和 write() method 的 Python 物件（在你的擴充模組中被定義）就可以了。</p></li>
</ol>
</section>
<section id="how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">如何防止編輯器在我的 Python 原始碼中插入 tab？</a><a class="headerlink" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" title="連結到這個標頭">¶</a></h2>
<p>FAQ 不建議使用 tab，且 Python 風格指南 <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0008/"><strong>PEP 8</strong></a> 建議在分散式 Python 程式碼使用 4 個空格；這也是 Emacs 的 python 模式預設值。</p>
<p>在任何編輯器下，將 tab 和空格混合都是一個壞主意。MSVC 在這方面也是一樣，且可以輕鬆配置為使用空格：選擇<span class="menuselection">工具 ‣ 選項 ‣ Tabs</span>，然後對於「預設」檔案類型，將「Tab 大小」和「縮排大小」設定為 4，然後選擇「插入空格」單選鈕。</p>
<p>如果混合 tab 和空格造成前導空白字元出現問題，則 Python 會引發 <a class="reference internal" href="../library/exceptions.html#IndentationError" title="IndentationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IndentationError</span></code></a> 或 <a class="reference internal" href="../library/exceptions.html#TabError" title="TabError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TabError</span></code></a>。你也可以運行 <a class="reference internal" href="../library/tabnanny.html#module-tabnanny" title="tabnanny: Tool for detecting white space related problems in Python source files in a directory tree."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabnanny</span></code></a> 模組，在批次模式下檢查目錄樹。</p>
</section>
<section id="how-do-i-check-for-a-keypress-without-blocking">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">如何在不阻塞的情況下檢查 keypress？</a><a class="headerlink" href="#how-do-i-check-for-a-keypress-without-blocking" title="連結到這個標頭">¶</a></h2>
<p>使用 <a class="reference internal" href="../library/msvcrt.html#module-msvcrt" title="msvcrt: Miscellaneous useful routines from the MS VC++ runtime. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msvcrt</span></code></a> 模組。這是一個標準的 Windows 專用擴充模組。它定義了一個函式 <code class="docutils literal notranslate"><span class="pre">kbhit()</span></code>，該函式會檢查是否出現鍵盤打擊 (keyboard hit)，以及函式 <code class="docutils literal notranslate"><span class="pre">getch()</span></code>，該函式會取得一個字元且不會將其印出。</p>
</section>
<section id="how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">如何解決遺漏 api-ms-win-crt-runtime-l1-1-0.dll 的錯誤？</a><a class="headerlink" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error" title="連結到這個標頭">¶</a></h2>
<p>使用 Windows 8.1 或更早版本時，若尚未安裝所有的更新，則可能會在 Python 3.5 以上的版本發生這種情況。首先要確保你的作業系統仍受支援並且是最新的，如果這無法解決問題，請造訪  <a class="reference external" href="https://support.microsoft.com/en-us/help/3118401/">Microsoft 支援頁面</a>以取得關於手動安裝 C Runtime 更新的指南。</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#">在 Windows 使用 Python 的常見問答集</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">如何在 Windows 作業系統裡運行 Python 程式？</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">如何使 Python 腳本可以執行？</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">為什麼 Python 有時需要這麼長的時間才能開始？</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">如何從 Python 腳本製作可執行檔？</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll"><code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> 檔是否與 DLL 相同？</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">如何將 Python 嵌入 Windows 應用程式中？</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">如何防止編輯器在我的 Python 原始碼中插入 tab？</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">如何在不阻塞的情況下檢查 keypress？</a></li>
<li><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">如何解決遺漏 api-ms-win-crt-runtime-l1-1-0.dll 的錯誤？</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="extending.html"
                          title="上一章">擴充/嵌入常見問題集</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="gui.html"
                          title="下一章">圖形使用者介面常見問答集</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/windows.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="收合側邊欄">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="gui.html" title="圖形使用者介面常見問答集"
             >下一頁</a> |</li>
        <li class="right" >
          <a href="extending.html" title="擴充/嵌入常見問題集"
             >上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 常見問題</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">在 Windows 使用 Python 的常見問答集</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    版權
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="/license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最後更新於 Jul 20, 2024 (06:27 UTC)。
    
      <a href="/bugs.html">Found a bug</a>?
    
    <br />

    使用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.6 建立。
    </div>

  </body>
</html>