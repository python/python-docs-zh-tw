<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>wsgiref --- WSGI 工具與參考實作 &#8212; Python 3.12.4 說明文件</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=41b4f12d" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=b20cc3f5" />
    
    <script src="../_static/documentation_options.js?v=6bff4b4f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=f1e884e3"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.12.4 說明文件 中搜尋"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="關於這些文件" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="copyright" title="版權" href="../copyright.html" />
    <link rel="next" title="urllib --- URL 處理模組" href="urllib.html" />
    <link rel="prev" title="webbrowser --- 方便的網頁瀏覽器控制器" href="webbrowser.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/library/wsgiref.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" />
                <input type="submit" value="前往"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code> --- WSGI 工具與參考實作</a><ul>
<li><a class="reference internal" href="#module-wsgiref.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code> -- WSGI 環境工具</a></li>
<li><a class="reference internal" href="#module-wsgiref.headers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.headers</span></code> -- WSGI 回應標頭工具</a></li>
<li><a class="reference internal" href="#module-wsgiref.simple_server"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.simple_server</span></code> -- 一個簡單的 WSGI HTTP 伺服器</a></li>
<li><a class="reference internal" href="#module-wsgiref.validate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.validate</span></code> --- WSGI 符合性檢查</a></li>
<li><a class="reference internal" href="#module-wsgiref.handlers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handlers</span></code> -- 伺服器 / 閘道基本類別</a></li>
<li><a class="reference internal" href="#module-wsgiref.types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.types</span></code> -- 用於靜態型別檢查的 WSGI 型別</a></li>
<li><a class="reference internal" href="#examples">範例</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="webbrowser.html"
                          title="上一章"><code class="xref py py-mod docutils literal notranslate"><span class="pre">webbrowser</span></code> --- 方便的網頁瀏覽器控制器</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="urllib.html"
                          title="下一章"><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib</span></code> --- URL 處理模組</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/wsgiref.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="urllib.html" title="urllib --- URL 處理模組"
             accesskey="N">下一頁</a> |</li>
        <li class="right" >
          <a href="webbrowser.html" title="webbrowser --- 方便的網頁瀏覽器控制器"
             accesskey="P">上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準函式庫 (Standard Library)</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="internet.html" accesskey="U">網路協定 (Internet protocols) 及支援</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code> --- WSGI 工具與參考實作</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-wsgiref">
<span id="wsgiref-wsgi-utilities-and-reference-implementation"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code> --- WSGI 工具與參考實作<a class="headerlink" href="#module-wsgiref" title="連結到這個標頭">¶</a></h1>
<p><strong>原始碼：</strong><a class="extlink-source reference external" href="https://github.com/python/cpython/tree/3.12/Lib/wsgiref">Lib/wsgiref</a></p>
<hr class="docutils" />
<p>網頁伺服器閘道介面 (WSGI) 是一個標準介面，用於連接網頁伺服器軟體與使用 Python 撰寫的網頁應用程式，擁有一個標準介面使得支援 WSGI 的應用程式可以與多個不同的網頁伺服器運行。</p>
<p>只有網頁伺服器與程式框架的作者需要瞭解 WSGI 設計的每個細節與邊角案例，你並不需要為了安裝 WSGI 應用程式或是使用現有框架撰寫網頁應用程式而必須理解每個細節。</p>
<p><a class="reference internal" href="#module-wsgiref" title="wsgiref: WSGI Utilities and Reference Implementation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code></a> 是 WSGI 規格的參考實作，可用於新增 WSGI 來支援網頁伺服器或框架，它提供操作 WSGI 環境變數以及回應標頭的工具，用於實作 WSGI 伺服器的基本類別，提供用於示範 HTTP 伺服器的 WSGI 應用程式、靜態型別檢查、以及驗證 WSGI 伺服器與應用程式是否符合 WSGI 規格的驗證工具 (<span class="target" id="index-38"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a>)。</p>
<p>參閱 <a class="reference external" href="https://wsgi.readthedocs.io/">wsgi.readthedocs.io</a> 更多 WSGI 相關資訊，以及教學連結與其他資源。</p>
<section id="module-wsgiref.util">
<span id="wsgiref-util-wsgi-environment-utilities"></span><h2><a class="reference internal" href="#module-wsgiref.util" title="wsgiref.util: WSGI environment utilities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code></a> -- WSGI 環境工具<a class="headerlink" href="#module-wsgiref.util" title="連結到這個標頭">¶</a></h2>
<p>這個模組提供許多用於處理 WSGI 環境運作的功能。WSGI 環境是一個包含 HTTP 請求變數的字典，如 <span class="target" id="index-39"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 所述。所有接受 <em>environ</em> 的參數的函式都需要提供符合 WSGI 標準的字典；請參閱 <span class="target" id="index-40"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 獲取詳細規格，以及 <a class="reference internal" href="#wsgiref.types.WSGIEnvironment" title="wsgiref.types.WSGIEnvironment"><code class="xref py py-data docutils literal notranslate"><span class="pre">WSGIEnvironment</span></code></a> 獲取可用於使用型別註釋的型別別名。</p>
<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.guess_scheme">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">guess_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.guess_scheme" title="連結到這個定義">¶</a></dt>
<dd><p>透過檢查 <em>environ</em> 字典中的 <code class="docutils literal notranslate"><span class="pre">HTTPS</span></code> 環境變數，回傳 <code class="docutils literal notranslate"><span class="pre">wsgi.url_scheme</span></code> 應該是 &quot;http&quot; 或 &quot;https&quot; 的猜測。回傳值為一個字串。</p>
<p>當建立一個包裝 CGI 或類似 FastCGI 的 CGI-like 協議閘道時，此函式非常有用。例如 FastCGI，通常提供這類協議的伺服器在通過 SSL 接收到請求時會包含 &quot;1&quot;，&quot;yes&quot;，或 &quot;on&quot; 的 <code class="docutils literal notranslate"><span class="pre">HTTPS</span></code> 變數，因此，如果找到這樣的值，此函式回傳 &quot;https&quot;，否則回傳 &quot;http&quot;。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.request_uri">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">request_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.request_uri" title="連結到這個定義">¶</a></dt>
<dd><p>根據 <span class="target" id="index-41"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 中 &quot;URL Reconstruction&quot; 章節所找到的演算法，回傳完整的請求 URI，可選擇性的包含查詢字串，如果 <em>include_query</em> 設為 false，查詢字串不會被包含在結果的 URI 中。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.application_uri">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">application_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.application_uri" title="連結到這個定義">¶</a></dt>
<dd><p>類似於 <a class="reference internal" href="#wsgiref.util.request_uri" title="wsgiref.util.request_uri"><code class="xref py py-func docutils literal notranslate"><span class="pre">request_uri()</span></code></a>，但忽略 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 和 <code class="docutils literal notranslate"><span class="pre">QUERY_STRING</span></code> 變數。結果是請求地址的應用程式物件的的基本 URI。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.shift_path_info">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">shift_path_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.shift_path_info" title="連結到這個定義">¶</a></dt>
<dd><p>將單一名稱從 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 移到 <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> 並回傳該名稱。<em>environ</em> 字典會在適當時機被 <em>modified</em>；如果你需要保留原始完好無損的 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 或 <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> 請使用副本。</p>
<p>如果在 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 中沒有剩餘的路徑片段，則回傳 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p>
<p>通常，此程式用於處理請求 URI 的每一部分路徑，例如將路徑視為一系列的字典鍵此程式會修改傳入的環境，使其適用於呼叫位於目標 URI 的 WSGI 應用程式。例如，如果在 <code class="docutils literal notranslate"><span class="pre">/foo</span></code> 上有一個 WSGI 應用程式且請求 URI 路徑為 <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>，並且位於 <code class="docutils literal notranslate"><span class="pre">/foo</span></code> 的 WSGI 應用程式呼叫 <a class="reference internal" href="#wsgiref.util.shift_path_info" title="wsgiref.util.shift_path_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">shift_path_info()</span></code></a>，它將接收字串 &quot;bar&quot;，而環境將被更新為適用於傳遞給位於 <code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> 的 WSGI 應用程式。換句話說，<code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> 將從 <code class="docutils literal notranslate"><span class="pre">/foo</span></code> 變更為 <code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code>，而 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 將從 <code class="docutils literal notranslate"><span class="pre">/bar/baz</span></code> 變更為 <code class="docutils literal notranslate"><span class="pre">/baz</span></code>。</p>
<p>當 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 只是一個 &quot;/&quot; 時， 此程式會回傳一個空字串，並在 <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> 後添加尾部斜號，即使空路徑片段通常是被忽略的，而且 <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> 通常不會以斜號結尾。這是刻意行為，以確保應用程式在使用這個程式進行物件遍歷時可以區分結尾為 <code class="docutils literal notranslate"><span class="pre">/x</span></code> 和結尾為 <code class="docutils literal notranslate"><span class="pre">/x/</span></code> 的 URIs。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.setup_testing_defaults">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">setup_testing_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.setup_testing_defaults" title="連結到這個定義">¶</a></dt>
<dd><p>為測試目的，以簡單的預設值更新 <em>environ</em> 。</p>
<p>這個程式新增 WSGI 所需的各種參數，包括 <code class="docutils literal notranslate"><span class="pre">HTTP_HOST</span></code>、<code class="docutils literal notranslate"><span class="pre">SERVER_NAME</span></code>、<code class="docutils literal notranslate"><span class="pre">SERVER_PORT</span></code>、<code class="docutils literal notranslate"><span class="pre">REQUEST_METHOD</span></code>、<code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code>、<code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code>，以及所有 <span class="target" id="index-42"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 定義的 <code class="docutils literal notranslate"><span class="pre">wsgi.*</span></code> 變數，它只提供預設值，並且不會取代現有的這些變數設定。</p>
<p>這個程式目的為了讓 WSGI 伺服器和應用程式的單元測試更容易建置虛擬環境。實際的 WSGI 伺服器或應用程式不應該使用它，因為所產生的數據是假的！</p>
<p>用法範例：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">wsgiref.util</span> <span class="kn">import</span> <span class="n">setup_testing_defaults</span>
<span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>

<span class="c1"># A relatively simple WSGI application. It&#39;s going to print out the</span>
<span class="c1"># environment dictionary after being updated by setup_testing_defaults</span>
<span class="k">def</span> <span class="nf">simple_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">setup_testing_defaults</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>

    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;200 OK&#39;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain; charset=utf-8&#39;</span><span class="p">)]</span>

    <span class="n">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
           <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">environ</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">ret</span>

<span class="k">with</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">simple_app</span><span class="p">)</span> <span class="k">as</span> <span class="n">httpd</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serving on port 8000...&quot;</span><span class="p">)</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<p>除了上述的環境功能外，<a class="reference internal" href="#module-wsgiref.util" title="wsgiref.util: WSGI environment utilities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code></a> 模組還提供以下各類工具：</p>
<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.util.is_hop_by_hop">
<span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">is_hop_by_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.is_hop_by_hop" title="連結到這個定義">¶</a></dt>
<dd><p>如果 'header_name' 是根據 <span class="target" id="index-43"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2616.html"><strong>RFC 2616</strong></a> 所定義的 HTTP/1.1 &quot;Hop-by-Hop&quot; 標頭，則回傳 <code class="docutils literal notranslate"><span class="pre">True</span></code>。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.util.FileWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.util.</span></span><span class="sig-name descname"><span class="pre">FileWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filelike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.util.FileWrapper" title="連結到這個定義">¶</a></dt>
<dd><p><a class="reference internal" href="#wsgiref.types.FileWrapper" title="wsgiref.types.FileWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">wsgiref.types.FileWrapper</span></code></a> 協議的具體實作，用於將類檔案物件轉換為 <a class="reference internal" href="../glossary.html#term-iterator"><span class="xref std std-term">iterator</span></a>。產生的物件是 <a class="reference internal" href="../glossary.html#term-iterable"><span class="xref std std-term">iterable</span></a>。當物件進行疊代時，將可選的 <em>blksize</em> 引數重複傳遞給 <em>filelike</em> 物件的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> 方法來獲得將產生（yield）的位元組字串。當 <code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> 回傳一個空位元組字串，代表疊代已結束且無法回復。</p>
<p>如果 <em>filelike</em> 有 <code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code> 方法，則回傳的物件也會具有 <code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code> 方法，並在呼叫時呼叫 <em>filelike</em> 物件的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code> 方法。</p>
<p>用法範例：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">wsgiref.util</span> <span class="kn">import</span> <span class="n">FileWrapper</span>

<span class="c1"># We&#39;re using a StringIO-buffer for as the file-like object</span>
<span class="n">filelike</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;This is an example file-like object&quot;</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="n">wrapper</span> <span class="o">=</span> <span class="n">FileWrapper</span><span class="p">(</span><span class="n">filelike</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">wrapper</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.11 版的變更: </span>已移除對 <a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> 方法的支援。</p>
</div>
</dd></dl>

</section>
<section id="module-wsgiref.headers">
<span id="wsgiref-headers-wsgi-response-header-tools"></span><h2><a class="reference internal" href="#module-wsgiref.headers" title="wsgiref.headers: WSGI response header tools."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.headers</span></code></a> -- WSGI 回應標頭工具<a class="headerlink" href="#module-wsgiref.headers" title="連結到這個標頭">¶</a></h2>
<p>這個模組提供單一類別 <a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a>，用於使用類似對映的介面方便地操作 WSGI 回應標頭。</p>
<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.headers.Headers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.headers.</span></span><span class="sig-name descname"><span class="pre">Headers</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.headers.Headers" title="連結到這個定義">¶</a></dt>
<dd><p>建立一個類似對映物件並包裝 <em>headers</em>，並且必須是符合 <span class="target" id="index-44"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 描述的 name/value 元組的標頭串列。<em>headers</em> 的預設值是一個空串列。</p>
<p><a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a> 物件支援典型對映操作包括 <code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code>、<a class="reference internal" href="stdtypes.html#dict.get" title="dict.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a>、<a class="reference internal" href="../reference/datamodel.html#object.__setitem__" title="object.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>、<a class="reference internal" href="stdtypes.html#dict.setdefault" title="dict.setdefault"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setdefault()</span></code></a>、<a class="reference internal" href="../reference/datamodel.html#object.__delitem__" title="object.__delitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a> 以及 <a class="reference internal" href="../reference/datamodel.html#object.__contains__" title="object.__contains__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__contains__()</span></code></a>。對於這些方法中的每一個，鍵是標頭名稱（以不區分大小寫方式處理），而值則是與該標頭名稱關聯的第一個值。設定標頭會刪除該標頭的所有現有值，然後將新值添加到包裝的標頭串列末尾。標頭的現有順序通常保持不變，新標頭會添加到包裝串列的末尾。</p>
<p>不同於字典，當你嘗試取得或刪除包裝的標頭串列不存在的鍵，<a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a> 物件不會引發例外錯誤。取得不存在的標頭只會回傳 <code class="docutils literal notranslate"><span class="pre">None</span></code>，而刪除不存在的標頭則不會有任何效果。</p>
<p><a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a> 物件還支援 <code class="xref py py-meth docutils literal notranslate"><span class="pre">keys()</span></code>、<code class="xref py py-meth docutils literal notranslate"><span class="pre">value()</span></code>、和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">items()</span></code> 方法。由 <code class="xref py py-meth docutils literal notranslate"><span class="pre">keys()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">items()</span></code> 回傳的串列在存在多值標頭時可能會包含相同的鍵。<a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a> 物件的 <code class="docutils literal notranslate"><span class="pre">len()</span></code> 與 <code class="xref py py-meth docutils literal notranslate"><span class="pre">items()</span></code> 的長度相同，也與包裝標頭串列的長度相同。實際上，<code class="xref py py-meth docutils literal notranslate"><span class="pre">items()</span></code> 方法只是回傳包裝的標頭串列的副本。</p>
<p>對 <code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code> 物件呼叫 <code class="docutils literal notranslate"><span class="pre">bytes()</span></code> 會回傳適合作為 HTTP 傳輸回應標頭的格式化的位元組字串。每個標頭都與其值一起置於一行上，由冒號與空格分隔。每行以回車（carriage return）和換行（line feed）結束，而該位元組字串則以空行結束。</p>
<p>除了對映介面和格式化功能外，<a class="reference internal" href="#wsgiref.headers.Headers" title="wsgiref.headers.Headers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Headers</span></code></a> 物件還具有以下查詢及附加多值標頭的以及附加 MIME 參數標頭的方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.headers.Headers.get_all">
<span class="sig-name descname"><span class="pre">get_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.headers.Headers.get_all" title="連結到這個定義">¶</a></dt>
<dd><p>回傳指定標頭的所有值的串列。</p>
<p>回傳的串列按照它們在在原始的標頭串列出現的順序或是被添加到此實例的順序進行排序，並且可能包含重複的內容。任何被刪除並重新插入的欄位都會被添加到標頭串列的末尾。如果不存在指定名稱的欄位，則回傳空串列。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.headers.Headers.add_header">
<span class="sig-name descname"><span class="pre">add_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.headers.Headers.add_header" title="連結到這個定義">¶</a></dt>
<dd><p>添加一個（可能是多值的）標頭，可通過關鍵字引數來指定選擇性的 MIME 參數。</p>
<p><em>name</em> 是要添加的標頭欄位。關鍵字引數可使於設定標頭欄位的 MIME 參數。每一個參數必須是字串或是 <code class="docutils literal notranslate"><span class="pre">None</span></code>。由於破折號在 Python 識別符中是非法的，但是許多 MIME 參數名稱包含破折號，因此參數名稱的底線會轉換成破折號。如果參數值是字串，則以 <code class="docutils literal notranslate"><span class="pre">name=&quot;value&quot;</span></code> 的形式添加到標頭值參數中。如果它是 <code class="docutils literal notranslate"><span class="pre">None</span></code>，則僅添加參數名稱。（這使用於沒有值的 MIME 參數）使用範例：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;content-disposition&#39;</span><span class="p">,</span> <span class="s1">&#39;attachment&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;bud.gif&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>上述操作將添加看起來像這樣的標頭：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Content</span><span class="o">-</span><span class="n">Disposition</span><span class="p">:</span> <span class="n">attachment</span><span class="p">;</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;bud.gif&quot;</span>
</pre></div>
</div>
</dd></dl>

<div class="versionchanged">
<p><span class="versionmodified changed">在 3.5 版的變更: </span><em>headers</em> 參數是可選的。</p>
</div>
</dd></dl>

</section>
<section id="module-wsgiref.simple_server">
<span id="wsgiref-simple-server-a-simple-wsgi-http-server"></span><h2><a class="reference internal" href="#module-wsgiref.simple_server" title="wsgiref.simple_server: A simple WSGI HTTP server."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.simple_server</span></code></a> -- 一個簡單的 WSGI HTTP 伺服器<a class="headerlink" href="#module-wsgiref.simple_server" title="連結到這個標頭">¶</a></h2>
<p>這個模組實作一個簡單的的 HTTP 伺服器（基於 <a class="reference internal" href="http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a>）用於提供 WSGI 應用程式。每個伺服器執行個體在特定的主機與埠提供單一的 WSGI 應用程式。如果你想要在單一主機與埠上提供多個應用程式，你應該建立一個 WSGI 應用程式以剖析 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 去選擇為每個請求呼叫哪個應用程式。（例如，使用來自 <a class="reference internal" href="#module-wsgiref.util" title="wsgiref.util: WSGI environment utilities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code></a> 的 <code class="xref py py-func docutils literal notranslate"><span class="pre">shift_path_info()</span></code> 函式。）</p>
<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.simple_server.make_server">
<span class="sig-prename descclassname"><span class="pre">wsgiref.simple_server.</span></span><span class="sig-name descname"><span class="pre">make_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">WSGIServer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">WSGIRequestHandler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.make_server" title="連結到這個定義">¶</a></dt>
<dd><p>建立一個新的 WSGI 伺服器監聽 <em>host</em> 和 <em>port</em>，接受 <em>app</em> 的連線。回傳值是提供 <em>server_class</em> 的實例，並將使用指定的 <em>handler_class</em> 處理請求。<em>app</em> 必須是一個 WSGI 應用程式物件，如 <span class="target" id="index-45"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 所定義。</p>
<p>用法範例：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span><span class="p">,</span> <span class="n">demo_app</span>

<span class="k">with</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">demo_app</span><span class="p">)</span> <span class="k">as</span> <span class="n">httpd</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serving HTTP on port 8000...&quot;</span><span class="p">)</span>

    <span class="c1"># Respond to requests until process is killed</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>

    <span class="c1"># Alternative: serve one request, then exit</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">handle_request</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.simple_server.demo_app">
<span class="sig-prename descclassname"><span class="pre">wsgiref.simple_server.</span></span><span class="sig-name descname"><span class="pre">demo_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.demo_app" title="連結到這個定義">¶</a></dt>
<dd><p>這個函式是一個簡單但完整的 WSGI 應用程式，它回傳一個包含訊息 &quot;Hello world!&quot; 和在 <em>environ</em> 參數中提供的鍵值對串列的文字頁面。這對於驗證 WSGI 伺服器（例如 <a class="reference internal" href="#module-wsgiref.simple_server" title="wsgiref.simple_server: A simple WSGI HTTP server."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.simple_server</span></code></a>）是否能正確執行簡單的 WSGI 應用程式非常有用。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.simple_server.</span></span><span class="sig-name descname"><span class="pre">WSGIServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">server_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequestHandlerClass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIServer" title="連結到這個定義">¶</a></dt>
<dd><p>建立一個 <a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 實例。<em>server_address</em> 應該是一個 <code class="docutils literal notranslate"><span class="pre">(host,</span> <span class="pre">port)</span></code> 元組，而 <em>RequestHandlerClass</em> 應該是 <a class="reference internal" href="http.server.html#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.server.BaseHTTPRequestHandler</span></code></a> 的子類別，將用於處理請求。</p>
<p>通常你不需要呼叫這個建構函式（constructor），因為 <a class="reference internal" href="#wsgiref.simple_server.make_server" title="wsgiref.simple_server.make_server"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_server()</span></code></a> 函式可以為你處理所有細節。</p>
<p><a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 是 <a class="reference internal" href="http.server.html#http.server.HTTPServer" title="http.server.HTTPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.server.HTTPServer</span></code></a> 的子類別，因此它的所有方法（例如 <code class="xref py py-meth docutils literal notranslate"><span class="pre">serve_forever()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_request()</span></code>）都可用。<a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 也提供這些特定於 WSGI 的方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIServer.set_app">
<span class="sig-name descname"><span class="pre">set_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIServer.set_app" title="連結到這個定義">¶</a></dt>
<dd><p>將可呼叫的 <em>application</em> 設定為接收請求的 WSGI 應用程式。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIServer.get_app">
<span class="sig-name descname"><span class="pre">get_app</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIServer.get_app" title="連結到這個定義">¶</a></dt>
<dd><p>回傳目前設定應用程式的可呼叫物件。</p>
</dd></dl>

<p>然而，通常情況下你不需要去使用這些額外方法，因為 <a class="reference internal" href="#wsgiref.simple_server.WSGIServer.set_app" title="wsgiref.simple_server.WSGIServer.set_app"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_app()</span></code></a> 通常會被 <a class="reference internal" href="#wsgiref.simple_server.make_server" title="wsgiref.simple_server.make_server"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_server()</span></code></a> 呼叫而 <a class="reference internal" href="#wsgiref.simple_server.WSGIServer.get_app" title="wsgiref.simple_server.WSGIServer.get_app"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_app()</span></code></a> 主要存在於請求處理程式（handler）實例的好處上。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIRequestHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.simple_server.</span></span><span class="sig-name descname"><span class="pre">WSGIRequestHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIRequestHandler" title="連結到這個定義">¶</a></dt>
<dd><p>為給定的 <em>request*（即一個 socket）、*client_address*（一個 ``(host,port)`` 位元組）、*server</em> (<a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 實例) 建立一個 HTTP 處理程式（handler）。</p>
<p>你不需要直接建立這個類別的實例；它們會在需要時由 <a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 物件自動建立。不過，你可以建立這個類別的子類別並將其作為 <em>handler_class</em> 提供給 <a class="reference internal" href="#wsgiref.simple_server.make_server" title="wsgiref.simple_server.make_server"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_server()</span></code></a> 函式。一些可能相關的方法可以在子類別中進行覆寫：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIRequestHandler.get_environ">
<span class="sig-name descname"><span class="pre">get_environ</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIRequestHandler.get_environ" title="連結到這個定義">¶</a></dt>
<dd><p>唯一個請求回傳一個 <a class="reference internal" href="#wsgiref.types.WSGIEnvironment" title="wsgiref.types.WSGIEnvironment"><code class="xref py py-data docutils literal notranslate"><span class="pre">WSGIEnvironment</span></code></a> 字典。預設的實作會複製 <a class="reference internal" href="#wsgiref.simple_server.WSGIServer" title="wsgiref.simple_server.WSGIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIServer</span></code></a> 物件的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">base_environ</span></code> 字典屬性的內容以及添加從 HTTP 請求中衍生的各種標頭。每次呼叫這個方法都應該回傳一個包含所有如 <span class="target" id="index-46"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 所指定的相關 CGI 環境變數的新字典。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIRequestHandler.get_stderr">
<span class="sig-name descname"><span class="pre">get_stderr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIRequestHandler.get_stderr" title="連結到這個定義">¶</a></dt>
<dd><p>回傳的物件應該被用作 <code class="docutils literal notranslate"><span class="pre">wsgi.errors</span></code> 串流。預設實作只會回傳 <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.simple_server.WSGIRequestHandler.handle">
<span class="sig-name descname"><span class="pre">handle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.simple_server.WSGIRequestHandler.handle" title="連結到這個定義">¶</a></dt>
<dd><p>處理 HTTP 請求。預設實作會使用 <code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handler</span></code> 類別來建立處置程式（handler）實例來實作實際 WSGI 應用程式介面。</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wsgiref.validate">
<span id="wsgiref-validate-wsgi-conformance-checker"></span><h2><a class="reference internal" href="#module-wsgiref.validate" title="wsgiref.validate: WSGI conformance checker."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.validate</span></code></a> --- WSGI 符合性檢查<a class="headerlink" href="#module-wsgiref.validate" title="連結到這個標頭">¶</a></h2>
<p>當建立新的 WSGI 應用程式物件、框架、伺服器、或是中介軟體（middleware）時，使用 <a class="reference internal" href="#module-wsgiref.validate" title="wsgiref.validate: WSGI conformance checker."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.validate</span></code></a> 來驗證新程式碼的符合性可能會很有用。這個模組提供一個函式用於建立 WSGI 應用程式物件，並用於驗證 WSGI 伺服器或是閘道與 WSGI 應用程式物件之間的通訊，以檢查雙方協議的符合性。</p>
<p>請注意這個工具並不保證完全符合 <span class="target" id="index-47"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a>；這個模組中的錯誤不一定代表不存在錯誤。但是，如果如果這個模組產生錯誤，那麼幾乎可以確定伺服器或應用程式不是 100% 符合標準。</p>
<p>這個模組基於 Ian Bicking 的 &quot;Python Paste&quot; 函式庫的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">paste.lint</span></code> 模組。</p>
<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.validate.validator">
<span class="sig-prename descclassname"><span class="pre">wsgiref.validate.</span></span><span class="sig-name descname"><span class="pre">validator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.validate.validator" title="連結到這個定義">¶</a></dt>
<dd><p>包裝 <em>application</em> 並回傳一個新的 WSGI 應用程式物件。回傳的應用程式將轉發所有請求給原始的 <em>application</em>，並檢查 <em>application</em> 和呼叫它的伺服器是否符合 WSGI 規範和 <span class="target" id="index-48"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2616.html"><strong>RFC 2616</strong></a>。</p>
<p>任何在 <a class="reference internal" href="exceptions.html#AssertionError" title="AssertionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AssertionError</span></code></a> 中偵測不符合結果都會發起例外；但請注意，如何處理這些錯誤取決於伺服器。例如，基於 <a class="reference internal" href="#module-wsgiref.handlers" title="wsgiref.handlers: WSGI server/gateway base classes."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handlers</span></code></a> 的 <a class="reference internal" href="#module-wsgiref.simple_server" title="wsgiref.simple_server: A simple WSGI HTTP server."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.simple_server</span></code></a> 以及其他伺服器（未覆蓋錯誤處理方法以執行其他操作的伺服器）將僅輸出一條錯誤訊息，指示發生錯誤，並將回溯訊息輸出到 <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code> 或是其他錯誤串流。</p>
<p>這個包裝器也可以使用 <a class="reference internal" href="warnings.html#module-warnings" title="warnings: Issue warning messages and control their disposition."><code class="xref py py-mod docutils literal notranslate"><span class="pre">warnings</span></code></a> 模組生成輸出去指示一些可能有疑慮但實際上可能不會被 <span class="target" id="index-49"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 禁止的行為。除非使用 Python 命令列選項或 <a class="reference internal" href="warnings.html#module-warnings" title="warnings: Issue warning messages and control their disposition."><code class="xref py py-mod docutils literal notranslate"><span class="pre">warnings</span></code></a> API，抑制了這些警告，否則這類警告將被寫入到 <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>（<em>not</em> <code class="docutils literal notranslate"><span class="pre">wsgi.errors</span></code>，除非它們碰巧是相同的物件）。</p>
<p>用法範例：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">wsgiref.validate</span> <span class="kn">import</span> <span class="n">validator</span>
<span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>

<span class="c1"># Our callable object which is intentionally not compliant to the</span>
<span class="c1"># standard, so the validator is going to break</span>
<span class="k">def</span> <span class="nf">simple_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;200 OK&#39;</span>  <span class="c1"># HTTP Status</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)]</span>  <span class="c1"># HTTP Headers</span>
    <span class="n">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>

    <span class="c1"># This is going to break because we need to return a list, and</span>
    <span class="c1"># the validator is going to inform us</span>
    <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;Hello World&quot;</span>

<span class="c1"># This is the application wrapped in a validator</span>
<span class="n">validator_app</span> <span class="o">=</span> <span class="n">validator</span><span class="p">(</span><span class="n">simple_app</span><span class="p">)</span>

<span class="k">with</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">validator_app</span><span class="p">)</span> <span class="k">as</span> <span class="n">httpd</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Listening on port 8000....&quot;</span><span class="p">)</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wsgiref.handlers">
<span id="wsgiref-handlers-server-gateway-base-classes"></span><h2><a class="reference internal" href="#module-wsgiref.handlers" title="wsgiref.handlers: WSGI server/gateway base classes."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handlers</span></code></a> -- 伺服器 / 閘道基本類別<a class="headerlink" href="#module-wsgiref.handlers" title="連結到這個標頭">¶</a></h2>
<p>這個模組提供實作 WSGI 伺服器和閘道的基礎處理程式（handler）類別。這些基底類別處理程式大部分與 WSGI 應用程式通訊的工作，只要它們被提供 CGI-like 環境，以及輸入、輸出和錯誤串流。</p>
<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.handlers.CGIHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">CGIHandler</span></span><a class="headerlink" href="#wsgiref.handlers.CGIHandler" title="連結到這個定義">¶</a></dt>
<dd><p>這是基於 CGI 的呼叫方式並透過 <code class="docutils literal notranslate"><span class="pre">sys.stdin</span></code>、<code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code>、<code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code> 和 <code class="docutils literal notranslate"><span class="pre">os.environ</span></code>。當你擁有一個 WSGI 應用程式並希望將其作為 CGI 腳本運行時是很有用的。只需呼叫 <code class="docutils literal notranslate"><span class="pre">CGIHandler().run(app)</span></code>，其中 <code class="docutils literal notranslate"><span class="pre">app</span></code> 是你希望呼叫的 WSGI 應用程式物件。</p>
<p>這個類別是 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a> 的子類別將 <code class="docutils literal notranslate"><span class="pre">wsgi.run_once</span></code> 設置為 true，<code class="docutils literal notranslate"><span class="pre">wsgi.multithread</span></code> 設置為 false，並將 <code class="docutils literal notranslate"><span class="pre">wsgi.multiprocess</span></code> 設置為 true，並且始終使用 <a class="reference internal" href="sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> 和 <a class="reference internal" href="os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 來獲取所需的 CGI 串流以及環境。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.handlers.IISCGIHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">IISCGIHandler</span></span><a class="headerlink" href="#wsgiref.handlers.IISCGIHandler" title="連結到這個定義">¶</a></dt>
<dd><p>這是用於在 Microsoft 的 IIS 網頁伺服器上部署時使用的 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a> 的一個專門替代選擇，無需設置 config 的 allowPathInfo 選項（IIS&gt;=7），或 metabase 的 allowPathInfoForScriptMappings 選項（IIS&lt;7）。</p>
<p>預設情況下，IIS 提供的 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> 會在前面複製 <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code>，對於希望實作路由的 WSGI 應用程式造成問題。這個處理程式（handler）會移除任何這樣的重複路徑。</p>
<p>IIS 可以配置去傳遞正確的 <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code>，但這會導致 <code class="docutils literal notranslate"><span class="pre">PATH_TRANSLATED</span></code> 是錯誤的問題。幸運的是這個變數很少被使用並且不受 WSGI 保證。然而，在 IIS&lt;7 上，這個設置只能在虛擬主機層級進行，影響所有其他腳本的對映，其中許多在暴露 <code class="docutils literal notranslate"><span class="pre">PATH_TRANSLATED</span></code> 問題時會中斷。由於這個原因幾乎從不會使用修復的 IIS&lt;7（即使是 IIS7 也很少使用它，因為它仍然沒有相應的 UI）。</p>
<p>CGI 程式碼無法知道是否已設置該選項，因此提供了一個獨立的處理程式（handler）類別。它的使用方式與 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a> 相同，即透過呼叫 <code class="docutils literal notranslate"><span class="pre">IISCGIHandler().run(app)</span></code> 來使用，其中 <code class="docutils literal notranslate"><span class="pre">app</span></code> 是你希望呼叫的 WSGI 應用程式物件。</p>
<div class="versionadded">
<p><span class="versionmodified added">在 3.2 版被加入.</span></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseCGIHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">BaseCGIHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseCGIHandler" title="連結到這個定義">¶</a></dt>
<dd><p>類似於 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a>，但不是使用 <a class="reference internal" href="sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> 和 <a class="reference internal" href="os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模組，而是明確指定 CGI 環境與 I/O 串流。<em>multithread</em> 和 <em>multiprocess</em> 值用於設置由處理程式（handler）實例運行的任何應用程式的旗標。</p>
<p>這個類別是專門為除了 HTTP &quot;origin servers&quot; 以外的軟體一起使用的 <a class="reference internal" href="#wsgiref.handlers.SimpleHandler" title="wsgiref.handlers.SimpleHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHandler</span></code></a> 的子類別。如果你正在撰寫一個使用 <code class="docutils literal notranslate"><span class="pre">Status:</span></code> 標頭來發送 HTTP 狀態的閘道協議實作（例如 CGI、FastCGI、SCGI 等），你可能會想要子類化這個類別來替代 <a class="reference internal" href="#wsgiref.handlers.SimpleHandler" title="wsgiref.handlers.SimpleHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHandler</span></code></a>。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.handlers.SimpleHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">SimpleHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multithread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.SimpleHandler" title="連結到這個定義">¶</a></dt>
<dd><p>類似於 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a>，但是被設計使用在 HTTP origin 伺服器。如果你正在撰寫 HTTP 伺服器的實作，你可能會想要子類別化這個類別來替代 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a>。</p>
<p>這個類別是 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 的子類別。它透過建構器去覆寫 <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler.get_stdin" title="wsgiref.handlers.BaseHandler.get_stdin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stdin()</span></code></a>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler.get_stderr" title="wsgiref.handlers.BaseHandler.get_stderr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stderr()</span></code></a>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler.add_cgi_vars" title="wsgiref.handlers.BaseHandler.add_cgi_vars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_cgi_vars()</span></code></a>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler._write" title="wsgiref.handlers.BaseHandler._write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_write()</span></code></a>、和 <a class="reference internal" href="#wsgiref.handlers.BaseHandler._flush" title="wsgiref.handlers.BaseHandler._flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_flush()</span></code></a> 方法來明確提供設置環境與串流。提供的環境與串流被儲存在 <code class="xref py py-attr docutils literal notranslate"><span class="pre">stdin</span></code>、<code class="xref py py-attr docutils literal notranslate"><span class="pre">stdout</span></code>、<code class="xref py py-attr docutils literal notranslate"><span class="pre">stderr</span></code>、和 <code class="xref py py-attr docutils literal notranslate"><span class="pre">environ</span></code> 環境中。</p>
<p><em>stdout</em> 的 <a class="reference internal" href="io.html#io.BufferedIOBase.write" title="io.BufferedIOBase.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> 方法應該完整地寫入每個塊（chunk），像是 <a class="reference internal" href="io.html#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BufferedIOBase</span></code></a>。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">BaseHandler</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler" title="連結到這個定義">¶</a></dt>
<dd><p>這是一個運行 WSGI 應用程式的抽象基底類別。每個實例將處理單個 HTTP 請求，儘管原則上你可以建立一個可重用於多個請求的子類別。</p>
<p><a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 實例只有一個供外部使用的方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.run" title="連結到這個定義">¶</a></dt>
<dd><p>運行指定 WSGI 應用程式，<em>app</em>。</p>
</dd></dl>

<p>此方法在運行應用程式的過程中呼叫了所有其他 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 的方法，因此這些方法主要存在是為了允許自定義整個過程。</p>
<p>以下方法必須在子類別中覆寫：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler._write">
<span class="sig-name descname"><span class="pre">_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler._write" title="連結到這個定義">¶</a></dt>
<dd><p>緩衝要傳送給用戶端的位元組 <em>data</em>。如果這個方法實際上傳送了數據也是可以的；當底層系統實際具有這種區分時，<a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 為了更好的效能進而分離寫入和刷新操作。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler._flush">
<span class="sig-name descname"><span class="pre">_flush</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler._flush" title="連結到這個定義">¶</a></dt>
<dd><p>強制將緩衝數據傳送到用戶端。如果這是一個無操作（no-op）的方法（即，如果 <a class="reference internal" href="#wsgiref.handlers.BaseHandler._write" title="wsgiref.handlers.BaseHandler._write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_write()</span></code></a> 實際上發送了數據），那麼是可以的。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.get_stdin">
<span class="sig-name descname"><span class="pre">get_stdin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.get_stdin" title="連結到這個定義">¶</a></dt>
<dd><p>回傳一個與 <a class="reference internal" href="#wsgiref.types.InputStream" title="wsgiref.types.InputStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputStream</span></code></a> 相容的物件並適用於用作當前正在處理請求的 <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.get_stderr">
<span class="sig-name descname"><span class="pre">get_stderr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.get_stderr" title="連結到這個定義">¶</a></dt>
<dd><p>回傳一個與 <a class="reference internal" href="#wsgiref.types.ErrorStream" title="wsgiref.types.ErrorStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorStream</span></code></a> 相容的物件並適用於用作當前正在處理請求的 <code class="docutils literal notranslate"><span class="pre">wsgi.errors</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.add_cgi_vars">
<span class="sig-name descname"><span class="pre">add_cgi_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.add_cgi_vars" title="連結到這個定義">¶</a></dt>
<dd><p>將當前請求的 CGI 變數插入到 <code class="xref py py-attr docutils literal notranslate"><span class="pre">environ</span></code> 屬性中。</p>
</dd></dl>

<p>以下是你可能希望覆寫的其他方法和屬性。這個列表只是一個摘要，然而，不包括可以被覆寫的每個方法。在嘗試建立自定義的 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 子類別之前，你應該參考文件說明和原始碼以獲得更多資訊。</p>
<p>用於自定義 WSGI 環境的屬性和方法：</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.wsgi_multithread">
<span class="sig-name descname"><span class="pre">wsgi_multithread</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.wsgi_multithread" title="連結到這個定義">¶</a></dt>
<dd><p>用於 <code class="docutils literal notranslate"><span class="pre">wsgi.multithread</span></code> 環境變數的值。在 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 中預設為 true，但在其他子類別中可能有不同的預設值（或由建構函式設置）。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.wsgi_multiprocess">
<span class="sig-name descname"><span class="pre">wsgi_multiprocess</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.wsgi_multiprocess" title="連結到這個定義">¶</a></dt>
<dd><p>用於 <code class="docutils literal notranslate"><span class="pre">wsgi.multiprocess</span></code> 環境變數的值。在 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 中預設為 true，但在其他子類別中可能有不同的預設值（或由建構函式設置）。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.wsgi_run_once">
<span class="sig-name descname"><span class="pre">wsgi_run_once</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.wsgi_run_once" title="連結到這個定義">¶</a></dt>
<dd><p>用於 <code class="docutils literal notranslate"><span class="pre">wsgi.run_once</span></code> 環境變數的值。在 <a class="reference internal" href="#wsgiref.handlers.BaseHandler" title="wsgiref.handlers.BaseHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHandler</span></code></a> 中預設為 false，但 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a> 預設將其設置為 true。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.os_environ">
<span class="sig-name descname"><span class="pre">os_environ</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.os_environ" title="連結到這個定義">¶</a></dt>
<dd><p>預設環境變數包含在每一個請求的 WSGI 環境中。預設情況下，這是在載入 <a class="reference internal" href="#module-wsgiref.handlers" title="wsgiref.handlers: WSGI server/gateway base classes."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handlers</span></code></a> 時的 <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> 副本，但子類別可以在類別或實例層級建立自己的副本。注意字典應該被視為唯讀，因為預設值在多個類別與實例中共享。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.server_software">
<span class="sig-name descname"><span class="pre">server_software</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.server_software" title="連結到這個定義">¶</a></dt>
<dd><p>如果設置 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.origin_server" title="wsgiref.handlers.BaseHandler.origin_server"><code class="xref py py-attr docutils literal notranslate"><span class="pre">origin_server</span></code></a> 屬性，則此屬性的值將用於設置預設的 <code class="docutils literal notranslate"><span class="pre">SERVER_SOFTWARE</span></code> WSGI 環境變數，並且還將用於設置 HTTP 回應中的預設 <code class="docutils literal notranslate"><span class="pre">Server:</span></code> 標頭。對於不是 HTTP origin 伺服器的處置程式（例如 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a>），此屬性將被忽略。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.3 版的變更: </span>將術語 &quot;Python&quot; 替換為特定實作的術語，如 &quot;CPython&quot;、&quot;Jython&quot; 等。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.get_scheme">
<span class="sig-name descname"><span class="pre">get_scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.get_scheme" title="連結到這個定義">¶</a></dt>
<dd><p>回傳用於當前請求的 URL scheme。預設的實作使用 <a class="reference internal" href="#module-wsgiref.util" title="wsgiref.util: WSGI environment utilities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code></a> 中的 <code class="xref py py-func docutils literal notranslate"><span class="pre">guess_scheme()</span></code> 函式去猜測 scheme 是 &quot;http&quot; 或是 &quot;https&quot;，基於目前請求的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">environ</span></code> 變數。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.setup_environ">
<span class="sig-name descname"><span class="pre">setup_environ</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.setup_environ" title="連結到這個定義">¶</a></dt>
<dd><p>將 <code class="xref py py-attr docutils literal notranslate"><span class="pre">environ</span></code> 屬性設置為完全填充的 WSGI 環境。預設的實作使用上述所有方法和屬性，以及 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.get_stdin" title="wsgiref.handlers.BaseHandler.get_stdin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stdin()</span></code></a>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler.get_stderr" title="wsgiref.handlers.BaseHandler.get_stderr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stderr()</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.add_cgi_vars" title="wsgiref.handlers.BaseHandler.add_cgi_vars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_cgi_vars()</span></code></a> 方法以及 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.wsgi_file_wrapper" title="wsgiref.handlers.BaseHandler.wsgi_file_wrapper"><code class="xref py py-attr docutils literal notranslate"><span class="pre">wsgi_file_wrapper</span></code></a> 屬性。如果不呈現它也會插入一個 <code class="docutils literal notranslate"><span class="pre">SERVER_SOFTWARE</span></code> 關鍵字，只要 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.origin_server" title="wsgiref.handlers.BaseHandler.origin_server"><code class="xref py py-attr docutils literal notranslate"><span class="pre">origin_server</span></code></a> 屬性是一個 true 值並且 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.server_software" title="wsgiref.handlers.BaseHandler.server_software"><code class="xref py py-attr docutils literal notranslate"><span class="pre">server_software</span></code></a> 屬性被設置。</p>
</dd></dl>

<p>用於自定義例外處理的屬性和方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.log_exception">
<span class="sig-name descname"><span class="pre">log_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.log_exception" title="連結到這個定義">¶</a></dt>
<dd><p>將 <em>exc_info</em> 元組記錄到伺服器日誌中。<em>exc_info</em> 是一個 <code class="docutils literal notranslate"><span class="pre">(type,</span> <span class="pre">value,</span> <span class="pre">traceback)</span></code> 元組。預設實作只是將追蹤資訊寫入到請求的 <code class="docutils literal notranslate"><span class="pre">wsgi.errors</span></code> 串流中並刷新它。子類別可以覆蓋此方法以更改格式或重新定向輸出，將追蹤資訊發送給管理員，或執行其他被認為合適的操作。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.traceback_limit">
<span class="sig-name descname"><span class="pre">traceback_limit</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.traceback_limit" title="連結到這個定義">¶</a></dt>
<dd><p>預設的 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.log_exception" title="wsgiref.handlers.BaseHandler.log_exception"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_exception()</span></code></a> 方法追蹤輸出中包含的最大幀數 。如果為 <code class="docutils literal notranslate"><span class="pre">None</span></code>，則包含所有幀。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.error_output">
<span class="sig-name descname"><span class="pre">error_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.error_output" title="連結到這個定義">¶</a></dt>
<dd><p>這個方法是一個為使用者去產生錯誤頁面的 WSGI 應用程式。只有在標頭傳送給用戶端前如果發生錯誤才會被呼叫。</p>
<p>此方法使用 <code class="docutils literal notranslate"><span class="pre">sys.exception()</span></code> 存取當前的錯誤，當呼叫它（如 <span class="target" id="index-50"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 的 &quot;Error Handling&quot; 部分所描述）時應該傳遞資訊給 <em>start_response</em>。</p>
<p>預設的實作只是使用 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.error_status" title="wsgiref.handlers.BaseHandler.error_status"><code class="xref py py-attr docutils literal notranslate"><span class="pre">error_status</span></code></a>、<a class="reference internal" href="#wsgiref.handlers.BaseHandler.error_headers" title="wsgiref.handlers.BaseHandler.error_headers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">error_headers</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.error_body" title="wsgiref.handlers.BaseHandler.error_body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">error_body</span></code></a> 屬性產生輸出頁面。子類別可以覆蓋此方法以生成更動態的錯誤輸出。</p>
<p>然而，從安全的角度並不建議向任何普通使用者顯示診斷資訊；理想情況下，你應該需要採取特殊措施才能啟用診斷輸出，這就是預設實作不包括任何診斷資訊的原因。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.error_status">
<span class="sig-name descname"><span class="pre">error_status</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.error_status" title="連結到這個定義">¶</a></dt>
<dd><p>用於錯誤回應的 HTTP 狀態。這應該是一個按照 <span class="target" id="index-51"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 定義的狀態字串；預設為 500 狀態碼和訊息。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.error_headers">
<span class="sig-name descname"><span class="pre">error_headers</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.error_headers" title="連結到這個定義">¶</a></dt>
<dd><p>用於錯誤回應的 HTTP 標頭。這應該是一個 WSGI 回應標頭的串列（<code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">value)</span></code> 元組），如 <span class="target" id="index-52"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 中所描述。預設串列只設置內容種類為 <code class="docutils literal notranslate"><span class="pre">text/plain</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.error_body">
<span class="sig-name descname"><span class="pre">error_body</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.error_body" title="連結到這個定義">¶</a></dt>
<dd><p>錯誤回應的主體。這應該是一個 HTTP 回應內容的位元組字串。預設為純文字 &quot;A server error occurred. Please contact the administrator.&quot;</p>
</dd></dl>

<p>用於 <span class="target" id="index-53"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 中的 &quot;Optional Platform-Specific File Handling&quot; 功能的方法和屬性：</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.wsgi_file_wrapper">
<span class="sig-name descname"><span class="pre">wsgi_file_wrapper</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.wsgi_file_wrapper" title="連結到這個定義">¶</a></dt>
<dd><p>一個 <code class="docutils literal notranslate"><span class="pre">wsgi.file_wrapper</span></code> 工廠函式（factory），與 <a class="reference internal" href="#wsgiref.types.FileWrapper" title="wsgiref.types.FileWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">wsgiref.types.FileWrapper</span></code></a> 相容，或者為 <code class="docutils literal notranslate"><span class="pre">None</span></code>。這個屬性的預設值是 <a class="reference internal" href="#wsgiref.util.FileWrapper" title="wsgiref.util.FileWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">wsgiref.util.FileWrapper</span></code></a> 類別。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.sendfile">
<span class="sig-name descname"><span class="pre">sendfile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.sendfile" title="連結到這個定義">¶</a></dt>
<dd><p>覆蓋以實作特定平台的檔案傳輸。只有當應用程式的回傳值是由 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.wsgi_file_wrapper" title="wsgiref.handlers.BaseHandler.wsgi_file_wrapper"><code class="xref py py-attr docutils literal notranslate"><span class="pre">wsgi_file_wrapper</span></code></a> 屬性指定的類別實例時才會呼叫此方法。如果它能夠成功傳輸檔案應該回傳一個 true 值，以便不執行預設的傳輸程式碼。該方法的預設實作只回傳一個 false 值。</p>
</dd></dl>

<p>其他方法和屬性：</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.origin_server">
<span class="sig-name descname"><span class="pre">origin_server</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.origin_server" title="連結到這個定義">¶</a></dt>
<dd><p>這個屬性應該被設置為 true 值，如果處理程式（handler）的 <a class="reference internal" href="#wsgiref.handlers.BaseHandler._write" title="wsgiref.handlers.BaseHandler._write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_write()</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.BaseHandler._flush" title="wsgiref.handlers.BaseHandler._flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_flush()</span></code></a> 被用於直接與用戶端通訊，而不是透過 CGI-like 的閘道協議希望 HTTP 狀態在特殊的 <code class="docutils literal notranslate"><span class="pre">Status:</span></code> 標頭中。</p>
<p>這個屬性在 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a> 預設值為 true，但是在 <a class="reference internal" href="#wsgiref.handlers.BaseCGIHandler" title="wsgiref.handlers.BaseCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCGIHandler</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a> 為 false。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wsgiref.handlers.BaseHandler.http_version">
<span class="sig-name descname"><span class="pre">http_version</span></span><a class="headerlink" href="#wsgiref.handlers.BaseHandler.http_version" title="連結到這個定義">¶</a></dt>
<dd><p>如果 <a class="reference internal" href="#wsgiref.handlers.BaseHandler.origin_server" title="wsgiref.handlers.BaseHandler.origin_server"><code class="xref py py-attr docutils literal notranslate"><span class="pre">origin_server</span></code></a> 為 true，則此字串屬性用於設定傳送給用戶端的回應的 HTTP 版本。預設為 <code class="docutils literal notranslate"><span class="pre">&quot;1.0&quot;</span></code>。</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wsgiref.handlers.read_environ">
<span class="sig-prename descclassname"><span class="pre">wsgiref.handlers.</span></span><span class="sig-name descname"><span class="pre">read_environ</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wsgiref.handlers.read_environ" title="連結到這個定義">¶</a></dt>
<dd><p>從 <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> 轉碼 CGI 變數到 <span class="target" id="index-54"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 中的 &quot;bytes in unicode&quot; 字串，並回傳一個新字典。這個函式被 <a class="reference internal" href="#wsgiref.handlers.CGIHandler" title="wsgiref.handlers.CGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHandler</span></code></a> 和 <a class="reference internal" href="#wsgiref.handlers.IISCGIHandler" title="wsgiref.handlers.IISCGIHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">IISCGIHandler</span></code></a> 使用來直接替代 <code class="docutils literal notranslate"><span class="pre">os.environ</span></code>，在所有平台和使用 Python 3 的網頁伺服器上不一定符合 WSGI 標準，具體來說，在 OS 的實際環境是 Unicode（例如 Windows）的情況下，或者在環境是位元組的情況下，但 Python 用於解碼它的系統編碼不是 ISO-8859-1 （例如使用 UTF-8 的 Unix 系統）。</p>
<p>如果你自己正在實作 CGI-based 處理程式（handler），你可能想要使用這個函式來替換單純直接從 <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> 中複製值。</p>
<div class="versionadded">
<p><span class="versionmodified added">在 3.2 版被加入.</span></p>
</div>
</dd></dl>

</section>
<section id="module-wsgiref.types">
<span id="wsgiref-types-wsgi-types-for-static-type-checking"></span><h2><a class="reference internal" href="#module-wsgiref.types" title="wsgiref.types: WSGI types for static type checking"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.types</span></code></a> -- 用於靜態型別檢查的 WSGI 型別<a class="headerlink" href="#module-wsgiref.types" title="連結到這個標頭">¶</a></h2>
<p>這個模組提供在 <span class="target" id="index-55"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a> 中所描述的各種用於靜態型別檢查的型別。</p>
<div class="versionadded">
<p><span class="versionmodified added">在 3.11 版被加入.</span></p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.types.StartResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">StartResponse</span></span><a class="headerlink" href="#wsgiref.types.StartResponse" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述 <a class="reference external" href="https://peps.python.org/pep-3333/#the-start-response-callable">start_response()</a> 可呼叫物件的 <a class="reference internal" href="typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Protocol</span></code></a> (<span class="target" id="index-56"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>PEP 3333</strong></a>)。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="wsgiref.types.WSGIEnvironment">
<span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">WSGIEnvironment</span></span><a class="headerlink" href="#wsgiref.types.WSGIEnvironment" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述 WSGI 環境字典的型別別名。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="wsgiref.types.WSGIApplication">
<span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">WSGIApplication</span></span><a class="headerlink" href="#wsgiref.types.WSGIApplication" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述 WSGI 應用程式可呼叫物件的型別別名。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.types.InputStream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">InputStream</span></span><a class="headerlink" href="#wsgiref.types.InputStream" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述 <a class="reference external" href="https://peps.python.org/pep-3333/#input-and-error-streams">WSGI 輸入串流</a>的 <a class="reference internal" href="typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Protocol</span></code></a>。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.types.ErrorStream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">ErrorStream</span></span><a class="headerlink" href="#wsgiref.types.ErrorStream" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述 <a class="reference external" href="https://peps.python.org/pep-3333/#input-and-error-streams">WSGI 錯誤串流</a>的 <a class="reference internal" href="typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Protocol</span></code></a>。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wsgiref.types.FileWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wsgiref.types.</span></span><span class="sig-name descname"><span class="pre">FileWrapper</span></span><a class="headerlink" href="#wsgiref.types.FileWrapper" title="連結到這個定義">¶</a></dt>
<dd><p>一個描述<a class="reference external" href="https://peps.python.org/pep-3333/#optional-platform-specific-file-handling">檔案包裝器</a>的 <a class="reference internal" href="typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Protocol</span></code></a>。請參閱 <a class="reference internal" href="#wsgiref.util.FileWrapper" title="wsgiref.util.FileWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">wsgiref.util.FileWrapper</span></code></a> 來瞭解此協議的具體實作。</p>
</dd></dl>

</section>
<section id="examples">
<h2>範例<a class="headerlink" href="#examples" title="連結到這個標頭">¶</a></h2>
<p>這個一個運作中的 &quot;Hello World&quot; WSGI 應用程式：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Every WSGI application must have an application object - a callable</span>
<span class="sd">object that accepts two arguments. For that purpose, we&#39;re going to</span>
<span class="sd">use a function (note that you&#39;re not limited to a function, you can</span>
<span class="sd">use a class for example). The first argument passed to the function</span>
<span class="sd">is a dictionary containing CGI-style environment variables and the</span>
<span class="sd">second variable is the callable object.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>


<span class="k">def</span> <span class="nf">hello_world_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;200 OK&quot;</span>  <span class="c1"># HTTP Status</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Content-type&quot;</span><span class="p">,</span> <span class="s2">&quot;text/plain; charset=utf-8&quot;</span><span class="p">)]</span>  <span class="c1"># HTTP Headers</span>
    <span class="n">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>

    <span class="c1"># The returned object is going to be printed</span>
    <span class="k">return</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;Hello World&quot;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">make_server</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">hello_world_app</span><span class="p">)</span> <span class="k">as</span> <span class="n">httpd</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serving on port 8000...&quot;</span><span class="p">)</span>

    <span class="c1"># Serve until process is killed</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
<p>提供當前目錄的 WSGI 應用程式範例，並接受命令列上的可選目錄和埠號（預設：8000）：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Small wsgiref based web server. Takes a path to serve from and an</span>
<span class="sd">optional port number (defaults to 8000), then tries to serve files.</span>
<span class="sd">MIME types are guessed from the file names, 404 errors are raised</span>
<span class="sd">if the file is not found.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">wsgiref</span> <span class="kn">import</span> <span class="n">simple_server</span><span class="p">,</span> <span class="n">util</span>


<span class="k">def</span> <span class="nf">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">respond</span><span class="p">):</span>
    <span class="c1"># Get the file name and MIME type</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PATH_INFO&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;index.html&quot;</span><span class="p">)</span>
    <span class="n">mime_type</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">fn</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Return 200 OK if file exists, otherwise 404 Not Found</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="n">respond</span><span class="p">(</span><span class="s2">&quot;200 OK&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="n">mime_type</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">FileWrapper</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">respond</span><span class="p">(</span><span class="s2">&quot;404 Not Found&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;text/plain&quot;</span><span class="p">)])</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;not found&quot;</span><span class="p">]</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Get the path and port from command-line arguments</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">8000</span>

    <span class="c1"># Make and start the server until control-c</span>
    <span class="n">httpd</span> <span class="o">=</span> <span class="n">simple_server</span><span class="o">.</span><span class="n">make_server</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Serving </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> on port </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">, control-C to stop&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shutting down.&quot;</span><span class="p">)</span>
        <span class="n">httpd</span><span class="o">.</span><span class="n">server_close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code> --- WSGI 工具與參考實作</a><ul>
<li><a class="reference internal" href="#module-wsgiref.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.util</span></code> -- WSGI 環境工具</a></li>
<li><a class="reference internal" href="#module-wsgiref.headers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.headers</span></code> -- WSGI 回應標頭工具</a></li>
<li><a class="reference internal" href="#module-wsgiref.simple_server"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.simple_server</span></code> -- 一個簡單的 WSGI HTTP 伺服器</a></li>
<li><a class="reference internal" href="#module-wsgiref.validate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.validate</span></code> --- WSGI 符合性檢查</a></li>
<li><a class="reference internal" href="#module-wsgiref.handlers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.handlers</span></code> -- 伺服器 / 閘道基本類別</a></li>
<li><a class="reference internal" href="#module-wsgiref.types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.types</span></code> -- 用於靜態型別檢查的 WSGI 型別</a></li>
<li><a class="reference internal" href="#examples">範例</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="webbrowser.html"
                          title="上一章"><code class="xref py py-mod docutils literal notranslate"><span class="pre">webbrowser</span></code> --- 方便的網頁瀏覽器控制器</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="urllib.html"
                          title="下一章"><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib</span></code> --- URL 處理模組</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/wsgiref.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="收合側邊欄">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="urllib.html" title="urllib --- URL 處理模組"
             >下一頁</a> |</li>
        <li class="right" >
          <a href="webbrowser.html" title="webbrowser --- 方便的網頁瀏覽器控制器"
             >上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準函式庫 (Standard Library)</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="internet.html" >網路協定 (Internet protocols) 及支援</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code> --- WSGI 工具與參考實作</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    版權
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="/license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最後更新於 Jul 20, 2024 (07:32 UTC)。
    
      <a href="/bugs.html">Found a bug</a>?
    
    <br />

    使用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.6 建立。
    </div>

  </body>
</html>