<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Python 3.11 有什麼新功能 &#8212; Python 3.12.4 說明文件</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=41b4f12d" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=b20cc3f5" />
    
    <script src="../_static/documentation_options.js?v=6bff4b4f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=f1e884e3"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.12.4 說明文件 中搜尋"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="關於這些文件" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="copyright" title="版權" href="../copyright.html" />
    <link rel="next" title="Python 3.10 有什麼新功能" href="3.10.html" />
    <link rel="prev" title="Python 3.12 有什麼新功能" href="3.12.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/whatsnew/3.11.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" />
                <input type="submit" value="前往"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.11 有什麼新功能</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">發布重點摘要</a></li>
<li><a class="reference internal" href="#new-features">新增特性</a><ul>
<li><a class="reference internal" href="#pep-657-fine-grained-error-locations-in-tracebacks">PEP 657：回溯 (traceback) 中更細緻的錯誤位置</a></li>
<li><a class="reference internal" href="#pep-654-exception-groups-and-except">PEP 654：例外群組與 <code class="docutils literal notranslate"><span class="pre">except*</span></code></a></li>
<li><a class="reference internal" href="#pep-678-exceptions-can-be-enriched-with-notes">PEP 678：運用例外註解使其更加詳盡</a></li>
<li><a class="reference internal" href="#windows-py-exe-launcher-improvements">Windows <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> 啟動程式 (launcher) 的改進</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-features-related-to-type-hints">型別提示相關的新特性</a><ul>
<li><a class="reference internal" href="#pep-646-variadic-generics">PEP 646：可變參數泛型 (variadic generics)</a></li>
<li><a class="reference internal" href="#pep-655-marking-individual-typeddict-items-as-required-or-not-required">PEP 655：標記獨立 <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> 項目為必要或不必要</a></li>
<li><a class="reference internal" href="#pep-673-self-type">PEP 673：<code class="docutils literal notranslate"><span class="pre">Self</span></code> 型別</a></li>
<li><a class="reference internal" href="#pep-675-arbitrary-literal-string-type">PEP 675：任意的文本字串型別 (Arbitrary literal string type)</a></li>
<li><a class="reference internal" href="#pep-681-data-class-transforms">PEP 681：資料類別轉換 (Data class transforms)</a></li>
<li><a class="reference internal" href="#pep-563-may-not-be-the-future">PEP 563 可能不是未來</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他語言更動</a></li>
<li><a class="reference internal" href="#other-cpython-implementation-changes">其他 CPython 實作更動</a></li>
<li><a class="reference internal" href="#new-modules">新增模組</a></li>
<li><a class="reference internal" href="#improved-modules">改進的模組</a><ul>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#contextlib">contextlib</a></li>
<li><a class="reference internal" href="#dataclasses">dataclasses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#fcntl">fcntl</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#gzip">gzip</a></li>
<li><a class="reference internal" href="#hashlib">hashlib</a></li>
<li><a class="reference internal" href="#whatsnew311-idle">IDLE 與 idlelib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#locale">locale</a></li>
<li><a class="reference internal" href="#logging">logging</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#operator">operator</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#string">string</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#sysconfig">sysconfig</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#traceback">traceback</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#venv">venv</a></li>
<li><a class="reference internal" href="#warnings">warnings</a></li>
<li><a class="reference internal" href="#zipfile">zipfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">最佳化</a></li>
<li><a class="reference internal" href="#faster-cpython">更快的 CPython</a><ul>
<li><a class="reference internal" href="#faster-startup">更快的啟動</a><ul>
<li><a class="reference internal" href="#frozen-imports-static-code-objects">凍結引入 (Frozen imports) / 靜態程式碼物件 (Static code objects)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faster-runtime">更快的運行程式</a><ul>
<li><a class="reference internal" href="#cheaper-lazy-python-frames">所需資源更少 (cheaper) 且惰性的 (lazy)) Python 幀 (frame)</a></li>
<li><a class="reference internal" href="#inlined-python-function-calls">行內 Python 函式呼叫</a></li>
<li><a class="reference internal" href="#pep-659-specializing-adaptive-interpreter">PEP 659：特化的適應性直譯器</a></li>
</ul>
</li>
<li><a class="reference internal" href="#misc">雜項</a></li>
<li><a class="reference internal" href="#faq">FAQ</a><ul>
<li><a class="reference internal" href="#how-should-i-write-my-code-to-utilize-these-speedups">我該如何在程式碼中獲取這些加速？</a></li>
<li><a class="reference internal" href="#will-cpython-3-11-use-more-memory">Python 3.11 會不會使用更多記憶體？</a></li>
<li><a class="reference internal" href="#i-don-t-see-any-speedups-in-my-workload-why">我在我的程式當中沒感覺到任何加速，為什麼？</a></li>
<li><a class="reference internal" href="#is-there-a-jit-compiler">有用到 JIT 編譯器嗎？</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about">關於</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 位元組碼 (bytecode) 變更</a><ul>
<li><a class="reference internal" href="#new-opcodes">新增 opcode</a></li>
<li><a class="reference internal" href="#replaced-opcodes">被取代的操作碼 (opcode)</a></li>
<li><a class="reference internal" href="#changed-removed-opcodes">有更動/被移除的 opcode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecated">已棄用</a><ul>
<li><a class="reference internal" href="#language-builtins">語言/內建</a></li>
<li><a class="reference internal" href="#modules">模組</a></li>
<li><a class="reference internal" href="#standard-library">標準函式庫</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pending-removal-in-python-3-12">Python 3.12 中待決議的移除項目</a></li>
<li><a class="reference internal" href="#removed">已移除</a></li>
<li><a class="reference internal" href="#porting-to-python-3-11">移植至 Python 3.11</a></li>
<li><a class="reference internal" href="#build-changes">建置變更</a></li>
<li><a class="reference internal" href="#c-api-changes">C API 變更</a><ul>
<li><a class="reference internal" href="#whatsnew311-c-api-new-features">新增特性</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-porting">移植至 Python 3.11</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-deprecated">已棄用</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-pending-removal">Python 3.12 中待決議的移除項目</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-removed">已移除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notable-changes-in-3-11-4">Notable changes in 3.11.4</a><ul>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notable-changes-in-3-11-5">Notable changes in 3.11.5</a><ul>
<li><a class="reference internal" href="#openssl">OpenSSL</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="3.12.html"
                          title="上一章">Python 3.12 有什麼新功能</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="3.10.html"
                          title="下一章">Python 3.10 有什麼新功能</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.11.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="3.10.html" title="Python 3.10 有什麼新功能"
             accesskey="N">下一頁</a> |</li>
        <li class="right" >
          <a href="3.12.html" title="Python 3.12 有什麼新功能"
             accesskey="P">上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python 有什麼新功能？</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.11 有什麼新功能</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="what-s-new-in-python-3-11">
<h1>Python 3.11 有什麼新功能<a class="headerlink" href="#what-s-new-in-python-3-11" title="連結到這個標頭">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">編輯者<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pablo Galindo Salgado</p>
</dd>
</dl>
<p>此文章解釋了 Python 3.11 和 3.10 相比多了哪些新特性。Python 3.11 於 2022 年 10 月 24 日發布。完整細節請見 <a class="reference internal" href="changelog.html#changelog"><span class="std std-ref">Changelog（更動日誌）</span></a>。</p>
<section id="summary-release-highlights">
<span id="whatsnew311-summary"></span><h2>發布重點摘要<a class="headerlink" href="#summary-release-highlights" title="連結到這個標頭">¶</a></h2>
<ul class="simple">
<li><p>Python 3.11 比 Python 3.10 快了 10-60%。我們使用了標準基準量測套裝軟體 (benchmark suite) 測得平均加速了 1.25x。細節請見<a class="reference internal" href="#whatsnew311-faster-cpython"><span class="std std-ref">更快的 CPython</span></a>。</p></li>
</ul>
<p>新增語法特性：</p>
<ul class="simple">
<li><p><a class="reference internal" href="#whatsnew311-pep654"><span class="std std-ref">PEP 654：例外群組與 except*</span></a></p></li>
</ul>
<p>新增內建特性：</p>
<ul class="simple">
<li><p><a class="reference internal" href="#whatsnew311-pep678"><span class="std std-ref">PEP 678：運用例外註解使其更加詳盡</span></a></p></li>
</ul>
<p>新增標準函式庫模組：</p>
<ul class="simple">
<li><p><span class="target" id="index-82"></span><a class="pep reference external" href="https://peps.python.org/pep-0680/"><strong>PEP 680</strong></a>：<a class="reference internal" href="../library/tomllib.html#module-tomllib" title="tomllib: Parse TOML files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tomllib</span></code></a> — 在標準函式庫中支援 <a class="reference external" href="https://toml.io/">TOML</a> 檔案的剖析</p></li>
</ul>
<p>直譯器的改進：</p>
<ul class="simple">
<li><p><a class="reference internal" href="#whatsnew311-pep657"><span class="std std-ref">PEP 657：回溯 (traceback) 中更細緻的錯誤位置</span></a></p></li>
<li><p>新增 <a class="reference internal" href="../using/cmdline.html#cmdoption-P"><code class="xref std std-option docutils literal notranslate"><span class="pre">-P</span></code></a> 命令列選項和 <span class="target" id="index-83"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSAFEPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONSAFEPATH</span></code></a> 環境變數以停用自動於 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> 的開頭<a class="reference internal" href="#whatsnew311-pythonsafepath"><span class="std std-ref">加上一個有潛在安全問題的路徑</span></a></p></li>
</ul>
<p>新增型別特性：</p>
<ul class="simple">
<li><p><a class="reference internal" href="#whatsnew311-pep646"><span class="std std-ref">PEP 646：可變參數泛型 (variadic generics)</span></a></p></li>
<li><p><a class="reference internal" href="#whatsnew311-pep655"><span class="std std-ref">PEP 655：標記獨立 TypedDict 項目為必要或不必要</span></a></p></li>
<li><p><a class="reference internal" href="#whatsnew311-pep673"><span class="std std-ref">PEP 673：Self 型別</span></a></p></li>
<li><p><a class="reference internal" href="#whatsnew311-pep675"><span class="std std-ref">PEP 675：任意的文本字串型別 (Arbitrary literal string type)</span></a></p></li>
<li><p><a class="reference internal" href="#whatsnew311-pep681"><span class="std std-ref">PEP 681：資料類別轉換 (Data class transforms)</span></a></p></li>
</ul>
<p>重要的棄用、移除與限制：</p>
<ul class="simple">
<li><p><span class="target" id="index-84"></span><a class="pep reference external" href="https://peps.python.org/pep-0594/"><strong>PEP 594</strong></a>：<a class="reference internal" href="#whatsnew311-pep594"><span class="std std-ref">許多標準函式庫中的遺留模組已被棄用</span></a>且將於 Python 3.13 移除</p></li>
<li><p><span class="target" id="index-85"></span><a class="pep reference external" href="https://peps.python.org/pep-0624/"><strong>PEP 624</strong></a>：<a class="reference internal" href="#whatsnew311-pep624"><span class="std std-ref">Py_UNICODE 編碼器 API 已被移除</span></a></p></li>
<li><p><span class="target" id="index-86"></span><a class="pep reference external" href="https://peps.python.org/pep-0670/"><strong>PEP 670</strong></a>：<a class="reference internal" href="#whatsnew311-pep670"><span class="std std-ref">轉換為靜態行內函式的巨集</span></a></p></li>
</ul>
</section>
<section id="new-features">
<span id="whatsnew311-features"></span><h2>新增特性<a class="headerlink" href="#new-features" title="連結到這個標頭">¶</a></h2>
<section id="pep-657-fine-grained-error-locations-in-tracebacks">
<span id="whatsnew311-pep657"></span><h3>PEP 657：回溯 (traceback) 中更細緻的錯誤位置<a class="headerlink" href="#pep-657-fine-grained-error-locations-in-tracebacks" title="連結到這個標頭">¶</a></h3>
<p>當要印出回溯，直譯器現在會指出造成錯誤的確切運算式，而非只說明是哪一行。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;distance.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">11</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">manhattan_distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
          <span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
  <span class="n">File</span> <span class="s2">&quot;distance.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">6</span><span class="p">,</span> <span class="ow">in</span> <span class="n">manhattan_distance</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">point_1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">point_2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">point_1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">point_2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                           <span class="o">^^^^^^^^^</span>
<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;NoneType&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;x&#39;</span>
</pre></div>
</div>
<p>前一版本的直譯器只會標明是哪一行，無法辨認哪一個物件是 <code class="docutils literal notranslate"><span class="pre">None</span></code>。當處理多層的巢狀 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 物件和多個函式呼叫時，這種強化錯誤提示也可能非常有用：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;query.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">37</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">magic_arithmetic</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;query.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">18</span><span class="p">,</span> <span class="ow">in</span> <span class="n">magic_arithmetic</span>
    <span class="k">return</span> <span class="n">add_counts</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">25</span>
           <span class="o">^^^^^^^^^^^^^</span>
  <span class="n">File</span> <span class="s2">&quot;query.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">24</span><span class="p">,</span> <span class="ow">in</span> <span class="n">add_counts</span>
    <span class="k">return</span> <span class="mi">25</span> <span class="o">+</span> <span class="n">query_user</span><span class="p">(</span><span class="n">user1</span><span class="p">)</span> <span class="o">+</span> <span class="n">query_user</span><span class="p">(</span><span class="n">user2</span><span class="p">)</span>
                <span class="o">^^^^^^^^^^^^^^^^^</span>
  <span class="n">File</span> <span class="s2">&quot;query.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">32</span><span class="p">,</span> <span class="ow">in</span> <span class="n">query_user</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">query_count</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="s1">&#39;b&#39;</span><span class="p">][</span><span class="s1">&#39;c&#39;</span><span class="p">][</span><span class="s1">&#39;user&#39;</span><span class="p">],</span> <span class="n">retry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                               <span class="o">~~~~~~~~~~~~~~~~~~^^^^^</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;NoneType&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">subscriptable</span>
</pre></div>
</div>
<p>在複雜的計算運算式中也是：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;calculation.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">54</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">y</span> <span class="o">/</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>
              <span class="o">~~~~~~^~~</span>
<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<p>此外，強化回溯特性所使用的資訊可以透過一般的 API 來取得，以用來使 <a class="reference internal" href="../glossary.html#term-bytecode"><span class="xref std std-term">bytecode</span></a> <a class="reference internal" href="../library/dis.html#bytecodes"><span class="std std-ref">指示 (instruction)</span></a>與原始碼位置相互關聯。此項資訊可以用以下方式取得：</p>
<ul class="simple">
<li><p>Python 中的 <a class="reference internal" href="../reference/datamodel.html#codeobject.co_positions" title="codeobject.co_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codeobject.co_positions()</span></code></a> 方法。</p></li>
<li><p>C API 中的 <a class="reference internal" href="../c-api/code.html#c.PyCode_Addr2Location" title="PyCode_Addr2Location"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_Addr2Location()</span></code></a> 函式。</p></li>
</ul>
<p>詳情請見 <span class="target" id="index-87"></span><a class="pep reference external" href="https://peps.python.org/pep-0657/"><strong>PEP 657</strong></a>。（由 Pablo Galindo、Batuhan Taskaya 與 Ammar Askar 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43950">bpo-43950</a> 中所貢獻。）</p>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>這個特性必須要將欄的位置 (column position) 儲存於 <a class="reference internal" href="../c-api/code.html#codeobjects"><span class="std std-ref">程式碼物件</span></a>，這可能會導致直譯器用於編譯 Python 檔案的記憶體使用量與硬碟使用量增加。為了避免儲存多餘的資訊且停用印出多餘的回溯資訊，請用 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">no_debug_ranges</span></code></a> 命令列選項或是 <span class="target" id="index-88"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONNODEBUGRANGES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONNODEBUGRANGES</span></code></a> 環境變數。</p>
</div>
</section>
<section id="pep-654-exception-groups-and-except">
<span id="whatsnew311-pep654"></span><h3>PEP 654：例外群組與 <code class="docutils literal notranslate"><span class="pre">except*</span></code><a class="headerlink" href="#pep-654-exception-groups-and-except" title="連結到這個標頭">¶</a></h3>
<p><span class="target" id="index-89"></span><a class="pep reference external" href="https://peps.python.org/pep-0654/"><strong>PEP 654</strong></a> 引入了新的的語言特性，可讓程式同時引發並處理多個相互無關的例外。內建型別 <a class="reference internal" href="../library/exceptions.html#ExceptionGroup" title="ExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> 和 <a class="reference internal" href="../library/exceptions.html#BaseExceptionGroup" title="BaseExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseExceptionGroup</span></code></a> 使得程式可為多個例外組成群組並同時引發，新的 <a class="reference internal" href="../reference/compound_stmts.html#except-star"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except*</span></code></a> 語法也將 <a class="reference internal" href="../reference/compound_stmts.html#except"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except</span></code></a> 泛用化、能夠比對例外群組的子群組。</p>
<p>詳情請見 <span class="target" id="index-90"></span><a class="pep reference external" href="https://peps.python.org/pep-0654/"><strong>PEP 654</strong></a>。</p>
<p>（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45292">bpo-45292</a> 中所貢獻。PEP 由 Irit Katriel、Yury Selivanov 與 Guido van Rossum 撰寫。）</p>
</section>
<section id="pep-678-exceptions-can-be-enriched-with-notes">
<span id="whatsnew311-pep678"></span><h3>PEP 678：運用例外註解使其更加詳盡<a class="headerlink" href="#pep-678-exceptions-can-be-enriched-with-notes" title="連結到這個標頭">¶</a></h3>
<p>新增 <a class="reference internal" href="../library/exceptions.html#BaseException.add_note" title="BaseException.add_note"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_note()</span></code></a> 方法到 <a class="reference internal" href="../library/exceptions.html#BaseException" title="BaseException"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseException</span></code></a>。當上下文資訊在例外被引發時無法被取得，這個方法就可以用來為例外添加更多資訊。被添加的註解會在預設回溯中出現。</p>
<p>詳情請見 <span class="target" id="index-91"></span><a class="pep reference external" href="https://peps.python.org/pep-0678/"><strong>PEP 678</strong></a>。</p>
<p>（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45607">bpo-45607</a> 中所貢獻。PEP 由 Zac Hatfield-Dodds 所撰寫）</p>
</section>
<section id="windows-py-exe-launcher-improvements">
<span id="whatsnew311-windows-launcher"></span><h3>Windows <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> 啟動程式 (launcher) 的改進<a class="headerlink" href="#windows-py-exe-launcher-improvements" title="連結到這個標頭">¶</a></h3>
<p>Python 3.11 所包含的 <a class="reference internal" href="../using/windows.html#launcher"><span class="std std-ref">Python Launcher for Windows</span></a> 複製品有了顯著的改善。它現在支援 <span class="target" id="index-92"></span><a class="pep reference external" href="https://peps.python.org/pep-0514/"><strong>PEP 514</strong></a> 所定義的公司/標籤 (tag) 語法，可用 <code class="samp docutils literal notranslate"><span class="pre">-V:</span><em><span class="pre">&lt;company&gt;</span></em><span class="pre">/</span><em><span class="pre">&lt;tag&gt;</span></em></code> 引數來取代受限的 <code class="samp docutils literal notranslate"><span class="pre">-</span><em><span class="pre">&lt;major&gt;</span></em><span class="pre">.</span><em><span class="pre">&lt;minor&gt;</span></em></code>。這允許了 <a class="reference external" href="https://www.python.org">python.org</a> 上的 <code class="docutils literal notranslate"><span class="pre">PythonCore</span></code> 以外的發行版本發布。</p>
<p>使用 <code class="docutils literal notranslate"><span class="pre">-V:</span></code> 選擇器時，可以省略公司或標籤，但會搜索所有安裝。例如，<code class="docutils literal notranslate"><span class="pre">-V:OtherPython/</span></code> 將選擇 <code class="docutils literal notranslate"><span class="pre">OtherPython</span></code> 註冊的「最佳」標籤，而 <code class="docutils literal notranslate"><span class="pre">-V:3.11</span></code> 或 <code class="docutils literal notranslate"><span class="pre">-V:/3.11</span></code> 將選擇帶有 <code class="docutils literal notranslate"><span class="pre">3.11</span></code> 標籤的「最佳」發行版。</p>
<p>當使用遺留的 <code class="samp docutils literal notranslate"><span class="pre">-</span><em><span class="pre">&lt;major&gt;</span></em></code>、<code class="samp docutils literal notranslate"><span class="pre">-</span><em><span class="pre">&lt;major&gt;</span></em><span class="pre">.</span><em><span class="pre">&lt;minor&gt;</span></em></code>、<code class="samp docutils literal notranslate"><span class="pre">-</span><em><span class="pre">&lt;major&gt;</span></em><span class="pre">-</span><em><span class="pre">&lt;bitness&gt;</span></em></code> 或 <code class="samp docutils literal notranslate"><span class="pre">-</span><em><span class="pre">&lt;major&gt;</span></em><span class="pre">.</span><em><span class="pre">&lt;minor&gt;</span></em><span class="pre">-</span><em><span class="pre">&lt;bitness&gt;</span></em></code> 引數時，所有過去版本的行為都應該保留下來，且只有 <code class="docutils literal notranslate"><span class="pre">PythonCore</span></code> 中的發布版本會被選用。然而，<code class="docutils literal notranslate"><span class="pre">-64</span></code> 後綴現在暗示了「非 32-bit」（不用一定要是 x86-64），因為現在有多個支援 64-bit 的平台。32-bit 運行程式會在檢查運行程式之標籤是否帶有 <code class="docutils literal notranslate"><span class="pre">-32</span></code> 後綴時被偵測出來。所有 Python 3.5 以後發布版本的 32-bit 建置中都有這個行為。</p>
</section>
</section>
<section id="new-features-related-to-type-hints">
<span id="whatsnew311-typing-features"></span><span id="new-feat-related-type-hints-311"></span><h2>型別提示相關的新特性<a class="headerlink" href="#new-features-related-to-type-hints" title="連結到這個標頭">¶</a></h2>
<p>這個部分涵蓋影響 <span class="target" id="index-93"></span><a class="pep reference external" href="https://peps.python.org/pep-0484/"><strong>PEP 484</strong></a> 型別提示 (type hints) 與 <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模組的重大變更。</p>
<section id="pep-646-variadic-generics">
<span id="whatsnew311-pep646"></span><h3>PEP 646：可變參數泛型 (variadic generics)<a class="headerlink" href="#pep-646-variadic-generics" title="連結到這個標頭">¶</a></h3>
<p><span class="target" id="index-94"></span><a class="pep reference external" href="https://peps.python.org/pep-0484/"><strong>PEP 484</strong></a> 先前引入了 <a class="reference internal" href="../library/typing.html#typing.TypeVar" title="typing.TypeVar"><code class="xref py py-data docutils literal notranslate"><span class="pre">TypeVar</span></code></a>，開啟了帶有單一型別的泛型參數化。<span class="target" id="index-95"></span><a class="pep reference external" href="https://peps.python.org/pep-0646/"><strong>PEP 646</strong></a> 新增 <a class="reference internal" href="../library/typing.html#typing.TypeVarTuple" title="typing.TypeVarTuple"><code class="xref py py-data docutils literal notranslate"><span class="pre">TypeVarTuple</span></code></a>，開啟了帶有<em>任意</em>數量型別的參數化 (parameterisation)。換句話說，<a class="reference internal" href="../library/typing.html#typing.TypeVarTuple" title="typing.TypeVarTuple"><code class="xref py py-data docutils literal notranslate"><span class="pre">TypeVarTuple</span></code></a> 是<em>可變的</em>型別變數，啟用了<em>可變的</em>泛型。</p>
<p>這使其有非常多用例，特別是它允許了像是 NumPy 和 Tensorflow 的數值運算函式庫中類似陣列結構的型別可用 <em>shape</em> 陣列來被參數化。靜態型別檢查工具現在也能夠為使用這些函式庫的程式捕捉到維度相關的錯誤。</p>
<p>詳情請見 <span class="target" id="index-96"></span><a class="pep reference external" href="https://peps.python.org/pep-0646/"><strong>PEP 646</strong></a>。</p>
<p>（由 Matthew Rahtz 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43224">bpo-43224</a> 中所貢獻，由 Serhiy Storchaka 與 Jelle Zijlstra 協助。PEP 由 Mark Mendoza、Matthew Rahtz、Pradeep Kumar Srinivasan 與 Vincent Siles 所撰寫）</p>
</section>
<section id="pep-655-marking-individual-typeddict-items-as-required-or-not-required">
<span id="whatsnew311-pep655"></span><h3>PEP 655：標記獨立 <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> 項目為必要或不必要<a class="headerlink" href="#pep-655-marking-individual-typeddict-items-as-required-or-not-required" title="連結到這個標頭">¶</a></h3>
<p><a class="reference internal" href="../library/typing.html#typing.Required" title="typing.Required"><code class="xref py py-data docutils literal notranslate"><span class="pre">Required</span></code></a> 與 <a class="reference internal" href="../library/typing.html#typing.NotRequired" title="typing.NotRequired"><code class="xref py py-data docutils literal notranslate"><span class="pre">NotRequired</span></code></a> 提供了標記一個獨立項目在 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></a> 中是否必須存在的直覺方法。在這之前，這只有透過繼承才有可能做得到。</p>
<p>所有欄位都預設為是必要的，除非 <em>total</em> 參數有被設為 <code class="docutils literal notranslate"><span class="pre">False</span></code>，那麼所有欄位就會是非必要的。例如，這個範例指定了要有一個必要鍵與一個非必要鍵的 <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code>：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Movie</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
   <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
   <span class="n">year</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

<span class="n">m1</span><span class="p">:</span> <span class="n">Movie</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Black Panther&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2018</span><span class="p">}</span>  <span class="c1"># OK</span>
<span class="n">m2</span><span class="p">:</span> <span class="n">Movie</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Star Wars&quot;</span><span class="p">}</span>  <span class="c1"># OK (year is not required)</span>
<span class="n">m3</span><span class="p">:</span> <span class="n">Movie</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2022</span><span class="p">}</span>  <span class="c1"># ERROR (missing required field title)</span>
</pre></div>
</div>
<p>以下定義等同於：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Movie</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
   <span class="n">title</span><span class="p">:</span> <span class="n">Required</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
   <span class="n">year</span><span class="p">:</span> <span class="nb">int</span>
</pre></div>
</div>
<p>詳情請見 <span class="target" id="index-97"></span><a class="pep reference external" href="https://peps.python.org/pep-0655/"><strong>PEP 655</strong></a>。</p>
<p>（由 David Foster 與 Jelle Zijlstra 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47087">bpo-47087</a> 中所貢獻。PEP 由 David Foster 所撰寫）</p>
</section>
<section id="pep-673-self-type">
<span id="whatsnew311-pep673"></span><h3>PEP 673：<code class="docutils literal notranslate"><span class="pre">Self</span></code> 型別<a class="headerlink" href="#pep-673-self-type" title="連結到這個標頭">¶</a></h3>
<p>新的 <a class="reference internal" href="../library/typing.html#typing.Self" title="typing.Self"><code class="xref py py-data docutils literal notranslate"><span class="pre">Self</span></code></a> 標註提供了一種簡單直觀的方法來標註那些會回傳其類別實例的方法。這與 <span class="target" id="index-98"></span><a class="pep reference external" href="https://peps.python.org/pep-0484/#annotating-instance-and-class-methods"><strong>PEP 484</strong></a> 中指定的基於 <a class="reference internal" href="../library/typing.html#typing.TypeVar" title="typing.TypeVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a> 的方法相同，但更簡潔且更易於遵循。</p>
<p>常見用例包括作為 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">classmethod</span></code></a> 的替代建構函式和會回傳 <code class="docutils literal notranslate"><span class="pre">self</span></code> 的 <a class="reference internal" href="../reference/datamodel.html#object.__enter__" title="object.__enter__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__enter__()</span></code></a> 方法：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLock</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="o">...</span>

<span class="k">class</span> <span class="nc">MyInt</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromhex</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="o">...</span>
</pre></div>
</div>
<p><a class="reference internal" href="../library/typing.html#typing.Self" title="typing.Self"><code class="xref py py-data docutils literal notranslate"><span class="pre">Self</span></code></a> 也可用於標註與其封閉類類別 (enclosing class) 相同的方法參數或屬性。</p>
<p>詳情請見 <span class="target" id="index-99"></span><a class="pep reference external" href="https://peps.python.org/pep-0673/"><strong>PEP 673</strong></a>。</p>
<p>（由 James Hilton-Balfe 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46534">bpo-46534</a> 中所貢獻。PEP 由 Pradeep Kumar Srinivasan 與 James Hilton-Balfe 所撰寫）</p>
</section>
<section id="pep-675-arbitrary-literal-string-type">
<span id="whatsnew311-pep675"></span><h3>PEP 675：任意的文本字串型別 (Arbitrary literal string type)<a class="headerlink" href="#pep-675-arbitrary-literal-string-type" title="連結到這個標頭">¶</a></h3>
<p>新的 <a class="reference internal" href="../library/typing.html#typing.LiteralString" title="typing.LiteralString"><code class="xref py py-data docutils literal notranslate"><span class="pre">LiteralString</span></code></a> 標註可用於標示一個函式參數可為任何文本字串型別 (literal string type)。這允許函式接受任意的文本字串型別，以及從其他文本字串建立的字串。型別檢查器就可以強制需審慎處理的函式（例如會執行 SQL 陳述式或 shell 命令的函式）僅會以靜態引數呼叫，從而提供針對注入攻擊的保護。</p>
<p>例如一個 SQL 查詢函式 (query function) 可以被標註為：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_query</span><span class="p">(</span><span class="n">sql</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">...</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">caller</span><span class="p">(</span>
    <span class="n">arbitrary_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">query_string</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">run_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM students&quot;</span><span class="p">)</span>       <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>                   <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">+</span> <span class="n">table_name</span><span class="p">)</span>  <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="n">arbitrary_string</span><span class="p">)</span>               <span class="c1"># type checker error</span>
    <span class="n">run_query</span><span class="p">(</span>                                <span class="c1"># type checker error</span>
        <span class="sa">f</span><span class="s2">&quot;SELECT * FROM students WHERE name = </span><span class="si">{</span><span class="n">arbitrary_string</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>詳情請見 <span class="target" id="index-100"></span><a class="pep reference external" href="https://peps.python.org/pep-0675/"><strong>PEP 675</strong></a>。</p>
<p>（由 Jelle Zijlstra 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47088">bpo-47088</a> 中所貢獻。PEP 由 Pradeep Kumar Srinivasan 與 Graham Bleaney 所撰寫）</p>
</section>
<section id="pep-681-data-class-transforms">
<span id="whatsnew311-pep681"></span><h3>PEP 681：資料類別轉換 (Data class transforms)<a class="headerlink" href="#pep-681-data-class-transforms" title="連結到這個標頭">¶</a></h3>
<p><a class="reference internal" href="../library/typing.html#typing.dataclass_transform" title="typing.dataclass_transform"><code class="xref py py-data docutils literal notranslate"><span class="pre">dataclass_transform</span></code></a> 可以用來裝飾一個類別、元類別 (metaclass)、或是一個本身就是裝飾器的函式。<code class="docutils literal notranslate"><span class="pre">&#64;dataclass_transform()</span></code> 的存在會讓一個靜態型別檢查器知道被裝飾物件會在運行程式做出轉換類別的「魔法」，賦予其類似 <a class="reference internal" href="../library/dataclasses.html#dataclasses.dataclass" title="dataclasses.dataclass"><code class="xref py py-func docutils literal notranslate"><span class="pre">dataclass</span></code></a> 的行為。</p>
<p>舉例來說：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The create_model decorator is defined by a library.</span>
<span class="nd">@typing</span><span class="o">.</span><span class="n">dataclass_transform</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">cls</span><span class="o">.</span><span class="fm">__eq__</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">cls</span><span class="o">.</span><span class="fm">__ne__</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="bp">cls</span>

<span class="c1"># The create_model decorator can now be used to create new model classes:</span>
<span class="nd">@create_model</span>
<span class="k">class</span> <span class="nc">CustomerModel</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">CustomerModel</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">327</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eric Idle&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>詳情請見 <span class="target" id="index-101"></span><a class="pep reference external" href="https://peps.python.org/pep-0681/"><strong>PEP 681</strong></a>。</p>
<p>（由 Jelle Zijlstra 於 <a class="reference external" href="https://github.com/python/cpython/issues/91860">gh-91860</a> 中所貢獻。PEP 由 Erik De Bonte 與 Eric Traut 所撰寫）</p>
</section>
<section id="pep-563-may-not-be-the-future">
<span id="whatsnew311-pep563-deferred"></span><h3>PEP 563 可能不是未來<a class="headerlink" href="#pep-563-may-not-be-the-future" title="連結到這個標頭">¶</a></h3>
<p><span class="target" id="index-102"></span><a class="pep reference external" href="https://peps.python.org/pep-0563/"><strong>PEP 563</strong></a> 標註的推遲求值 (Postponed Evaluation of Annotations)（<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code> <a class="reference internal" href="../reference/simple_stmts.html#future"><span class="std std-ref">future 陳述式</span></a>）最初計劃在 Python 3.10 中發布，但已被無限期擱置。請參閱<a class="reference external" href="https://mail.python.org/archives/list/python-dev&#64;python.org/message/VIZEBX5EYMSYIJNDBF6DMUMZOCWHARSO/">來自指導委員會 (Steering Counsil) 的訊息</a>以獲得更多資訊。</p>
</section>
</section>
<section id="other-language-changes">
<span id="whatsnew311-other-lang-changes"></span><h2>其他語言更動<a class="headerlink" href="#other-language-changes" title="連結到這個標頭">¶</a></h2>
<ul class="simple">
<li><p>星號拆解 (starred unpacking) 運算式現在可以在 <a class="reference internal" href="../reference/compound_stmts.html#for"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">for</span></code></a> 陳述式中使用。（詳情請見 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46725">bpo-46725</a>。）</p></li>
<li><p>非同步<a class="reference internal" href="../reference/expressions.html#comprehensions"><span class="std std-ref">綜合運算 (comprehension)</span></a> 現在允許在<a class="reference internal" href="../reference/compound_stmts.html#async-def"><span class="std std-ref">非同步函式中的內部綜合運算 (inside comprehension)</span></a>。在這種情況下，外部綜合運算 (outer comprehension) 隱晦地變成了非同步的了。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=33346">bpo-33346</a> 中貢獻。）</p></li>
<li><p>現在在不支援 <a class="reference internal" href="../glossary.html#term-context-manager"><span class="xref std std-term">context manager</span></a> 協議的物件上使用 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 陳述式和 <a class="reference internal" href="../library/contextlib.html#contextlib.ExitStack.enter_context" title="contextlib.ExitStack.enter_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contextlib.ExitStack.enter_context()</span></code></a> 或在不支援 <a class="reference internal" href="../glossary.html#term-asynchronous-context-manager"><span class="xref std std-term">asynchronous context manager</span></a> 協議的物件上使用 <a class="reference internal" href="../reference/compound_stmts.html#async-with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span></code></a> 陳述式和 <a class="reference internal" href="../library/contextlib.html#contextlib.AsyncExitStack.enter_async_context" title="contextlib.AsyncExitStack.enter_async_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contextlib.AsyncExitStack.enter_async_context()</span></code></a>，會引發 <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> 而不是 <a class="reference internal" href="../library/exceptions.html#AttributeError" title="AttributeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code></a>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=12022">bpo-12022</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44471">bpo-44471</a> 中貢獻。）</p></li>
<li><p>Added <a class="reference internal" href="../library/pickle.html#object.__getstate__" title="object.__getstate__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__getstate__()</span></code></a>, which provides the default
implementation of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__getstate__()</span></code> method. <a class="reference internal" href="../library/copy.html#module-copy" title="copy: Shallow and deep copy operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code></a>ing
and <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>ing instances of subclasses of builtin types
<a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#frozenset" title="frozenset"><code class="xref py py-class docutils literal notranslate"><span class="pre">frozenset</span></code></a>,
<a class="reference internal" href="../library/collections.html#collections.OrderedDict" title="collections.OrderedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.OrderedDict</span></code></a>, <a class="reference internal" href="../library/collections.html#collections.deque" title="collections.deque"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.deque</span></code></a>,
<a class="reference internal" href="../library/weakref.html#weakref.WeakSet" title="weakref.WeakSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">weakref.WeakSet</span></code></a>, and <a class="reference internal" href="../library/datetime.html#datetime.tzinfo" title="datetime.tzinfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.tzinfo</span></code></a> now copies and
pickles instance attributes implemented as <a class="reference internal" href="../glossary.html#term-__slots__"><span class="xref std std-term">slots</span></a>.
This change has an unintended side effect: It trips up a small minority
of existing Python projects not expecting <a class="reference internal" href="../library/pickle.html#object.__getstate__" title="object.__getstate__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__getstate__()</span></code></a> to
exist. See the later comments on <a class="reference external" href="https://github.com/python/cpython/issues/70766">gh-70766</a> for discussions of what
workarounds such code may need.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=26579">bpo-26579</a>.)</p></li>
</ul>
<ul class="simple" id="whatsnew311-pythonsafepath">
<li><p>新增了一個 <a class="reference internal" href="../using/cmdline.html#cmdoption-P"><code class="xref std std-option docutils literal notranslate"><span class="pre">-P</span></code></a> 命令列選項和一個 <span class="target" id="index-103"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSAFEPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONSAFEPATH</span></code></a> 環境變數，它們禁用了當使用 <a class="reference internal" href="../using/cmdline.html#cmdoption-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">-c</span></code></a> 和 <a class="reference internal" href="../using/cmdline.html#cmdoption-m"><code class="xref std std-option docutils literal notranslate"><span class="pre">-m</span></code></a> 以在運行腳本或當前目錄時自動添加到腳本目錄的 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>。這確保只有 stdlib 和已安裝的模組會被 <a class="reference internal" href="../reference/simple_stmts.html#import"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">import</span></code></a> 取用，以避免不小心或被惡意地將模組與本地（通常是使用者可寫入的）目錄中的模組重疊。（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/57684">gh-57684</a> 中貢獻。）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code> 選項被新增到 <a class="reference internal" href="../library/string.html#formatspec"><span class="std std-ref">格式規格 (Format Specification) 迷你語言</span></a>，它會強迫負的 0 在進位到格式精度後成為正的。更多詳情請見 <span class="target" id="index-104"></span><a class="pep reference external" href="https://peps.python.org/pep-0682/"><strong>PEP 682</strong></a>。（由 John Belmonte 於 <a class="reference external" href="https://github.com/python/cpython/issues/90153">gh-90153</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> 不再接受位元組。支援已在 Python 3.2 和 3.6 之間的某個時間停止，直到 Python 3.10.0 發布後才引起人們的注意。此外，由於混合使用 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 鍵時 <a class="reference internal" href="../using/cmdline.html#cmdoption-b"><code class="xref std std-option docutils literal notranslate"><span class="pre">-b</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path_importer_cache</span></code></a> 會出現的交互作用，恢復這項支援會出現問題。（由 Thomas Grainger 在 <a class="reference external" href="https://github.com/python/cpython/issues/91181">gh-91181</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="other-cpython-implementation-changes">
<span id="whatsnew311-other-implementation-changes"></span><h2>其他 CPython 實作更動<a class="headerlink" href="#other-cpython-implementation-changes" title="連結到這個標頭">¶</a></h2>
<ul class="simple">
<li><p>為支援 <a class="reference internal" href="../library/typing.html#typing.SupportsComplex" title="typing.SupportsComplex"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.SupportsComplex</span></code></a> 與 <a class="reference internal" href="../library/typing.html#typing.SupportsBytes" title="typing.SupportsBytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.SupportsBytes</span></code></a> 協定，實作了 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 與 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 的特殊方法 <a class="reference internal" href="../reference/datamodel.html#object.__complex__" title="object.__complex__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__complex__()</span></code></a> 與 <a class="reference internal" href="../reference/datamodel.html#object.__bytes__" title="object.__bytes__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__bytes__()</span></code></a>。（由 Mark Dickinson 和 Donghee Na 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=24234">bpo-24234</a> 中所貢獻。）</p></li>
<li><p>新增 <code class="docutils literal notranslate"><span class="pre">siphash13</span></code> 以作為內部的雜湊演算法，它有與 <code class="docutils literal notranslate"><span class="pre">siphash24</span></code> 相似的安全特性，但是在處理較長的輸入時會更快一些。現在是 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>、<a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 和一些其他型別的 <a class="reference internal" href="../library/functions.html#hash" title="hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash()</span></code></a> 預設演算法。<span class="target" id="index-105"></span><a class="pep reference external" href="https://peps.python.org/pep-0552/"><strong>PEP 552</strong></a> <a class="reference internal" href="../reference/import.html#pyc-invalidation"><span class="std std-ref">基於雜湊的 .pyc 檔案</span></a> 現在也使用 <code class="docutils literal notranslate"><span class="pre">siphash13</span></code>。（由 Inada Naoki 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=29410">bpo-29410</a> 中貢獻。）</p></li>
<li><p>當一個仍有效的例外被 <a class="reference internal" href="../reference/simple_stmts.html#raise"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">raise</span></code></a> 陳述式在沒有參數的情況下重新引發，被附於該例外的追蹤資訊現在都會是 <code class="docutils literal notranslate"><span class="pre">sys.exc_info()[1].__traceback__</span></code>。這代表對於當前 <a class="reference internal" href="../reference/compound_stmts.html#except"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except</span></code></a> 子句的追蹤上做的改動會反映在被重複引發的例外上。（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p>有被處理的例外在直譯器狀態的表示（也就是 <code class="docutils literal notranslate"><span class="pre">exc_info</span></code> 或 <code class="docutils literal notranslate"><span class="pre">_PyErr_StackItem</span></code>）現在只會有 <code class="docutils literal notranslate"><span class="pre">exc_value</span></code> 欄位；<code class="docutils literal notranslate"><span class="pre">exc_type</span></code> 和 <code class="docutils literal notranslate"><span class="pre">exc_traceback</span></code> 已被移除，現在只能透過 <code class="docutils literal notranslate"><span class="pre">exc_value</span></code> 來取得它們。（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p>新增<a class="reference internal" href="../using/windows.html#install-quiet-option"><span class="std std-ref">命令列選項</span></a> <code class="docutils literal notranslate"><span class="pre">AppendPath</span></code>，已增加於 Windows 安裝程式。它的行為類似於 <code class="docutils literal notranslate"><span class="pre">PrependPath</span></code>，但在安裝和腳本目錄後面附加而非新增於它們前面。（由 Bastian Neuburger 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44934">bpo-44934</a> 中貢獻。）</p></li>
<li><p>初始化中若是要用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a> 來初始化 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>，則現在 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths_set" title="PyConfig.module_search_paths_set"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths_set</span></code></a> 必須被設為 1。否則，初始化會重新計算路徑並取代所有被加到 <code class="docutils literal notranslate"><span class="pre">module_search_paths</span></code> 的值。</p></li>
<li><p><a class="reference internal" href="../using/cmdline.html#cmdoption-help"><code class="xref std std-option docutils literal notranslate"><span class="pre">--help</span></code></a> 選項的輸出現在會在 50 列、80 欄的大小之內，<a class="reference internal" href="../using/cmdline.html#using-on-envvars"><span class="std std-ref">Python 環境變數</span></a>和 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span></code></a> 選項的資訊現在能夠分別透過 <a class="reference internal" href="../using/cmdline.html#cmdoption-help-env"><code class="xref std std-option docutils literal notranslate"><span class="pre">--help-env</span></code></a> 和 <a class="reference internal" href="../using/cmdline.html#cmdoption-help-xoptions"><code class="xref std std-option docutils literal notranslate"><span class="pre">--help-xoptions</span></code></a> 旗標與 <a class="reference internal" href="../using/cmdline.html#cmdoption-help-all"><code class="xref std std-option docutils literal notranslate"><span class="pre">--help-all</span></code></a> 一起使用來取得。（由 Éric Araujo 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46142">bpo-46142</a> 中貢獻。）</p></li>
<li><p>在除 2（binary、二進制）、4、8（octal、八進制）、16（hexadecimal、十六進制）或 32 以外的基數中，例如以 10（decimal、十進制）為基數，進行 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 之間的轉換且字串形式的位數超過限制，現在會引發 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>，以避免由於演算法複雜性而導致的潛在阻斷服務攻擊 (denial of service attacks)。這是針對 <a class="extlink-cve reference external" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10735">CVE-2020-10735</a> 的緩解措施，可以透過環境變數、命令列旗標或 <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> API 來設定或禁用此限制。請參閱<a class="reference internal" href="../library/stdtypes.html#int-max-str-digits"><span class="std std-ref">整數字串轉換長度限制</span></a> 文件。預設限制為字串形式的 4300 位數字。</p></li>
</ul>
</section>
<section id="new-modules">
<span id="whatsnew311-new-modules"></span><h2>新增模組<a class="headerlink" href="#new-modules" title="連結到這個標頭">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../library/tomllib.html#module-tomllib" title="tomllib: Parse TOML files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tomllib</span></code></a>：用於剖析 <a class="reference external" href="https://toml.io/">TOML</a>。詳情請見 <span class="target" id="index-106"></span><a class="pep reference external" href="https://peps.python.org/pep-0680/"><strong>PEP 680</strong></a>。（由 Taneli Hukkinen 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40059">bpo-40059</a> 中所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/wsgiref.html#module-wsgiref.types" title="wsgiref.types: WSGI types for static type checking"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref.types</span></code></a>：<span class="target" id="index-107"></span><a class="pep reference external" href="https://peps.python.org/pep-3333/"><strong>WSGI</strong></a> 限定型別，用於靜態型別檢查。（Sebastian Rittau 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=42012">bpo-42012</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="improved-modules">
<span id="whatsnew311-improved-modules"></span><h2>改進的模組<a class="headerlink" href="#improved-modules" title="連結到這個標頭">¶</a></h2>
<section id="asyncio">
<span id="whatsnew311-asyncio"></span><h3>asyncio<a class="headerlink" href="#asyncio" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>添加了 <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup" title="asyncio.TaskGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskGroup</span></code></a> 類別，為一個會持有任務群組並在退出時等待全部完成的<a class="reference internal" href="../reference/datamodel.html#async-context-managers"><span class="std std-ref">非同步情境管理器 (asynchronous context manager)</span></a>。對於新程式碼，建議直接使用 <a class="reference internal" href="../library/asyncio-task.html#asyncio.create_task" title="asyncio.create_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_task()</span></code></a> 和 <a class="reference internal" href="../library/asyncio-task.html#asyncio.gather" title="asyncio.gather"><code class="xref py py-func docutils literal notranslate"><span class="pre">gather()</span></code></a>。（由 Yury Selivanov 和其他人在 <a class="reference external" href="https://github.com/python/cpython/issues/90908">gh-90908</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/asyncio-task.html#asyncio.timeout" title="asyncio.timeout"><code class="xref py py-func docutils literal notranslate"><span class="pre">timeout()</span></code></a>，是一個用來為一個非同步操作設置超時的非同步情境管理器，新的程式建議直接使用它以取代 <a class="reference internal" href="../library/asyncio-task.html#asyncio.wait_for" title="asyncio.wait_for"><code class="xref py py-func docutils literal notranslate"><span class="pre">wait_for()</span></code></a>。（由 Andrew Svetlov 於 <a class="reference external" href="https://github.com/python/cpython/issues/90927">gh-90927</a> 貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.Runner" title="asyncio.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> 類別，它會對外公布了 <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> 的使用機制。（由 Andrew Svetlov 於 <a class="reference external" href="https://github.com/python/cpython/issues/91218">gh-91218</a> 貢獻。）</p></li>
<li><p>於 asyncio 函式庫的同步化原始物件中新增 <a class="reference internal" href="../library/asyncio-sync.html#asyncio.Barrier" title="asyncio.Barrier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Barrier</span></code></a> 類別與和其相關的 <a class="reference internal" href="../library/asyncio-sync.html#asyncio.BrokenBarrierError" title="asyncio.BrokenBarrierError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BrokenBarrierError</span></code></a> 例外。（由 Yves Duprat 和 Andrew Svetlov in <a class="reference external" href="https://github.com/python/cpython/issues/87518">gh-87518</a> 貢獻。）</p></li>
<li><p>在 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.create_connection" title="asyncio.loop.create_connection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.create_connection()</span></code></a> 新增關鍵字引數 <em>all_errors</em>，這樣多個連接錯誤就可以一起用一個 <a class="reference internal" href="../library/exceptions.html#ExceptionGroup" title="ExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> 來引發。</p></li>
<li><p>新增 <a class="reference internal" href="../library/asyncio-stream.html#asyncio.StreamWriter.start_tls" title="asyncio.StreamWriter.start_tls"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.StreamWriter.start_tls()</span></code></a> 方法，用來將已存在的串流連線升級至 TLS。（由 Ian Good 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=34975">bpo-34975</a> 中貢獻。）</p></li>
<li><p>在事件迴圈增加原始資料元 (raw datagram) socket 函式：<a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.sock_sendto" title="asyncio.loop.sock_sendto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sock_sendto()</span></code></a>、<a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.sock_recvfrom" title="asyncio.loop.sock_recvfrom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sock_recvfrom()</span></code></a> 和 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.sock_recvfrom_into" title="asyncio.loop.sock_recvfrom_into"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sock_recvfrom_into()</span></code></a>。以上在 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.SelectorEventLoop" title="asyncio.SelectorEventLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectorEventLoop</span></code></a> 和 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.ProactorEventLoop" title="asyncio.ProactorEventLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProactorEventLoop</span></code></a> 中都有實作。（由 Alex Grönholm 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46805">bpo-46805</a> 中貢獻。）</p></li>
<li><p>於 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> 新增 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task.cancelling" title="asyncio.Task.cancelling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancelling()</span></code></a> 和 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task.uncancel" title="asyncio.Task.uncancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">uncancel()</span></code></a> 方法。這些預期是只用於內部，尤其是 <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup" title="asyncio.TaskGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskGroup</span></code></a>。</p></li>
</ul>
</section>
<section id="contextlib">
<span id="whatsnew311-contextlib"></span><h3>contextlib<a class="headerlink" href="#contextlib" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>添加了非平行安全的 <a class="reference internal" href="../library/contextlib.html#contextlib.chdir" title="contextlib.chdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">chdir()</span></code></a> 情境管理器來更改當前工作目錄，然後在退出時恢復它。<a class="reference internal" href="../library/os.html#os.chdir" title="os.chdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">chdir()</span></code></a> 的簡單包裝器。（由 Filipe Laíns 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=25625">bpo-25625</a> 中貢獻）</p></li>
</ul>
</section>
<section id="dataclasses">
<span id="whatsnew311-dataclasses"></span><h3>dataclasses<a class="headerlink" href="#dataclasses" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>更改欄位預設的可變性檢查 (mutability check)，僅允許預設值是 <a class="reference internal" href="../glossary.html#term-hashable"><span class="xref std std-term">hashable</span></a> 而不是任何非 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>、<a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> 或 <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> 實例的物件。（由 Eric V. Smith 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44674">bpo-44674</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="datetime">
<span id="whatsnew311-datetime"></span><h3>datetime<a class="headerlink" href="#datetime" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/datetime.html#datetime.UTC" title="datetime.UTC"><code class="xref py py-const docutils literal notranslate"><span class="pre">datetime.UTC</span></code></a>，一個 <a class="reference internal" href="../library/datetime.html#datetime.timezone.utc" title="datetime.timezone.utc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">datetime.timezone.utc</span></code></a> 的方便別名。（由 Kabir Kwatra 於 <a class="reference external" href="https://github.com/python/cpython/issues/91973">gh-91973</a> 所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/datetime.html#datetime.date.fromisoformat" title="datetime.date.fromisoformat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.date.fromisoformat()</span></code></a>、<a class="reference internal" href="../library/datetime.html#datetime.time.fromisoformat" title="datetime.time.fromisoformat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.time.fromisoformat()</span></code></a> 和 <a class="reference internal" href="../library/datetime.html#datetime.datetime.fromisoformat" title="datetime.datetime.fromisoformat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.fromisoformat()</span></code></a> 現在可以用來剖析大部分的 ISO 8601 格式（除了那些支援分數形式的小時與分鐘）。（由 Paul Ganssle 於 <a class="reference external" href="https://github.com/python/cpython/issues/80010">gh-80010</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="enum">
<span id="whatsnew311-enum"></span><h3>enum<a class="headerlink" href="#enum" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumMeta</span></code> 更名為 <a class="reference internal" href="../library/enum.html#enum.EnumType" title="enum.EnumType"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumType</span></code></a>（<code class="xref py py-class docutils literal notranslate"><span class="pre">EnumMeta</span></code> 保留為別名）。</p></li>
<li><p>增加 <a class="reference internal" href="../library/enum.html#enum.StrEnum" title="enum.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a>，列舉 (enum) 內的成員必須是字串。</p></li>
<li><p>新增 <a class="reference internal" href="../library/enum.html#enum.ReprEnum" title="enum.ReprEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReprEnum</span></code></a>，它只修改成員的 <a class="reference internal" href="../reference/datamodel.html#object.__repr__" title="object.__repr__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__repr__()</span></code></a>，同時回傳成員的文本值 (literal value)（而不是名稱），以用於（為 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-func docutils literal notranslate"><span class="pre">str()</span></code></a>、<a class="reference internal" href="../library/functions.html#format" title="format"><code class="xref py py-func docutils literal notranslate"><span class="pre">format()</span></code></a> 和 <a class="reference internal" href="../glossary.html#term-f-string"><span class="xref std std-term">f-string</span></a> 所使用的）<a class="reference internal" href="../reference/datamodel.html#object.__str__" title="object.__str__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code></a> 和 <a class="reference internal" href="../reference/datamodel.html#object.__format__" title="object.__format__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__format__()</span></code></a>。</p></li>
<li><p>改變了 <a class="reference internal" href="../library/enum.html#enum.Enum.__format__" title="enum.Enum.__format__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Enum.__format__()</span></code></a> （被 <a class="reference internal" href="../library/functions.html#format" title="format"><code class="xref py py-func docutils literal notranslate"><span class="pre">format()</span></code></a>、<a class="reference internal" href="../library/stdtypes.html#str.format" title="str.format"><code class="xref py py-meth docutils literal notranslate"><span class="pre">str.format()</span></code></a> 和 <a class="reference internal" href="../glossary.html#term-f-string"><span class="xref std std-term">f-string</span></a> 預設使用），以使其與 <a class="reference internal" href="../library/enum.html#enum.Enum.__str__" title="enum.Enum.__str__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enum.Enum.__str__</span></code></a> 產生相同結果：對於繼承自 <a class="reference internal" href="../library/enum.html#enum.ReprEnum" title="enum.ReprEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReprEnum</span></code></a> 的列舉，這會是成員之值；而其他的列舉會是列舉與成員名稱（例如 <code class="docutils literal notranslate"><span class="pre">Color.RED</span></code>）。</p></li>
<li><p>新增 <em>boundary</em> 類別參數與其選項到 <a class="reference internal" href="../library/enum.html#enum.Flag" title="enum.Flag"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flag</span></code></a> 列舉和 <a class="reference internal" href="../library/enum.html#enum.FlagBoundary" title="enum.FlagBoundary"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlagBoundary</span></code></a> 列舉以控制處理超出範圍旗標數值的方法。</p></li>
<li><p>新增了 <a class="reference internal" href="../library/enum.html#enum.verify" title="enum.verify"><code class="xref py py-func docutils literal notranslate"><span class="pre">verify()</span></code></a> 列舉裝飾器和 <a class="reference internal" href="../library/enum.html#enum.EnumCheck" title="enum.EnumCheck"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumCheck</span></code></a> 列舉及其選項，以根據幾個特定限制檢查列舉類別。</p></li>
<li><p>新增 <a class="reference internal" href="../library/enum.html#enum.member" title="enum.member"><code class="xref py py-func docutils literal notranslate"><span class="pre">member()</span></code></a> 與 <a class="reference internal" href="../library/enum.html#enum.nonmember" title="enum.nonmember"><code class="xref py py-func docutils literal notranslate"><span class="pre">nonmember()</span></code></a> 裝飾器以確保被裝飾的物件會/不會被轉換成一個列舉成員。</p></li>
<li><p>新增 <a class="reference internal" href="../library/enum.html#enum.property" title="enum.property"><code class="xref py py-func docutils literal notranslate"><span class="pre">property()</span></code></a> 裝飾器，它的作用類似 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-func docutils literal notranslate"><span class="pre">property()</span></code></a> 但是是用於列舉，用以替代 <a class="reference internal" href="../library/types.html#types.DynamicClassAttribute" title="types.DynamicClassAttribute"><code class="xref py py-func docutils literal notranslate"><span class="pre">types.DynamicClassAttribute()</span></code></a>。</p></li>
<li><p>新增 <a class="reference internal" href="../library/enum.html#enum.global_enum" title="enum.global_enum"><code class="xref py py-func docutils literal notranslate"><span class="pre">global_enum()</span></code></a> 列舉裝飾器，用來調整 <a class="reference internal" href="../reference/datamodel.html#object.__repr__" title="object.__repr__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__repr__()</span></code></a> 和 <a class="reference internal" href="../reference/datamodel.html#object.__str__" title="object.__str__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code></a> 以模組成員形式而非列舉類別來顯示值。例如，<a class="reference internal" href="../library/re.html#re.RegexFlag" title="re.RegexFlag"><code class="xref py py-class docutils literal notranslate"><span class="pre">re.RegexFlag</span></code></a> 的 <a class="reference internal" href="../library/re.html#re.ASCII" title="re.ASCII"><code class="xref py py-const docutils literal notranslate"><span class="pre">ASCII</span></code></a> 成員的 <code class="docutils literal notranslate"><span class="pre">'re.ASCII'</span></code>，而非 <code class="docutils literal notranslate"><span class="pre">'RegexFlag.ASCII'</span></code>。</p></li>
<li><p>強化 <a class="reference internal" href="../library/enum.html#enum.Flag" title="enum.Flag"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flag</span></code></a> 以支援使用 <a class="reference internal" href="../library/functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code></a>、疊代 (iteration) 和 <a class="reference internal" href="../reference/expressions.html#in"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">in</span></code></a>/<a class="reference internal" href="../reference/expressions.html#not-in"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code></a> 於其成員。例如，以下程式現在能夠作用了：<code class="docutils literal notranslate"><span class="pre">len(AFlag(3))</span> <span class="pre">==</span> <span class="pre">2</span> <span class="pre">and</span> <span class="pre">list(AFlag(3))</span> <span class="pre">==</span> <span class="pre">(AFlag.ONE,</span> <span class="pre">AFlag.TWO)</span></code></p></li>
<li><p>更改了 <a class="reference internal" href="../library/enum.html#enum.Enum" title="enum.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> 和 <a class="reference internal" href="../library/enum.html#enum.Flag" title="enum.Flag"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flag</span></code></a> 以在呼叫 <a class="reference internal" href="../reference/datamodel.html#object.__init_subclass__" title="object.__init_subclass__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init_subclass__()</span></code></a> 之前就定義成員；<a class="reference internal" href="../library/functions.html#dir" title="dir"><code class="xref py py-func docutils literal notranslate"><span class="pre">dir()</span></code></a> 現在包括來自混合資料型別的方法。</p></li>
<li><p>更改 <a class="reference internal" href="../library/enum.html#enum.Flag" title="enum.Flag"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flag</span></code></a> 以僅考慮主要值（2 的次方）規範，而複合值（<code class="docutils literal notranslate"><span class="pre">3</span></code>、<code class="docutils literal notranslate"><span class="pre">6</span></code>、<code class="docutils literal notranslate"><span class="pre">10</span></code> 等）被視為別名；倒置旗標 (inverted flags) 會被強制轉換為正等價的值。</p></li>
</ul>
</section>
<section id="fcntl">
<span id="whatsnew311-fcntl"></span><h3>fcntl<a class="headerlink" href="#fcntl" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>FreeBSD 上，<code class="xref py py-data docutils literal notranslate"><span class="pre">F_DUP2FD</span></code> 和 <code class="xref py py-data docutils literal notranslate"><span class="pre">F_DUP2FD_CLOEXEC</span></code> 旗標分別有被支援，前者等同於 <code class="docutils literal notranslate"><span class="pre">dup2</span></code> 用法，而後者設定了 <code class="docutils literal notranslate"><span class="pre">FD_CLOEXEC</span></code> 旗標。</p></li>
</ul>
</section>
<section id="fractions">
<span id="whatsnew311-fractions"></span><h3>fractions<a class="headerlink" href="#fractions" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>支援有 <span class="target" id="index-108"></span><a class="pep reference external" href="https://peps.python.org/pep-0515/"><strong>PEP 515</strong></a> 風格的 <a class="reference internal" href="../library/fractions.html#fractions.Fraction" title="fractions.Fraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fraction</span></code></a> 以字串初始化。（Sergey B Kirpichev 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44258">bpo-44258</a> 中所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/fractions.html#fractions.Fraction" title="fractions.Fraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fraction</span></code></a> 現在有實作了一個 <code class="docutils literal notranslate"><span class="pre">__int__</span></code> 方法，因此 <code class="docutils literal notranslate"><span class="pre">isinstance(some_fraction,</span> <span class="pre">typing.SupportsInt)</span></code> 的檢查會通過。（由 Mark Dickinson 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44547">bpo-44547</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="functools">
<span id="whatsnew311-functools"></span><h3>functools<a class="headerlink" href="#functools" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p><a class="reference internal" href="../library/functools.html#functools.singledispatch" title="functools.singledispatch"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.singledispatch()</span></code></a> 現在支援 <a class="reference internal" href="../library/types.html#types.UnionType" title="types.UnionType"><code class="xref py py-data docutils literal notranslate"><span class="pre">types.UnionType</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.Union" title="typing.Union"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code></a> 作為調度 (dispatch) 引數的標註。</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">singledispatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@singledispatch</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let me just say,&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@fun</span><span class="o">.</span><span class="n">register</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Strength in numbers, eh?&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@fun</span><span class="o">.</span><span class="n">register</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enumerate this:&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>（由 Yurii Karabas 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46014">bpo-46014</a> 中所貢獻。）</p>
</li>
</ul>
</section>
<section id="gzip">
<span id="whatsnew311-gzip"></span><h3>gzip<a class="headerlink" href="#gzip" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>The <a class="reference internal" href="../library/gzip.html#gzip.compress" title="gzip.compress"><code class="xref py py-func docutils literal notranslate"><span class="pre">gzip.compress()</span></code></a> function is now faster when used with the
<strong>mtime=0</strong> argument as it delegates the compression entirely to a single
<a class="reference internal" href="../library/zlib.html#zlib.compress" title="zlib.compress"><code class="xref py py-func docutils literal notranslate"><span class="pre">zlib.compress()</span></code></a> operation. There is one side effect of this change: The
gzip file header contains an &quot;OS&quot; byte in its header. That was traditionally
always set to a value of 255 representing &quot;unknown&quot; by the <a class="reference internal" href="../library/gzip.html#module-gzip" title="gzip: Interfaces for gzip compression and decompression using file objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gzip</span></code></a>
module. Now, when using <a class="reference internal" href="../library/gzip.html#gzip.compress" title="gzip.compress"><code class="xref py py-func docutils literal notranslate"><span class="pre">compress()</span></code></a> with <strong>mtime=0</strong>, it may be
set to a different value by the underlying zlib C library Python was linked
against.
(See <a class="reference external" href="https://github.com/python/cpython/issues/112346">gh-112346</a> for details on the side effect.)</p></li>
</ul>
</section>
<section id="hashlib">
<span id="whatsnew311-hashlib"></span><h3>hashlib<a class="headerlink" href="#hashlib" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/hashlib.html#hashlib.blake2b" title="hashlib.blake2b"><code class="xref py py-func docutils literal notranslate"><span class="pre">hashlib.blake2b()</span></code></a> 與 <a class="reference internal" href="../library/hashlib.html#hashlib.blake2s" title="hashlib.blake2s"><code class="xref py py-func docutils literal notranslate"><span class="pre">hashlib.blake2s()</span></code></a> 現在偏好使用 <a class="reference external" href="https://www.blake2.net/">libb2</a> 多於 Python 自發行版的複製。（由 Christian Heimes 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47095">bpo-47095</a> 中所貢獻。）</p></li>
<li><p>帶有 SHA3 和 SHAKE 演算法的內部 <code class="docutils literal notranslate"><span class="pre">_sha3</span></code> 模組現在使用 <em>tiny_sha3</em> 而不是 <em>Keccak 程式碼套件</em>來減少程式碼和二進位檔案大小。<a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><code class="xref py py-mod docutils literal notranslate"><span class="pre">hashlib</span></code></a> 模組更喜歡來自 OpenSSL 的 SHA3 和 SHAKE 最佳化實作。此更改僅影響沒有 OpenSSL 支援的安裝。（由 Christian Heimes 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47098">bpo-47098</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/hashlib.html#hashlib.file_digest" title="hashlib.file_digest"><code class="xref py py-func docutils literal notranslate"><span class="pre">hashlib.file_digest()</span></code></a>，是個能夠為檔案或類檔案物件做高效率雜湊的幫助函式。（由 Christian Heimes 於 <a class="reference external" href="https://github.com/python/cpython/issues/89313">gh-89313</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="whatsnew311-idle">
<span id="idle-and-idlelib"></span><h3>IDLE 與 idlelib<a class="headerlink" href="#whatsnew311-idle" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>在 <code class="docutils literal notranslate"><span class="pre">.pyi</span></code> 檔案施用語法突顯 (syntax highlight)。（由 Alex Waygood 與 Terry Jan Reedy 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45447">bpo-45447</a> 中所貢獻。）</p></li>
<li><p>當帶有輸入與輸出地儲存 Shell 時，也會包含提示字元。（由 Terry Jan Reedy 於 <a class="reference external" href="https://github.com/python/cpython/issues/95191">gh-95191</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="inspect">
<span id="whatsnew311-inspect"></span><h3>inspect<a class="headerlink" href="#inspect" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>添加 <a class="reference internal" href="../library/inspect.html#inspect.getmembers_static" title="inspect.getmembers_static"><code class="xref py py-func docutils literal notranslate"><span class="pre">getmembers_static()</span></code></a> 以回傳所有成員，而不會通過描述器協議 (descriptor protocol) 觸發動態查找。（由 Weipeng Hong 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=30533">bpo-30533</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/inspect.html#inspect.ismethodwrapper" title="inspect.ismethodwrapper"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.ismethodwrapper()</span></code></a>，用來檢查一個物件的型別是否為 <a class="reference internal" href="../library/types.html#types.MethodWrapperType" title="types.MethodWrapperType"><code class="xref py py-class docutils literal notranslate"><span class="pre">MethodWrapperType</span></code></a>。（由 Hakan Çelik 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=29418">bpo-29418</a> 中所貢獻。）</p></li>
<li><p>更改 <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">inspect</span></code></a> 模組中與幀相關的函式以回傳新的 <a class="reference internal" href="../library/inspect.html#inspect.FrameInfo" title="inspect.FrameInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrameInfo</span></code></a> 和 <a class="reference internal" href="../library/inspect.html#inspect.Traceback" title="inspect.Traceback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Traceback</span></code></a> 類別實例（向後相容之前類似於 <a class="reference internal" href="../glossary.html#term-named-tuple"><span class="xref std std-term">named tuple</span></a> 的介面），包括擴充的 <span class="target" id="index-109"></span><a class="pep reference external" href="https://peps.python.org/pep-0657/"><strong>PEP 657</strong></a> 位置資訊（結束行號、欄和結束欄）。受影響的功能是：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/inspect.html#inspect.getframeinfo" title="inspect.getframeinfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.getframeinfo()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/inspect.html#inspect.getouterframes" title="inspect.getouterframes"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.getouterframes()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/inspect.html#inspect.getinnerframes" title="inspect.getinnerframes"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.getinnerframes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="../library/inspect.html#inspect.stack" title="inspect.stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.stack()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/inspect.html#inspect.trace" title="inspect.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.trace()</span></code></a></p></li>
</ul>
<p>（由 Pablo Galindo 於 <a class="reference external" href="https://github.com/python/cpython/issues/88116">gh-88116</a> 中所貢獻。）</p>
</li>
</ul>
</section>
<section id="locale">
<span id="whatsnew311-locale"></span><h3>locale<a class="headerlink" href="#locale" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/locale.html#locale.getencoding" title="locale.getencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getencoding()</span></code></a> 以取得當前的區域編碼 (locale encoding)。和 <code class="docutils literal notranslate"><span class="pre">locale.getpreferredencoding(False)</span></code> 類似但不考慮 <a class="reference internal" href="../library/os.html#utf8-mode"><span class="std std-ref">Python UTF-8 模式</span></a>。</p></li>
</ul>
</section>
<section id="logging">
<span id="whatsnew311-logging"></span><h3>logging<a class="headerlink" href="#logging" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/logging.html#logging.getLevelNamesMapping" title="logging.getLevelNamesMapping"><code class="xref py py-func docutils literal notranslate"><span class="pre">getLevelNamesMapping()</span></code></a> 以回傳一個日誌級別名稱（例如 <code class="docutils literal notranslate"><span class="pre">'CRITICAL'</span></code>）指到對應的 <a class="reference internal" href="../library/logging.html#levels"><span class="std std-ref">Logging Levels</span></a> 數值（例如，預設為 <code class="docutils literal notranslate"><span class="pre">50</span></code>）的映射。（由 Andrei Kulakovin 於 <a class="reference external" href="https://github.com/python/cpython/issues/88024">gh-88024</a> 中貢獻。）</p></li>
<li><p>添加了一個 <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SysLogHandler.createSocket" title="logging.handlers.SysLogHandler.createSocket"><code class="xref py py-meth docutils literal notranslate"><span class="pre">createSocket()</span></code></a> 方法到 <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SysLogHandler" title="logging.handlers.SysLogHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SysLogHandler</span></code></a>，以匹配 <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SocketHandler.createSocket" title="logging.handlers.SocketHandler.createSocket"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SocketHandler.createSocket()</span></code></a> 。如果沒有已啟用的 socket，它會在處理程式初始化期間和發出一個事件時自動呼叫。（由 Kirill Pinchuk 在 <a class="reference external" href="https://github.com/python/cpython/issues/88457">gh-88457</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="math">
<span id="whatsnew311-math"></span><h3>math<a class="headerlink" href="#math" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/math.html#math.exp2" title="math.exp2"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.exp2()</span></code></a>：回傳 2 的 x 次方。（由 Gideon Mitchell 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45917">bpo-45917</a> 中所貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/math.html#math.cbrt" title="math.cbrt"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.cbrt()</span></code></a>：回傳 x 的立方根。（由 Ajith Ramachandran 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44357">bpo-44357</a> 中所貢獻。）</p></li>
<li><p>為了與 IEEE 754 規範保持一致，更改了兩個 <a class="reference internal" href="../library/math.html#math.pow" title="math.pow"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.pow()</span></code></a> 邊角案例 (corner case) 的行為。<code class="docutils literal notranslate"><span class="pre">math.pow(0.0,</span> <span class="pre">-math.inf)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">math.pow(-0.0,</span> <span class="pre">-math.inf)</span></code> 現在回傳 <code class="docutils literal notranslate"><span class="pre">inf</span></code>，之前它們會引發 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。（由 Mark Dickinson 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44339">bpo-44339</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/math.html#math.nan" title="math.nan"><code class="xref py py-data docutils literal notranslate"><span class="pre">math.nan</span></code></a> 現為隨時可用。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46917">bpo-46917</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="operator">
<span id="whatsnew311-operator"></span><h3>operator<a class="headerlink" href="#operator" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <code class="docutils literal notranslate"><span class="pre">operator.call</span></code> 函式，使得 <code class="docutils literal notranslate"><span class="pre">operator.call(obj,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span> <span class="pre">==</span> <span class="pre">obj(*args,</span> <span class="pre">**kwargs)</span></code>。（由 Antony Lee 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44019">bpo-44019</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="os">
<span id="whatsnew311-os"></span><h3>os<a class="headerlink" href="#os" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>在 Windows 上，<a class="reference internal" href="../library/os.html#os.urandom" title="os.urandom"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.urandom()</span></code></a> 現在使用 <code class="docutils literal notranslate"><span class="pre">BCryptGenRandom()</span></code> 以取代被棄用的 <code class="docutils literal notranslate"><span class="pre">CryptGenRandom()</span></code>。（由 Donghee Na 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44611">bpo-44611</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="pathlib">
<span id="whatsnew311-pathlib"></span><h3>pathlib<a class="headerlink" href="#pathlib" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>如果 <em>pattern</em> 以路徑名稱元件分隔符號 <a class="reference internal" href="../library/os.html#os.sep" title="os.sep"><code class="xref py py-data docutils literal notranslate"><span class="pre">sep</span></code></a> 或 <a class="reference internal" href="../library/os.html#os.altsep" title="os.altsep"><code class="xref py py-data docutils literal notranslate"><span class="pre">altsep</span></code></a> 結尾，<a class="reference internal" href="../library/pathlib.html#pathlib.Path.glob" title="pathlib.Path.glob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">glob()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.rglob" title="pathlib.Path.rglob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rglob()</span></code></a> 只回傳目錄。（由 Eisuke Kawasima 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=22276">bpo-22276</a> 與 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=33392">bpo-33392</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="re">
<span id="whatsnew311-re"></span><h3>re<a class="headerlink" href="#re" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>現在規則運算式 (regular expression) 是有支援原子性群組 (atomic grouping) (<code class="docutils literal notranslate"><span class="pre">(?&gt;...)</span></code>) 和佔有性量詞 (possessive quantifier) (<code class="docutils literal notranslate"><span class="pre">*+</span></code>, <code class="docutils literal notranslate"><span class="pre">++</span></code>, <code class="docutils literal notranslate"><span class="pre">?+</span></code>, <code class="docutils literal notranslate"><span class="pre">{m,n}+</span></code>) 的。（由 Jeffrey C. Jacobs 和 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=433030">bpo-433030</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="shutil">
<span id="whatsnew311-shutil"></span><h3>shutil<a class="headerlink" href="#shutil" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/shutil.html#shutil.rmtree" title="shutil.rmtree"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.rmtree()</span></code></a> 的可選參數 <em>dir_fd</em>。（由 Serhiy Storchaka 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46245">bpo-46245</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="socket">
<span id="whatsnew311-socket"></span><h3>socket<a class="headerlink" href="#socket" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 NetBSD 對於 CAN Socket 的支援。（由 Thomas Klausner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=30512">bpo-30512</a> 中所貢獻。）</p></li>
<li><p>當連接失敗時，<a class="reference internal" href="../library/socket.html#socket.create_connection" title="socket.create_connection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_connection()</span></code></a> 有個選項可以引發一個包含所有錯誤的 <a class="reference internal" href="../library/exceptions.html#ExceptionGroup" title="ExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a>，而非只引發最後一個錯誤。（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=29980">bpo-29980</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="sqlite3">
<span id="whatsnew311-sqlite3"></span><h3>sqlite3<a class="headerlink" href="#sqlite3" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>現在可以透過將 <a class="reference internal" href="../library/constants.html#None" title="None"><code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code></a> 傳遞給 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.set_authorizer" title="sqlite3.Connection.set_authorizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_authorizer()</span></code></a> 來停用 authorizer。（由  Erlend E. Aasland 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44491">bpo-44491</a> 中貢獻。）</p></li>
<li><p>定序 (collation) 名稱 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.create_collation" title="sqlite3.Connection.create_collation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_collation()</span></code></a> 現在可以包含任何 Unicode 字元。帶有無效字元的定序名稱現在會引發 <a class="reference internal" href="../library/exceptions.html#UnicodeEncodeError" title="UnicodeEncodeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnicodeEncodeError</span></code></a> 而不是 <a class="reference internal" href="../library/sqlite3.html#sqlite3.ProgrammingError" title="sqlite3.ProgrammingError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">sqlite3.ProgrammingError</span></code></a>。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44688">bpo-44688</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a> 例外現在包含 SQLite 擴充錯誤碼和 SQLite 錯誤名稱（分別為 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Error.sqlite_errorcode" title="sqlite3.Error.sqlite_errorcode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sqlite_errorcode</span></code></a> 和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Error.sqlite_errorname" title="sqlite3.Error.sqlite_errorname"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sqlite_errorname</span></code></a>）。（由 Aviv Palivoda、Daniel Shahaf 和 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=16379">bpo-16379</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=24139">bpo-24139</a> 中貢獻。）</p></li>
<li><p>將 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.setlimit" title="sqlite3.Connection.setlimit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setlimit()</span></code></a> 和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.getlimit" title="sqlite3.Connection.getlimit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getlimit()</span></code></a> 新增到 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Connection</span></code></a> 以根據連線來設定和取得 SQLite 限制。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45243">bpo-45243</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a> 現在會基於底層 SQLite 函式庫編譯時所使用的預設執行緒模式來設定 <a class="reference internal" href="../library/sqlite3.html#sqlite3.threadsafety" title="sqlite3.threadsafety"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sqlite3.threadsafety</span></code></a>。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45613">bpo-45613</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a> 如果啟用回呼回溯 (callback traceback)，C 回呼現在使用無法被引發的例外。使用者現在可以註冊一個<a class="reference internal" href="../library/sys.html#sys.unraisablehook" title="sys.unraisablehook"><code class="xref py py-func docutils literal notranslate"><span class="pre">無法被引發的掛鈎處理程式</span> <span class="pre">(unraisable</span> <span class="pre">hook</span> <span class="pre">handler)</span></code></a> 來改善他們的除錯體驗。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45828">bpo-45828</a> 中貢獻。）</p></li>
<li><p>跨越不同回滾 (rollback) 的拿取動作不再引發 <a class="reference internal" href="../library/sqlite3.html#sqlite3.InterfaceError" title="sqlite3.InterfaceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InterfaceError</span></code></a>，我們將其留給 SQLite 函式庫來處理這些情況。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44092">bpo-44092</a> 中貢獻。）</p></li>
<li><p>將 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.serialize" title="sqlite3.Connection.serialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">serialize()</span></code></a> 和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.deserialize" title="sqlite3.Connection.deserialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deserialize()</span></code></a> 新增到 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Connection</span></code></a> 以用於序列化和反序列化資料庫。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=41930">bpo-41930</a> 中貢獻。）</p></li>
<li><p>於 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Connection</span></code></a> 加入 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.create_window_function" title="sqlite3.Connection.create_window_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_window_function()</span></code></a> 已建立聚合視窗函式 (aggregate window function)。（由 Erlend E. Aasland 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=34916">bpo-34916</a> 中貢獻。）</p></li>
<li><p>在 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Connection</span></code></a> 新增 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.blobopen" title="sqlite3.Connection.blobopen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">blobopen()</span></code></a>。 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Blob" title="sqlite3.Blob"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlite3.Blob</span></code></a> 允許對 blob 進行增量 I/O 操作 (incremental I/O operations)。（由 Aviv Palivoda 和 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=24905">bpo-24905</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="string">
<span id="whatsnew311-string"></span><h3>string<a class="headerlink" href="#string" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/string.html#string.Template.get_identifiers" title="string.Template.get_identifiers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_identifiers()</span></code></a> 和 <a class="reference internal" href="../library/string.html#string.Template.is_valid" title="string.Template.is_valid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_valid()</span></code></a> 於 <a class="reference internal" href="../library/string.html#string.Template" title="string.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">string.Template</span></code></a>，分別能夠回傳所有合格的預留位置 (placeholder) 與是否有任何不合格的預留位置存在。（由 Ben Kehoe 於 <a class="reference external" href="https://github.com/python/cpython/issues/90465">gh-90465</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="sys">
<span id="whatsnew311-sys"></span><h3>sys<a class="headerlink" href="#sys" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/sys.html#sys.exc_info" title="sys.exc_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exc_info()</span></code></a> 現在從 <code class="docutils literal notranslate"><span class="pre">value</span></code>（例外實例）衍生出 <code class="docutils literal notranslate"><span class="pre">type</span></code> 和 <code class="docutils literal notranslate"><span class="pre">traceback</span></code> 欄位，因此當例外在處理過程中被修改時，變更會反映在 <code class="xref py py-func docutils literal notranslate"><span class="pre">exc_info()</span></code> 後續呼叫的結果中。（由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p>新增會回傳活躍例外實例 (active exception instance) 的 <a class="reference internal" href="../library/sys.html#sys.exception" title="sys.exception"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exception()</span></code></a>（等價於 <code class="docutils literal notranslate"><span class="pre">sys.exc_info()[1]</span></code>）。（由 Irit Katriel 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46328">bpo-46328</a> 中所貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/sys.html#sys.flags" title="sys.flags"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.flags.safe_path</span></code></a> 旗標。（由 Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/57684">gh-57684</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="sysconfig">
<span id="whatsnew311-sysconfig"></span><h3>sysconfig<a class="headerlink" href="#sysconfig" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增了三個<a class="reference internal" href="../library/sysconfig.html#installation-paths"><span class="std std-ref">安裝方案</span></a>（<em>posix_venv</em>、<em>nt_venv</em> 和 <em>venv</em>），它們在 Python 建立新的虛擬環境或在虛擬環境中執行環境使用。前兩個方案（<em>posix_venv</em> 和 <em>nt_venv</em>）是非 Windows 和 Windows 作業系統所特有的，<em>venv</em> 本質上會根據 Python 運行的操作系統來做為其中之一的別名。這對修改 <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_preferred_scheme" title="sysconfig.get_preferred_scheme"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.get_preferred_scheme()</span></code></a> 的下游發布者很有用。建立新虛擬環境的第三方程式碼應該使用新的 <em>venv</em> 安裝方案來確定路徑，就像 <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> 一樣。（由 Miro Hrončok 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45413">bpo-45413</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="tempfile">
<span id="whatsnew311-tempfile"></span><h3>tempfile<a class="headerlink" href="#tempfile" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/tempfile.html#tempfile.SpooledTemporaryFile" title="tempfile.SpooledTemporaryFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpooledTemporaryFile</span></code></a> 物件現在完整實作了 <a class="reference internal" href="../library/io.html#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BufferedIOBase</span></code></a> 或 <a class="reference internal" href="../library/io.html#io.TextIOBase" title="io.TextIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.TextIOBase</span></code></a> 的方法（取決於檔案模式），這使它們能夠正確地使用需要類檔案物件的 API，例如壓縮模組。（由 Carey Metcalfe 在 <a class="reference external" href="https://github.com/python/cpython/issues/70363">gh-70363</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="threading">
<span id="whatsnew311-threading"></span><h3>threading<a class="headerlink" href="#threading" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>在 Unix 上，如果 <code class="docutils literal notranslate"><span class="pre">sem_clockwait()</span></code> 函式在 C 函式庫（glibc 2.30 與其更新的版本）中可被使用，則 <a class="reference internal" href="../library/threading.html#threading.Lock.acquire" title="threading.Lock.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Lock.acquire()</span></code></a> 方法現在會使用單調時鐘 (<code class="xref py py-const docutils literal notranslate"><span class="pre">time.</span> <span class="pre">CLOCK_MONOTONIC</span></code>) 用於超時 (timeout)，而不是使用系統時鐘 (<a class="reference internal" href="../library/time.html#time.CLOCK_REALTIME" title="time.CLOCK_REALTIME"><code class="xref py py-const docutils literal notranslate"><span class="pre">time.CLOCK_REALTIME</span></code></a>)，以免受系統時鐘變化的影響。 由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=41710">bpo-41710</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="time">
<span id="whatsnew311-time"></span><h3>time<a class="headerlink" href="#time" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>在 Unix 上，如果可用的話，<a class="reference internal" href="../library/time.html#time.sleep" title="time.sleep"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.sleep()</span></code></a> 現在會使用 <code class="docutils literal notranslate"><span class="pre">clock_nanosleep()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">nanosleep()</span></code> 函式，其解析度為 1 納秒（10<sup>-9</sup> 秒），而不是使用解析度為 1 微秒（10<sup>-6</sup> 秒）的 <code class="docutils literal notranslate"><span class="pre">select()</span></code>。（由 Benjamin Szőke 和 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=21302">bpo-21302</a> 中貢獻。）</p></li>
<li><p>在 Windows 8.1 或更新的平台上，<a class="reference internal" href="../library/time.html#time.sleep" title="time.sleep"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.sleep()</span></code></a> 現在使用了一個基於<a class="reference external" href="https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/high-resolution-timers">高解析度計時器</a>的可等待 (waitable) 計時器，解析度為 100 奈秒（即 10<sup>-7</sup> 秒）。在這之前，它只有 1 微秒（10<sup>-3</sup> 秒） 的解析度。（由 Benjamin Szőke、Donghee Na、Eryk Sun 和 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=21302">bpo-21302</a> 與 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45429">bpo-45429</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="tkinter">
<span id="whatsnew311-tkinter"></span><h3>tkinter<a class="headerlink" href="#tkinter" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增了 <code class="docutils literal notranslate"><span class="pre">info_patchlevel()</span></code> 方法，它會回傳 Tcl 函式庫的確切版本以作為類似於 <a class="reference internal" href="../library/sys.html#sys.version_info" title="sys.version_info"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.version_info</span></code></a> 的附名元組。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/91827">gh-91827</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="traceback">
<span id="whatsnew311-traceback"></span><h3>traceback<a class="headerlink" href="#traceback" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/traceback.html#traceback.StackSummary.format_frame_summary" title="traceback.StackSummary.format_frame_summary"><code class="xref py py-func docutils literal notranslate"><span class="pre">traceback.StackSummary.format_frame_summary()</span></code></a> 以允許使用者覆蓋回溯中出現的幀及它們的格式。（由 Ammar Askar 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44569">bpo-44569</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.print" title="traceback.TracebackException.print"><code class="xref py py-func docutils literal notranslate"><span class="pre">traceback.TracebackException.print()</span></code></a>，它會印出格式化的 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException" title="traceback.TracebackException"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TracebackException</span></code></a> 實例至一個檔案。（由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=33809">bpo-33809</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="typing">
<span id="whatsnew311-typing"></span><h3>typing<a class="headerlink" href="#typing" title="連結到這個標頭">¶</a></h3>
<p>重大變更請見 <a class="reference internal" href="#new-feat-related-type-hints-311"><span class="std std-ref">型別提示相關的新特性</span></a>。</p>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/typing.html#typing.assert_never" title="typing.assert_never"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.assert_never()</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.Never" title="typing.Never"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Never</span></code></a>。 <a class="reference internal" href="../library/typing.html#typing.assert_never" title="typing.assert_never"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.assert_never()</span></code></a> 可用於要型別檢查器確認某行程式碼是否不可觸及。在執行環境，它會引發 <a class="reference internal" href="../library/exceptions.html#AssertionError" title="AssertionError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AssertionError</span></code></a>。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/90633">gh-90633</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/typing.html#typing.reveal_type" title="typing.reveal_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.reveal_type()</span></code></a>，這可用於請求型別檢查器為給定運算式推斷出什麼型別。在執行環境它會印出接收到的值的型別。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/90572">gh-90572</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/typing.html#typing.assert_type" title="typing.assert_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.assert_type()</span></code></a>，這可用於要型別檢查器確認它為給定運算式推斷的型別是否與給定型別相符。在執行環境，它只會回傳接收到的值。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/90638">gh-90638</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypedDict</span></code></a> 型別現可為泛型。（由 Samodya Abeysiriwardane 於 <a class="reference external" href="https://github.com/python/cpython/issues/89026">gh-89026</a> 中所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.NamedTuple" title="typing.NamedTuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a> 型別現可為泛型。（由 Serhiy Storchaka 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43923">bpo-43923</a> 中所貢獻。）</p></li>
<li><p>允許繼承 <a class="reference internal" href="../library/typing.html#typing.Any" title="typing.Any"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Any</span></code></a>，這能有效避免與高度動態類別（例如 mock）相關的型別檢查器錯誤。（由 Shantanu Jain 在 <a class="reference external" href="https://github.com/python/cpython/issues/91154">gh-91154</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.final" title="typing.final"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.final()</span></code></a> 裝飾器現在會在被裝飾的物件上設定 <code class="docutils literal notranslate"><span class="pre">__final__</span></code> 屬性。（由 Serhiy Storchaka 於 <a class="reference external" href="https://github.com/python/cpython/issues/90500">gh-90500</a> 中所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.get_overloads" title="typing.get_overloads"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_overloads()</span></code></a> 函式可用於自我檢查 (introspect) 一個函式的過載 (overload)。<a class="reference internal" href="../library/typing.html#typing.clear_overloads" title="typing.clear_overloads"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.clear_overloads()</span></code></a> 可用於清除一個函式的所有已註冊過載。（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/89263">gh-89263</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a> 子類別的 <a class="reference internal" href="../reference/datamodel.html#object.__init__" title="object.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> 方法現在被保留。（由 Adrian Garcia Badarasco 在 <a class="reference external" href="https://github.com/python/cpython/issues/88970">gh-88970</a> 中貢獻。）</p></li>
<li><p>空元組型別 (<code class="docutils literal notranslate"><span class="pre">Tuple[()]</span></code>) 的表示法得到簡化，這會影響自我檢查 (introspection)，例如 <code class="docutils literal notranslate"><span class="pre">get_args(Tuple[()])</span></code> 的求值現在會是 <code class="docutils literal notranslate"><span class="pre">()</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">((),)</span></code>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/91137">gh-91137</a> 中貢獻。）</p></li>
<li><p>通過刪除私有 <code class="docutils literal notranslate"><span class="pre">typing._type_check</span></code> 函式中的可呼叫檢查，放寬型別標註的執行環境要求。（由 Gregory Beauregard 在 <a class="reference external" href="https://github.com/python/cpython/issues/90802">gh-90802</a> 中貢獻。）</p></li>
<li><p>作為<a class="reference internal" href="../library/stdtypes.html#types-genericalias"><span class="std std-ref">PEP 585 泛化別名</span></a>中的前向參照，<a class="reference internal" href="../library/typing.html#typing.get_type_hints" title="typing.get_type_hints"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_type_hints()</span></code></a> 現支援了為字串求值 (evaluate)。（由 Niklas Rosenstein 在 <a class="reference external" href="https://github.com/python/cpython/issues/85542">gh-85542</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.get_type_hints" title="typing.get_type_hints"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_type_hints()</span></code></a> 不再將 <a class="reference internal" href="../library/typing.html#typing.Optional" title="typing.Optional"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a> 新增到預設為 <code class="docutils literal notranslate"><span class="pre">None</span></code> 的參數中。（由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/90353">gh-90353</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.get_type_hints" title="typing.get_type_hints"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.get_type_hints()</span></code></a> 現在支援為無修飾 (bare) 字串化 (stringified) 的 <a class="reference internal" href="../library/typing.html#typing.ClassVar" title="typing.ClassVar"><code class="xref py py-data docutils literal notranslate"><span class="pre">ClassVar</span></code></a> 標註來求值。（由 Gregory Beauregard 在 <a class="reference external" href="https://github.com/python/cpython/issues/90711">gh-90711</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.no_type_check" title="typing.no_type_check"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.no_type_check()</span></code></a> 不再修改外部類別和函式。它現在也正確地將類別方法標記為不需進行型別檢查。（由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/90729">gh-90729</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="unicodedata">
<span id="whatsnew311-unicodedata"></span><h3>unicodedata<a class="headerlink" href="#unicodedata" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Unicode 資料庫被更新為 14.0.0 版本。（Benjamin Peterson 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45190">bpo-45190</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="unittest">
<span id="whatsnew311-unittest"></span><h3>unittest<a class="headerlink" href="#unittest" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增 <a class="reference internal" href="../library/unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></a> 類別的 <a class="reference internal" href="../library/unittest.html#unittest.TestCase.enterContext" title="unittest.TestCase.enterContext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enterContext()</span></code></a> 與 <a class="reference internal" href="../library/unittest.html#unittest.TestCase.enterClassContext" title="unittest.TestCase.enterClassContext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enterClassContext()</span></code></a> 方法、 <a class="reference internal" href="../library/unittest.html#unittest.IsolatedAsyncioTestCase" title="unittest.IsolatedAsyncioTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">IsolatedAsyncioTestCase</span></code></a> 類別 的 <a class="reference internal" href="../library/unittest.html#unittest.IsolatedAsyncioTestCase.enterAsyncContext" title="unittest.IsolatedAsyncioTestCase.enterAsyncContext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enterAsyncContext()</span></code></a> 方法、<a class="reference internal" href="../library/unittest.html#unittest.enterModuleContext" title="unittest.enterModuleContext"><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.enterModuleContext()</span></code></a> 函式。（由 Serhiy Storchaka 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45046">bpo-45046</a> 貢獻。）</p></li>
</ul>
</section>
<section id="venv">
<span id="whatsnew311-venv"></span><h3>venv<a class="headerlink" href="#venv" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>建立新的 Python 虛擬環境時，<em>venv</em> <a class="reference internal" href="../library/sysconfig.html#installation-paths"><span class="std std-ref">sysconfig 安裝方案</span></a>會被用於確定環境內的路徑。當 Python 在虛擬環境中運行時，預設使用相同的安裝方案。這意味著下游發布者可以在不改變虛擬環境行為的情況下更改預設的 sysconfig 安裝方案。建立新虛擬環境的第三方程式碼也應該這樣做。（由 Miro Hrončok 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45413">bpo-45413</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="warnings">
<span id="whatsnew311-warnings"></span><h3>warnings<a class="headerlink" href="#warnings" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/warnings.html#warnings.catch_warnings" title="warnings.catch_warnings"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.catch_warnings()</span></code></a> 現在接受 <a class="reference internal" href="../library/warnings.html#warnings.simplefilter" title="warnings.simplefilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.simplefilter()</span></code></a> 的引數，提供了一種更簡潔的方法來在本地端忽略警告或將它們轉換為錯誤。（由 Zac Hatfield-Dodds 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47074">bpo-47074</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="zipfile">
<span id="whatsnew311-zipfile"></span><h3>zipfile<a class="headerlink" href="#zipfile" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>新增了對指定成員名稱編碼的支援，以便在 <a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile" title="zipfile.ZipFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZipFile</span></code></a> 的目錄和檔案標頭中讀取元資料 (metadata)。（由 Stephen J. Turnbull 和 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=28080">bpo-28080</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile.mkdir" title="zipfile.ZipFile.mkdir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ZipFile.mkdir()</span></code></a> 以在 ZIP 歸檔中建立新的目錄。（由 Sam Ezeh 於 <a class="reference external" href="https://github.com/python/cpython/issues/49083">gh-49083</a> 貢獻。）</p></li>
<li><p>於 <a class="reference internal" href="../library/zipfile.html#zipfile.Path" title="zipfile.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">zipfile.Path</span></code></a> 新增 <a class="reference internal" href="../library/zipfile.html#zipfile.Path.stem" title="zipfile.Path.stem"><code class="xref py py-attr docutils literal notranslate"><span class="pre">stem</span></code></a>、<a class="reference internal" href="../library/zipfile.html#zipfile.Path.suffix" title="zipfile.Path.suffix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">suffix</span></code></a> 和 <a class="reference internal" href="../library/zipfile.html#zipfile.Path.suffixes" title="zipfile.Path.suffixes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">suffixes</span></code></a>。（由 Miguel Brito 於 <a class="reference external" href="https://github.com/python/cpython/issues/88261">gh-88261</a> 貢獻。）</p></li>
</ul>
</section>
</section>
<section id="optimizations">
<span id="whatsnew311-optimizations"></span><h2>最佳化<a class="headerlink" href="#optimizations" title="連結到這個標頭">¶</a></h2>
<p>這個部分會涵蓋到特定的最佳化，但獨立於擁有自己一個說明的<a class="reference internal" href="#whatsnew311-faster-cpython"><span class="std std-ref">更快的 CPython</span></a> 計畫。</p>
<ul class="simple">
<li><p>編譯器現在對僅包含格式程式碼 <code class="docutils literal notranslate"><span class="pre">%s</span></code>、<code class="docutils literal notranslate"><span class="pre">%r</span></code> 和 <code class="docutils literal notranslate"><span class="pre">%a</span></code> 的字串文本 (string literal) 進行簡單的 <a class="reference internal" href="../library/stdtypes.html#old-string-formatting"><span class="std std-ref">printf 風格 % 格式化 (printf-style % formatting)</span></a> 最佳化並使其與相應的 <a class="reference internal" href="../glossary.html#term-f-string"><span class="xref std std-term">f-string</span></a> 運算式一樣快。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=28307">bpo-28307</a> 中貢獻。）</p></li>
<li><p>整數除法 (<code class="docutils literal notranslate"><span class="pre">//</span></code>) 為了編譯器最佳化而被調校過。現在將 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 除以小於 <code class="docutils literal notranslate"><span class="pre">2**30</span></code> 的值時，在 x86-64 上快了大約 20%。（由 Gregory P. Smith 和 Tim Peters 在 <a class="reference external" href="https://github.com/python/cpython/issues/90564">gh-90564</a> 中貢獻。）</p></li>
<li><p>針對小於 <code class="docutils literal notranslate"><span class="pre">2**30</span></code> 的整數，<a class="reference internal" href="../library/functions.html#sum" title="sum"><code class="xref py py-func docutils literal notranslate"><span class="pre">sum()</span></code></a> 現在快了將近 30%。（由 Stefan Behnel 於 <a class="reference external" href="https://github.com/python/cpython/issues/68264">gh-68264</a> 中所貢獻。）</p></li>
<li><p>調整 list 大小在常見情況下增進了效能，為 <code class="xref py py-meth docutils literal notranslate"><span class="pre">list.append()</span></code> 加快了約 15% 並為簡單的 <a class="reference internal" href="../glossary.html#term-list-comprehension"><span class="xref std std-term">list comprehension</span></a> 加快了高達 20-30%（由 Dennis Sweeney 在 <a class="reference external" href="https://github.com/python/cpython/issues/91165">gh-91165</a> 中貢獻。）</p></li>
<li><p>當所有鍵都是 Unicode 物件時，字典不存儲雜湊值，減少了 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 的大小。例如，<code class="docutils literal notranslate"><span class="pre">sys.getsizeof(dict.fromkeys(&quot;abcdefg&quot;))</span></code> 在 64-bit 平台上從 352 位元組減少到 272 位元組（減少 23%）。（由 Inada Naoki 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46845">bpo-46845</a> 中貢獻。）</p></li>
<li><p>使用 <a class="reference internal" href="../library/asyncio-protocol.html#asyncio.DatagramProtocol" title="asyncio.DatagramProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.DatagramProtocol</span></code></a> 以透過 UDP 傳輸大文件時，現在速度提高了幾個數量級，傳輸 ≈60 MiB 檔案的速度提高了 100 多倍。（由 msoxzw 在 <a class="reference external" href="https://github.com/python/cpython/issues/91487">gh-91487</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/math.html#module-math" title="math: Mathematical functions (sin() etc.)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">math</span></code></a> 函式 <a class="reference internal" href="../library/math.html#math.comb" title="math.comb"><code class="xref py py-func docutils literal notranslate"><span class="pre">comb()</span></code></a> 和 <a class="reference internal" href="../library/math.html#math.perm" title="math.perm"><code class="xref py py-func docutils literal notranslate"><span class="pre">perm()</span></code></a> 針對較大引數現在快了 ≈10 倍（對於更大的 <em>k</em> 有更大的加速）。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=37295">bpo-37295</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/statistics.html#module-statistics" title="statistics: Mathematical statistics functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">statistics</span></code></a> 函式 <a class="reference internal" href="../library/statistics.html#statistics.mean" title="statistics.mean"><code class="xref py py-func docutils literal notranslate"><span class="pre">mean()</span></code></a>、<a class="reference internal" href="../library/statistics.html#statistics.variance" title="statistics.variance"><code class="xref py py-func docutils literal notranslate"><span class="pre">variance()</span></code></a> 和 <a class="reference internal" href="../library/statistics.html#statistics.stdev" title="statistics.stdev"><code class="xref py py-func docutils literal notranslate"><span class="pre">stdev()</span></code></a> 現在會一次性的消耗疊代器，而不是先將它們轉換為 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>，這讓速度提升為兩倍並可以節省大量記憶體空間。（由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/90415">gh-90415</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/unicodedata.html#unicodedata.normalize" title="unicodedata.normalize"><code class="xref py py-func docutils literal notranslate"><span class="pre">unicodedata.normalize()</span></code></a> 現在在常數時間內規範化 (normalize) 純 ASCII 字串。（由 Donghee Na 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44987">bpo-44987</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="faster-cpython">
<span id="whatsnew311-faster-cpython"></span><h2>更快的 CPython<a class="headerlink" href="#faster-cpython" title="連結到這個標頭">¶</a></h2>
<p>當使用基準量測套裝軟體 <a class="reference external" href="https://github.com/python/pyperformance">pyperformance</a> 量測並以 GCC 於 Ubuntu Linux 上編譯，Python 3.11 平均比 Python 3.10 <a class="reference external" href="https://github.com/faster-cpython/ideas#published-results">快了 25%</a>。根據程式工作量可能有所不同，整體加速程度可達 10-60%。</p>
<p>此計畫專注在 Python 的 <a class="reference internal" href="#whatsnew311-faster-startup"><span class="std std-ref">更快的啟動</span></a> 和 <a class="reference internal" href="#whatsnew311-faster-runtime"><span class="std std-ref">更快的運行程式</span></a>。不在此專案內的最佳化被獨立列出在 <a class="reference internal" href="#whatsnew311-optimizations"><span class="std std-ref">最佳化</span></a>。</p>
<section id="faster-startup">
<span id="whatsnew311-faster-startup"></span><h3>更快的啟動<a class="headerlink" href="#faster-startup" title="連結到這個標頭">¶</a></h3>
<section id="frozen-imports-static-code-objects">
<span id="whatsnew311-faster-imports"></span><h4>凍結引入 (Frozen imports) / 靜態程式碼物件 (Static code objects)<a class="headerlink" href="#frozen-imports-static-code-objects" title="連結到這個標頭">¶</a></h4>
<p>Python 將<a class="reference internal" href="../glossary.html#term-bytecode"><span class="xref std std-term">位元組碼</span></a>於 <a class="reference internal" href="../tutorial/modules.html#tut-pycache"><span class="std std-ref">__pycache__</span></a> 目錄中存為快取來加速模組的載入。</p>
<p>在先前的 3.10 中，執行 Python 模組會像是這樣：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Read __pycache__ -&gt; Unmarshal -&gt; Heap allocated code object -&gt; Evaluate
</pre></div>
</div>
<p>在 Python 3.11 中，核心模組在 Python 啟動時必須被「凍結」，這意味著它們的<a class="reference internal" href="../c-api/code.html#codeobjects"><span class="std std-ref">程式碼物件</span></a>（和位元組碼）是由直譯器靜態分配的。這將模組執行過程中的步驟減少為：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Statically allocated code object -&gt; Evaluate
</pre></div>
</div>
<p>在 Python 3.11 中直譯器啟動速度快了 10-15%。這對於使用 Python 所撰寫的短暫程式有著巨大影響。</p>
<p>（由 Eric Snow、Guido van Rossum 與 Kumar Aditya 於多個 issue 中貢獻。）</p>
</section>
</section>
<section id="faster-runtime">
<span id="whatsnew311-faster-runtime"></span><h3>更快的運行程式<a class="headerlink" href="#faster-runtime" title="連結到這個標頭">¶</a></h3>
<section id="cheaper-lazy-python-frames">
<span id="whatsnew311-lazy-python-frames"></span><h4>所需資源更少 (cheaper) 且惰性的 (lazy)) Python 幀 (frame)<a class="headerlink" href="#cheaper-lazy-python-frames" title="連結到這個標頭">¶</a></h4>
<p>每當 Python 呼叫 Python 函式時，就會建立保存執行資訊的 Python 幀。以下是針對幀而做的新最佳化：</p>
<ul class="simple">
<li><p>使幀的建立過程更有效率。</p></li>
<li><p>在 C 堆疊 (stack) 中盡量重複利用幀的空間來避免記憶體分配。</p></li>
<li><p>讓內部幀結構只包含必要資訊，使其更加精簡。在過去，幀必須帶有額外的偵錯與記憶體管理的資訊。</p></li>
</ul>
<p>舊式<a class="reference internal" href="../reference/datamodel.html#frame-objects"><span class="std std-ref">幀物件</span></a>現在僅在除錯器或 Python 自我檢查函式（例如 <a class="reference internal" href="../library/sys.html#sys._getframe" title="sys._getframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys._getframe()</span></code></a> 或 <a class="reference internal" href="../library/inspect.html#inspect.currentframe" title="inspect.currentframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.currentframe()</span></code></a>）請求時才建立。對於大多數使用者程式碼，根本不會建立任何幀物件。結果幾乎所有 Python 函式呼叫都顯著加速。我們以 pyperformance 測得了 3-7% 的加速。</p>
<p>（由 Mark Shannon 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44590">bpo-44590</a> 中所貢獻。）</p>
</section>
<section id="inlined-python-function-calls">
<span id="whatsnew311-inline-calls"></span><span id="inline-calls"></span><h4>行內 Python 函式呼叫<a class="headerlink" href="#inlined-python-function-calls" title="連結到這個標頭">¶</a></h4>
<p>在 Python 函式呼叫期間，Python 將呼叫一個正在求值的 C 函式來直譯該函式的程式碼，這有效地將純 Python 遞迴限制在對 C 堆疊的安全範圍內。</p>
<p>在 3.11 中，當 CPython 檢測到 Python 程式碼呼叫另一個 Python 函式時，它會設立一個新框架 (frame)，並「跳轉」到新框架內的新程式碼，這避免了呼叫整個 C 直譯函式。</p>
<p>現在大多數 Python 函式的呼叫因為不會佔用 C 堆疊空間而被加速。在斐波那契 (fibonacci) 或階乘等簡單遞迴函式中，觀察到 1.7 倍的加速。這也意味著遞迴函式可以遞迴得更深（如果使用者有增加<a class="reference internal" href="../library/sys.html#sys.setrecursionlimit" title="sys.setrecursionlimit"><code class="xref py py-func docutils literal notranslate"><span class="pre">遞迴限制</span></code></a>）。我們在 pyperformance 測得 1-3% 的改進。</p>
<p>（由 Pablo Galindo 與 Mark Shannon 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45256">bpo-45256</a> 中所貢獻。）</p>
</section>
<section id="pep-659-specializing-adaptive-interpreter">
<span id="whatsnew311-pep659"></span><h4>PEP 659：特化的適應性直譯器<a class="headerlink" href="#pep-659-specializing-adaptive-interpreter" title="連結到這個標頭">¶</a></h4>
<p><span class="target" id="index-110"></span><a class="pep reference external" href="https://peps.python.org/pep-0659/"><strong>PEP 659</strong></a> 是加速 CPython 專案的關鍵部分之一。一般的想法是，雖然 Python 是一種動態語言，但大多數程式碼都有物件和型別很少去更改的區域。這個概念被稱為<em>型別穩定 (type stability)</em>。</p>
<p>在執行環境，Python 將嘗試在執行中的程式碼內尋找常用模式和型別穩定，然後 Python 將用更特化的操作替換當前操作。這種特化操作運用了僅適用於那些用例/型別的快速路徑，這通常優於它們的泛用對應 (generic counterparts)。這也引入了另一個稱為<em>行內快取 (inline caching)</em>的概念，其中 Python 將繁重操作的結果直接快取在<a class="reference internal" href="../glossary.html#term-bytecode"><span class="xref std std-term">位元組碼</span></a>中。</p>
<p>特化程式 (specializer) 還將某些常用指示 (common instruction) 組合成一個超級指示 (superinstruction)，這減少了執行期間的開銷。</p>
<p>Python 只會在看到「熱」（被多次執行的）程式碼時特化，這可以防止 Python 將時間浪費在只運行一次的程式碼上。當程式碼過於動態或用途發生變化時，Python 也可以去特化 (de-specialize)。特化會定期被嘗試執行，而嘗試的成本也不會太高，這讓特化得以適應新的環境。</p>
<p>（PEP 由 Mark Shannon 撰寫、概念啟發自 Stefan Brunthaler。詳情請見 <span class="target" id="index-111"></span><a class="pep reference external" href="https://peps.python.org/pep-0659/"><strong>PEP 659</strong></a>。由 Mark Shannon 和 Brandt Bucher 實作，Irit Katriel 和 Dennis Sweeney 亦提供了額外的幫助。）</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>操作</p></th>
<th class="head"><p>形式</p></th>
<th class="head"><p>特化</p></th>
<th class="head"><p>操作加速程度（上限）</p></th>
<th class="head"><p>貢獻者</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>二元操作</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">x</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">-</span> <span class="pre">x</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">x</span></code></p>
</td>
<td><p>常見型別如 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>、<a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 與 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 的二元加法、乘法與減法，為底層型別採取了特製的快速路徑。</p></td>
<td><p>10%</p></td>
<td><p>Mark Shannon,
Donghee Na,
Brandt Bucher,
Dennis Sweeney</p></td>
</tr>
<tr class="row-odd"><td><p>下標</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a[i]</span></code></p></td>
<td><p>下標容器型別如 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>、<a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 直接索引底層的資料結構。</p>
<p>下標自定義 <a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> 也是行內的，類似於 <a class="reference internal" href="#inline-calls"><span class="std std-ref">行內 Python 函式呼叫</span></a>。</p>
</td>
<td><p>10-25%</p></td>
<td><p>Irit Katriel,
Mark Shannon</p></td>
</tr>
<tr class="row-even"><td><p>儲存下標</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a[i]</span> <span class="pre">=</span> <span class="pre">z</span></code></p></td>
<td><p>類似於上面的下標特化。</p></td>
<td><p>10-25%</p></td>
<td><p>Dennis Sweeney</p></td>
</tr>
<tr class="row-odd"><td><p>呼叫</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f(arg)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">C(arg)</span></code></p>
</td>
<td><p>常見內建 (C) 函式和型別的呼叫，例如 <a class="reference internal" href="../library/functions.html#len" title="len"><code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>，會直接呼叫它們的 C 版本底層，這避免了通過內部呼叫的慣例。</p></td>
<td><p>20%</p></td>
<td><p>Mark Shannon,
Ken Jin</p></td>
</tr>
<tr class="row-even"><td><p>載入全域變數</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">print</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">len</span></code></p>
</td>
<td><p>全域/內建之命名空間內的物件索引被快取起來。載入全域與內建變數不需要任何命名空間的查找。</p></td>
<td><p><a class="footnote-reference brackets" href="#load-global" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>Mark Shannon</p></td>
</tr>
<tr class="row-odd"><td><p>載入屬性</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">o.attr</span></code></p></td>
<td><p>和載入全域變數類似，類別/物件之命名空間內的屬性索引被快取起來。在大部分情況中，載入屬性不需要任何命名空間的查找。</p></td>
<td><p><a class="footnote-reference brackets" href="#load-attr" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p></td>
<td><p>Mark Shannon</p></td>
</tr>
<tr class="row-even"><td><p>載入要呼叫的方法</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">o.meth()</span></code></p></td>
<td><p>方法的真實記憶體地址被快取 (cache) 起來，方法的載入現在不需要命名空間的查找 -- 即便有很長繼承鏈結的類別也是。</p></td>
<td><p>10-20%</p></td>
<td><p>Ken Jin,
Mark Shannon</p></td>
</tr>
<tr class="row-odd"><td><p>儲存屬性</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">o.attr</span> <span class="pre">=</span> <span class="pre">z</span></code></p></td>
<td><p>和載入屬性的最佳化相似。</p></td>
<td><p>2% 於 pyperformance 中</p></td>
<td><p>Mark Shannon</p></td>
</tr>
<tr class="row-even"><td><p>拆解 (unpack) 序列</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*seq</span></code></p></td>
<td><p>為像是 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> 和 <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> 的常見容器所特化，避免了內部呼叫慣例。</p></td>
<td><p>8%</p></td>
<td><p>Brandt Bucher</p></td>
</tr>
</tbody>
</table>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="load-global" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>類似的最佳化自從 Python 3.8 就存在。3.11 特別處理了更多形式並減少效能開銷 (overhead)。</p>
</aside>
<aside class="footnote brackets" id="load-attr" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>類似的最佳化自從 Python 3.10 就存在。3.11 特別處理了更多形式。此外，所有屬性載入也被 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45947">bpo-45947</a> 所加速。</p>
</aside>
</aside>
</section>
</section>
<section id="misc">
<span id="whatsnew311-faster-cpython-misc"></span><h3>雜項<a class="headerlink" href="#misc" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>物件現在因為使用了惰性建立的物件命名空間所以需要更少的記憶體。它們的命名空間字典現在也更自由地共享鍵。（由 Mark Shannon 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45340">bpo-45340</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40116">bpo-40116</a> 貢獻。 ）</p></li>
<li><p>實作了「無代價 (Zero-cost)」的例外，消除了在沒有例外被引發時的 <a class="reference internal" href="../reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">try</span></code></a> 陳述式開銷。（由 Mark Shannon 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40222">bpo-40222</a> 貢獻。）</p></li>
<li><p>在直譯器內使用更簡潔的例外表示法將捕獲一個例外所需的時間減少了大約 10%。 由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> 的正則表達式比對引擎部分被重構，且現在會有支援的平台上使用 computed gotos（或者「執行緒程式碼 (threaded code)」），因此 Python 3.11 在執行 <a class="reference external" href="https://pyperformance.readthedocs.io/benchmarks.html#regex-dna">pyperformance 正則表達式基準量測</a>的表現上比起 Python 3.10 快了 10%。（由 Brandt Bucher 於 <a class="reference external" href="https://github.com/python/cpython/issues/91404">gh-91404</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="faq">
<span id="whatsnew311-faster-cpython-faq"></span><h3>FAQ<a class="headerlink" href="#faq" title="連結到這個標頭">¶</a></h3>
<section id="how-should-i-write-my-code-to-utilize-these-speedups">
<span id="faster-cpython-faq-my-code"></span><h4>我該如何在程式碼中獲取這些加速？<a class="headerlink" href="#how-should-i-write-my-code-to-utilize-these-speedups" title="連結到這個標頭">¶</a></h4>
<p>撰寫符合 Python 風格 (Pythonic) 且依循常見最佳實踐的程式碼就好，你不需要改變你的程式碼。CPython 加速計畫中，我們為所觀察到的常見程式編寫模式來做最佳化。</p>
</section>
<section id="will-cpython-3-11-use-more-memory">
<span id="faster-cpython-faq-memory"></span><h4>Python 3.11 會不會使用更多記憶體？<a class="headerlink" href="#will-cpython-3-11-use-more-memory" title="連結到這個標頭">¶</a></h4>
<p>也許不會。我們預期不會有超出 3.10 20% 的記憶體使用量。這數字會和上述禎物件與物件字典的記憶體最佳化而有所偏差。</p>
</section>
<section id="i-don-t-see-any-speedups-in-my-workload-why">
<span id="faster-cpython-ymmv"></span><h4>我在我的程式當中沒感覺到任何加速，為什麼？<a class="headerlink" href="#i-don-t-see-any-speedups-in-my-workload-why" title="連結到這個標頭">¶</a></h4>
<p>某些程式中不會有顯著的好處。如果你的程式花了大部分的時間在 I/O 操作上，或已經將大部分計算用像是 numpy 的 C 擴充函式庫處理，那就不會有明顯的加速。這個計畫是對純 Python 的工作負荷最有幫助。</p>
<p>此外，pyperformance 數值為一個幾何平均數 (geometric mean)。即便在 pyperformance 基準量測中，某些測試稍微慢了一些，但其他加快了將近兩倍！</p>
</section>
<section id="is-there-a-jit-compiler">
<span id="faster-cpython-jit"></span><h4>有用到 JIT 編譯器嗎？<a class="headerlink" href="#is-there-a-jit-compiler" title="連結到這個標頭">¶</a></h4>
<p>沒有，我們還在探索其他最佳化方式。</p>
</section>
</section>
<section id="about">
<span id="whatsnew311-faster-cpython-about"></span><h3>關於<a class="headerlink" href="#about" title="連結到這個標頭">¶</a></h3>
<p>CPython 加速計畫探索了各種 <a class="reference internal" href="../glossary.html#term-CPython"><span class="xref std std-term">CPython</span></a> 最佳化的可能性。主要團隊由微軟 (microsoft) 所資助以全職發展該計畫，Pablo Galindo Salgado 亦由彭博有限合夥企業 (Bloomberg LP) 資助來兼職開發，更有許許多多來自社群的自發性貢獻者。</p>
</section>
</section>
<section id="cpython-bytecode-changes">
<span id="whatsnew311-bytecode-changes"></span><h2>CPython 位元組碼 (bytecode) 變更<a class="headerlink" href="#cpython-bytecode-changes" title="連結到這個標頭">¶</a></h2>
<p>位元組碼現在包含行內快取條目，它們採用新添加的 <a class="reference internal" href="../library/dis.html#opcode-CACHE"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CACHE</span></code></a> 指示的形式。許多操作碼預期後面要有確切數量的快取，並指示直譯器在執行環境跳過它們。傳遞的 (populated) 快取看起來像任意指示，因此在讀取或修改包含加速資料的原始且適應 (adaptive) 位元組碼時應格外小心。</p>
<section id="new-opcodes">
<span id="whatsnew311-added-opcodes"></span><h3>新增 opcode<a class="headerlink" href="#new-opcodes" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p><code class="xref std std-opcode docutils literal notranslate"><span class="pre">ASYNC_GEN_WRAP</span></code>、<a class="reference internal" href="../library/dis.html#opcode-RETURN_GENERATOR"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">RETURN_GENERATOR</span></code></a> 和 <a class="reference internal" href="../library/dis.html#opcode-SEND"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">SEND</span></code></a> 被用於產生器與協程。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-COPY_FREE_VARS"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">COPY_FREE_VARS</span></code></a>，避免了為閉包 (closure) 而生的特殊呼叫方 (caller-side) 程式碼的需求。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-JUMP_BACKWARD_NO_INTERRUPT"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_BACKWARD_NO_INTERRUPT</span></code></a>，用於某些不需要處理中斷的循環。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-MAKE_CELL"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">MAKE_CELL</span></code></a> 被用於建立 <a class="reference internal" href="../c-api/cell.html#cell-objects"><span class="std std-ref">Cell 物件</span></a>。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-CHECK_EG_MATCH"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CHECK_EG_MATCH</span></code></a> 和 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">PREP_RERAISE_STAR</span></code>，處理 <span class="target" id="index-112"></span><a class="pep reference external" href="https://peps.python.org/pep-0654/"><strong>PEP 654</strong></a> 所加入的<a class="reference internal" href="#whatsnew311-pep654"><span class="std std-ref">新增例外群組和 except*</span></a>。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-PUSH_EXC_INFO"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">PUSH_EXC_INFO</span></code></a> 被用於例外處理函式。</p></li>
<li><p><a class="reference internal" href="../library/dis.html#opcode-RESUME"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">RESUME</span></code></a>，為無操作 (no-po)，用於內部追查、除錯和最佳化檢查。</p></li>
</ul>
</section>
<section id="replaced-opcodes">
<span id="whatsnew311-replaced-opcodes"></span><h3>被取代的操作碼 (opcode)<a class="headerlink" href="#replaced-opcodes" title="連結到這個標頭">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>被取代的操作碼</p></th>
<th class="head"><p>新的操作碼</p></th>
<th class="head"><p>註記</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BINARY_*</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">INPLACE_*</span></code></div>
</div>
</td>
<td><p><a class="reference internal" href="../library/dis.html#opcode-BINARY_OP"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BINARY_OP</span></code></a></p></td>
<td><p>以單一一個操作碼來取代所有數值的、二進位/原位 (in-place) 操作碼</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_FUNCTION</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_FUNCTION_KW</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL_METHOD</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-CALL"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CALL</span></code></a></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">KW_NAMES</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">PRECALL</span></code></div>
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-PUSH_NULL"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">PUSH_NULL</span></code></a></div>
</div>
</td>
<td><p>將方法的引數搬移 (argument shifting) 與關鍵字引數的處理分離開來；允許更好的呼叫特化</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">DUP_TOP</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">DUP_TOP_TWO</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">ROT_TWO</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">ROT_THREE</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">ROT_FOUR</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">ROT_N</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-COPY"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">COPY</span></code></a></div>
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-SWAP"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">SWAP</span></code></a></div>
</div>
</td>
<td><p>堆疊操作指示</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_IF_NOT_EXC_MATCH</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-CHECK_EXC_MATCH"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">CHECK_EXC_MATCH</span></code></a></div>
</div>
</td>
<td><p>現在執行檢查但不跳位 (jump)</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_ABSOLUTE</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_JUMP_IF_FALSE</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_JUMP_IF_TRUE</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><a class="reference internal" href="../library/dis.html#opcode-JUMP_BACKWARD"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_BACKWARD</span></code></a></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_JUMP_BACKWARD_IF_*</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_JUMP_FORWARD_IF_*</span></code></div>
</div>
</td>
<td><p>參見 <a class="footnote-reference brackets" href="#bytecode-jump" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>；每個方向的 <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>、<code class="docutils literal notranslate"><span class="pre">FALSE</span></code>、<code class="docutils literal notranslate"><span class="pre">NONE</span></code> 和 <code class="docutils literal notranslate"><span class="pre">NOT_NONE</span></code> 變體</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">SETUP_WITH</span></code></div>
<div class="line"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">SETUP_ASYNC_WITH</span></code></div>
</div>
</td>
<td><p><a class="reference internal" href="../library/dis.html#opcode-BEFORE_WITH"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">BEFORE_WITH</span></code></a></p></td>
<td><p><a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 區塊設置</p></td>
</tr>
</tbody>
</table>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="bytecode-jump" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>所有跳位操作碼 (jump opcode) 現在都是相對的，包括現有的 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_IF_TRUE_OR_POP</span></code> 和 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">JUMP_IF_FALSE_OR_POP</span></code>。該引數現在是當前指示 (instruction) 的偏移量而不是絕對位置。</p>
</aside>
</aside>
</section>
<section id="changed-removed-opcodes">
<span id="whatsnew311-changed-removed-opcodes"></span><span id="whatsnew311-removed-opcodes"></span><span id="whatsnew311-changed-opcodes"></span><h3>有更動/被移除的 opcode<a class="headerlink" href="#changed-removed-opcodes" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>更改了 <a class="reference internal" href="../library/dis.html#opcode-MATCH_CLASS"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">MATCH_CLASS</span></code></a> 和 <a class="reference internal" href="../library/dis.html#opcode-MATCH_KEYS"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">MATCH_KEYS</span></code></a> ，不再推送一個額外的布林值來表示成功/失敗。取而代之的是會在失敗時推送 <code class="docutils literal notranslate"><span class="pre">None</span></code>，而非一個包含提取值的元組。</p></li>
<li><p>更改了運作於例外的操作碼以反映它們現在在堆疊中的表示為一項而不是三項（請參閱 <a class="reference external" href="https://github.com/python/cpython/issues/89874">gh-89874</a>）。</p></li>
<li><p>刪除 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">COPY_DICT_WITHOUT_KEYS</span></code>、<code class="xref std std-opcode docutils literal notranslate"><span class="pre">GEN_START</span></code>、<code class="xref std std-opcode docutils literal notranslate"><span class="pre">POP_BLOCK</span></code>、<code class="xref std std-opcode docutils literal notranslate"><span class="pre">SETUP_FINALLY</span></code> 和 <code class="xref std std-opcode docutils literal notranslate"><span class="pre">YIELD_FROM</span></code>。</p></li>
</ul>
</section>
</section>
<section id="deprecated">
<span id="whatsnew311-python-api-deprecated"></span><span id="whatsnew311-deprecated"></span><h2>已棄用<a class="headerlink" href="#deprecated" title="連結到這個標頭">¶</a></h2>
<p>這個部分列出了在 Python 3.11 中棄用的 Python API。</p>
<p>被棄用的 C API 被<a class="reference internal" href="#whatsnew311-c-api-deprecated"><span class="std std-ref">獨立列出</span></a>。</p>
<section id="language-builtins">
<span id="whatsnew311-deprecated-builtins"></span><span id="whatsnew311-deprecated-language"></span><h3>語言/內建<a class="headerlink" href="#language-builtins" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>鏈接 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a> 描述器（在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=19072">bpo-19072</a> 中引入）現已棄用。它不能再用於包裝其他描述器，例如 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-class docutils literal notranslate"><span class="pre">property</span></code></a>。此功能的核心設計存在缺陷，並導致了許多下游問題。要「傳遞通過 (pass-through)」<a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a>，請考慮使用 Python 3.10 中添加的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__wrapped__</span></code> 屬性。（由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/89519">gh-89519</a> 中貢獻。）</p></li>
<li><p>值大於 <code class="docutils literal notranslate"><span class="pre">0o377</span></code>（十進位為 255）的字串和位元組文本值 (bytes literal) 中的八進位跳脫 (octal escape) 現在會產生 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。在未來的 Python 版本中，他們將引發一個 <a class="reference internal" href="../library/exceptions.html#SyntaxWarning" title="SyntaxWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxWarning</span></code></a> 並最終引發一個 <a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/81548">gh-81548</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> 到 <a class="reference internal" href="../reference/datamodel.html#object.__trunc__" title="object.__trunc__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__trunc__()</span></code></a> 的授權 (delegation) 現已棄用。當 <code class="docutils literal notranslate"><span class="pre">type(a)</span></code> 有實作 <code class="xref py py-meth docutils literal notranslate"><span class="pre">__trunc__()</span></code> 但沒有 <a class="reference internal" href="../reference/datamodel.html#object.__int__" title="object.__int__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__int__()</span></code></a> 或 <a class="reference internal" href="../reference/datamodel.html#object.__index__" title="object.__index__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__index__()</span></code></a>，呼叫 <code class="docutils literal notranslate"><span class="pre">int(a)</span></code> 現在會引發一個 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。（由 Zackery Spytz 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44977">bpo-44977</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="modules">
<span id="whatsnew311-deprecated-modules"></span><h3>模組<a class="headerlink" href="#modules" title="連結到這個標頭">¶</a></h3>
<ul id="whatsnew311-pep594">
<li><p><span class="target" id="index-113"></span><a class="pep reference external" href="https://peps.python.org/pep-0594/"><strong>PEP 594</strong></a> 引領下列模組的棄用，並排訂於 Python 3.13 移除：</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../library/aifc.html#module-aifc" title="aifc: Read and write audio files in AIFF or AIFC format.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aifc</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/chunk.html#module-chunk" title="chunk: Module to read IFF chunks.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chunk</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/msilib.html#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已棄用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/pipes.html#module-pipes" title="pipes: A Python interface to Unix shell pipelines.（已棄用） (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pipes</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/telnetlib.html#module-telnetlib" title="telnetlib: Telnet client class.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">telnetlib</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">audioop</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/crypt.html#module-crypt" title="crypt: The crypt() function used to check Unix passwords.（已棄用） (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">crypt</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/nis.html#module-nis" title="nis: Interface to Sun's NIS (Yellow Pages) library.（已棄用） (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nis</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/sndhdr.html#module-sndhdr" title="sndhdr: Determine type of a sound file.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sndhdr</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/uu.html#module-uu" title="uu: Encode and decode files in uuencode format.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">uu</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../library/cgi.html#module-cgi" title="cgi: Helpers for running Python scripts via the Common Gateway Interface.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cgi</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/imghdr.html#module-imghdr" title="imghdr: Determine the type of image contained in a file or byte stream.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imghdr</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/nntplib.html#module-nntplib" title="nntplib: NNTP protocol client (requires sockets).（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nntplib</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/spwd.html#module-spwd" title="spwd: The shadow password database (getspnam() and friends).（已棄用） (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spwd</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/xdrlib.html#module-xdrlib" title="xdrlib: Encoders and decoders for the External Data Representation (XDR).（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xdrlib</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../library/cgitb.html#module-cgitb" title="cgitb: Configurable traceback handler for CGI scripts.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cgitb</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/mailcap.html#module-mailcap" title="mailcap: Mailcap file handling.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mailcap</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/ossaudiodev.html#module-ossaudiodev" title="ossaudiodev: Access to OSS-compatible audio devices.（已棄用） (Linux, FreeBSD)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ossaudiodev</span></code></a></p></td>
<td><p><a class="reference internal" href="../library/sunau.html#module-sunau" title="sunau: Provide an interface to the Sun AU sound format.（已棄用）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sunau</span></code></a></p></td>
<td></td>
</tr>
</tbody>
</table>
<p>（由 Brett Cannon 和 Victor Stinner 分別於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47061">bpo-47061</a> 與 <a class="reference external" href="https://github.com/python/cpython/issues/68966">gh-68966</a> 中所貢獻。）</p>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">asynchat</span></code>、<code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncore</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">smtpd</span></code> 至少在 Python 3.6 以前就被棄用，它們的文件與棄用警告現在已被更新為會提示它們即將於 Python 3.12 中移除。（由 Hugo van Kemenade 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47022">bpo-47022</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/2to3.html#module-lib2to3" title="lib2to3: The 2to3 library"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lib2to3</span></code></a> 套件和 <a class="reference internal" href="../library/2to3.html#to3-reference"><span class="std std-ref">2to3</span></a> 工具現已棄用，可能無法剖析 Python 3.10 或更新版本。有關詳細資訊請參閱 <span class="target" id="index-114"></span><a class="pep reference external" href="https://peps.python.org/pep-0617/"><strong>PEP 617</strong></a>，它引入了新的 PEG 剖析器。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40360">bpo-40360</a> 中貢獻。）</p></li>
<li><p>未被記錄於文件中的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_compile</span></code>、<code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_constants</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_parse</span></code> 模組現在已被棄用。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47152">bpo-47152</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="standard-library">
<span id="whatsnew311-deprecated-stdlib"></span><h3>標準函式庫<a class="headerlink" href="#standard-library" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>以下 <a class="reference internal" href="../library/configparser.html#module-configparser" title="configparser: Configuration file parser."><code class="xref py py-mod docutils literal notranslate"><span class="pre">configparser</span></code></a> 相關項目已在 Python 3.2 中棄用，它們的棄用警告現在會提示它們即將於 Python 3.12 中移除：</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.SafeConfigParser</span></code> 類別</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">configparser.ParsingError.filename</span></code> 屬性</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">configparser.RawConfigParser.readfp()</span></code> 方法</p></li>
</ul>
<p>（由 Hugo van Kemenade 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45173">bpo-45173</a> 中所貢獻。）</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.LegacyInterpolation</span></code> 自 Python 3.2 起已在文件字串中棄用，並且未在 <a class="reference internal" href="../library/configparser.html#module-configparser" title="configparser: Configuration file parser."><code class="xref py py-mod docutils literal notranslate"><span class="pre">configparser</span></code></a> 文檔中列出。它現在會發出一個 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> 並將在 Python 3.13 中刪除。請改用 <a class="reference internal" href="../library/configparser.html#configparser.BasicInterpolation" title="configparser.BasicInterpolation"><code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.BasicInterpolation</span></code></a> 或 <a class="reference internal" href="../library/configparser.html#configparser.ExtendedInterpolation" title="configparser.ExtendedInterpolation"><code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.ExtendedInterpolation</span></code></a>。（由 Hugo van Kemenade 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46607">bpo-46607</a> 中貢獻。）</p></li>
<li><p>舊的 <a class="reference internal" href="../library/importlib.resources.html#module-importlib.resources" title="importlib.resources: Package resource reading, opening, and access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.resources</span></code></a> 函式集因為不支援定位套件子目錄中的資源而被棄用、並將在未來的 Python 版本中刪除，取而代之的是在 Python 3.9 中添加的替代方案：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.contents" title="importlib.resources.contents"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.contents()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.is_resource" title="importlib.resources.is_resource"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.is_resource()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.open_binary" title="importlib.resources.open_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.open_binary()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.open_text" title="importlib.resources.open_text"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.open_text()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.read_binary" title="importlib.resources.read_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.read_binary()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.read_text" title="importlib.resources.read_text"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.read_text()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.path" title="importlib.resources.path"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.resources.path()</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/locale.html#locale.getdefaultlocale" title="locale.getdefaultlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getdefaultlocale()</span></code></a> 函式已被棄用且將於 Python 3.15 中移除。請改用 <a class="reference internal" href="../library/locale.html#locale.setlocale" title="locale.setlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.setlocale()</span></code></a>、<a class="reference internal" href="../library/locale.html#locale.getpreferredencoding" title="locale.getpreferredencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getpreferredencoding(False)</span></code></a> 和 <a class="reference internal" href="../library/locale.html#locale.getlocale" title="locale.getlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getlocale()</span></code></a>。（Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/90817">gh-90817</a> 中所貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/locale.html#locale.resetlocale" title="locale.resetlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.resetlocale()</span></code></a> 函式已棄用並將於 Python 3.13 中移除，請改用 <code class="docutils literal notranslate"><span class="pre">locale.setlocale(locale.LC_ALL,</span> <span class="pre">&quot;&quot;)</span></code>。（由 Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/90817">gh-90817</a> 中所貢獻。）</p></li>
<li><p>現在將對<a class="reference internal" href="../library/re.html#re-syntax"><span class="std std-ref">規則運算式</span></a>中的數值群組參照 (numerical group references) 和群組名稱套用更嚴格的規則。現在只接受 ASCII 數字序列作為數值參照，並且 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 模式 (pattern) 的群組名稱和替換字串中只能包含 ASCII 字母、數字和底線。目前，會針對違反這些規則的語法發出棄用警告。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/91760">gh-91760</a> 中貢獻。）</p></li>
<li><p>在 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> 模組中，<code class="xref py py-func docutils literal notranslate"><span class="pre">re.template()</span></code> 函式和相應的 <code class="xref py py-const docutils literal notranslate"><span class="pre">re.TEMPLATE</span></code> 和 <code class="xref py py-const docutils literal notranslate"><span class="pre">re.T</span></code> 旗標被棄用，因為它們沒被記錄於文件中並且缺乏明顯的目的。它們將在 Python 3.13 中被刪除。（由 Serhiy Storchaka 和 Miro Hrončok 在 <a class="reference external" href="https://github.com/python/cpython/issues/92728">gh-92728</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/turtle.html#turtle.settiltangle" title="turtle.settiltangle"><code class="xref py py-func docutils literal notranslate"><span class="pre">turtle.settiltangle()</span></code></a> 自 Python 3.1 以來已被棄用；它現在會發出棄用警告，並將在 Python 3.13 中刪除。請改用 <a class="reference internal" href="../library/turtle.html#turtle.tiltangle" title="turtle.tiltangle"><code class="xref py py-func docutils literal notranslate"><span class="pre">turtle.tiltangle()</span></code></a>（它之前被錯誤地標記為已棄用，其文件字串現在已更正）。（由 Hugo van Kemenade 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45837">bpo-45837</a> 中貢獻。）</p></li>
<li><p>僅用於支援 Python 2 和 Python 3 程式碼間相容性的 <a class="reference internal" href="../library/typing.html#typing.Text" title="typing.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Text</span></code></a> 現已棄用。目前未計劃刪除它，但鼓勵用戶盡可能使用 <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> 代替。（由 Alex Waygood 在 <a class="reference external" href="https://github.com/python/cpython/issues/92332">gh-92332</a> 中貢獻。）</p></li>
<li><p>用於建構 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypedDict</span></code></a> 型別的關鍵字引數語法現已棄用。將在 Python 3.13 中停止支援。（由 Jingchen Ye 在 <a class="reference external" href="https://github.com/python/cpython/issues/90224">gh-90224</a> 中貢獻。）</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">webbrowser.MacOSX</span></code> 已被棄用且將於 Python 3.13 中移除。它並沒有被測試過、沒紀錄於文件、也沒有被 <a class="reference internal" href="../library/webbrowser.html#module-webbrowser" title="webbrowser: Easy-to-use controller for web browsers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">webbrowser</span></code></a> 本身使用。（由 Donghee Na 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=42255">bpo-42255</a>。）</p></li>
<li><p>回傳從 <a class="reference internal" href="../library/unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></a> 和 <a class="reference internal" href="../library/unittest.html#unittest.IsolatedAsyncioTestCase" title="unittest.IsolatedAsyncioTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">IsolatedAsyncioTestCase</span></code></a> 測試方法（預設的 <code class="docutils literal notranslate"><span class="pre">None</span></code> 值除外）給定值的行為現已棄用。</p></li>
<li><p>棄用以下並沒有正式紀錄於文件中的 <a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> 函式，並預計於 Python 3.13 中移除：</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.findTestCases()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.makeSuite()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.getTestCaseNames()</span></code></p></li>
</ul>
<p>改用 <a class="reference internal" href="../library/unittest.html#unittest.TestLoader" title="unittest.TestLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestLoader</span></code></a> 方法：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.loadTestsFromModule" title="unittest.TestLoader.loadTestsFromModule"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestLoader.loadTestsFromModule()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.loadTestsFromTestCase" title="unittest.TestLoader.loadTestsFromTestCase"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestLoader.loadTestsFromTestCase()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.getTestCaseNames" title="unittest.TestLoader.getTestCaseNames"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestLoader.getTestCaseNames()</span></code></a></p></li>
</ul>
<p>（由 Erlend E. Aasland 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=5846">bpo-5846</a> 中所貢獻。）</p>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestProgram.usageExit()</span></code> 被標記為已棄用，即將在 3.13 中移除（由 Carlos Damázio 在 <a class="reference external" href="https://github.com/python/cpython/issues/67048">gh-67048</a> 中貢獻。）</p></li>
</ul>
</section>
</section>
<section id="pending-removal-in-python-3-12">
<span id="whatsnew311-python-api-pending-removal"></span><span id="whatsnew311-pending-removal"></span><h2>Python 3.12 中待決議的移除項目<a class="headerlink" href="#pending-removal-in-python-3-12" title="連結到這個標頭">¶</a></h2>
<p>下列 API 已在先前的 Python 發布版本中棄用，並將於 Python 3.12 中移除。</p>
<p>待定的 C API 移除項目為<a class="reference internal" href="#whatsnew311-c-api-pending-removal"><span class="std std-ref">獨立列出的</span></a>。</p>
<ul>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">asynchat</span></code> 模組</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncore</span></code> 模組</p></li>
<li><p><a class="reference internal" href="3.10.html#distutils-deprecated"><span class="std std-ref">整個 distutils 套件</span></a></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">imp</span></code> 模組</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.IO" title="typing.IO"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.io</span></code></a> 命名空間</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.Pattern" title="typing.Pattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.re</span></code></a> 命名空間</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">cgi.log()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.find_loader()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.Loader.module_repr()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.MetaPathFinder.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.PathEntryFinder.find_loader()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.abc.PathEntryFinder.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.BuiltinImporter.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.BuiltinLoader.module_repr()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.FileFinder.find_loader()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.FileFinder.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.FrozenImporter.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.FrozenLoader.module_repr()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.PathFinder.find_module()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">importlib.machinery.WindowsRegistryFinder.find_module()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.util.module_for_loader()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.util.set_loader_wrapper()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.util.set_package_wrapper()</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pkgutil.ImpImporter</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pkgutil.ImpLoader</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pathlib.Path.link_to()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">sqlite3.enable_shared_cache()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">sqlite3.OptimizedUnicode()</span></code></p></li>
<li><p><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONTHREADDEBUG</span></code> 環境變數</p></li>
<li><p><a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> 中被棄用的別名：</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>已棄用的別名</p></th>
<th class="head"><p>方法名稱</p></th>
<th class="head"><p>棄用於</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">failUnless</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertTrue" title="unittest.TestCase.assertTrue"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertTrue()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">failIf</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertFalse" title="unittest.TestCase.assertFalse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertFalse()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">failUnlessEqual</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertEqual" title="unittest.TestCase.assertEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertEqual()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">failIfEqual</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotEqual" title="unittest.TestCase.assertNotEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotEqual()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">failUnlessAlmostEqual</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertAlmostEqual" title="unittest.TestCase.assertAlmostEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertAlmostEqual()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">failIfAlmostEqual</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotAlmostEqual" title="unittest.TestCase.assertNotAlmostEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotAlmostEqual()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">failUnlessRaises</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertRaises" title="unittest.TestCase.assertRaises"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertRaises()</span></code></a></p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">assert_</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertTrue" title="unittest.TestCase.assertTrue"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertTrue()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">assertEquals</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertEqual" title="unittest.TestCase.assertEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertEqual()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">assertNotEquals</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotEqual" title="unittest.TestCase.assertNotEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotEqual()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">assertAlmostEquals</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertAlmostEqual" title="unittest.TestCase.assertAlmostEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertAlmostEqual()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">assertNotAlmostEquals</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotAlmostEqual" title="unittest.TestCase.assertNotAlmostEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotAlmostEqual()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">assertRegexpMatches</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertRegex" title="unittest.TestCase.assertRegex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertRegex()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">assertRaisesRegexp</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertRaisesRegex" title="unittest.TestCase.assertRaisesRegex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertRaisesRegex()</span></code></a></p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">assertNotRegexpMatches</span></code></p></td>
<td><p><a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertNotRegex" title="unittest.TestCase.assertNotRegex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertNotRegex()</span></code></a></p></td>
<td><p>3.5</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
</section>
<section id="removed">
<span id="whatsnew311-python-api-removed"></span><span id="whatsnew311-removed"></span><h2>已移除<a class="headerlink" href="#removed" title="連結到這個標頭">¶</a></h2>
<p>此部分列出 Python 3.11 中移除的 Python API。</p>
<p>被移除的 C API 被<a class="reference internal" href="#whatsnew311-c-api-removed"><span class="std std-ref">獨立列出</span></a>。</p>
<ul>
<li><p>刪除了 <code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;asyncio.coroutine()</span></code> <a class="reference internal" href="../glossary.html#term-decorator"><span class="xref std std-term">decorator</span></a> 使遺留的基於生成器的協程 (generator-based coroutine) 與 <a class="reference internal" href="../reference/compound_stmts.html#async"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span></code></a> / <a class="reference internal" href="../reference/expressions.html#await"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">await</span></code></a> 程式碼相容。該函式自 Python 3.8 起已被棄用，計劃於 Python 3.10 刪除。請改用 <a class="reference internal" href="../reference/compound_stmts.html#async-def"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code></a>。（由 Illia Volochii 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43216">bpo-43216</a> 中貢獻。）</p></li>
<li><p>移除除錯模式中用於包裝遺留基於產生器之協程物件的 <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.coroutines.CoroWrapper</span></code>。（由 Illia Volochii 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43216">bpo-43216</a> 中貢獻。）</p></li>
<li><p>因為有重大的安全性考量，Python 3.9 中停用的 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.create_datagram_endpoint" title="asyncio.loop.create_datagram_endpoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.create_datagram_endpoint()</span></code></a> 之 <em>reuse_address</em> 參數目前已經移除。這是因為 UDP socket 選項 <code class="docutils literal notranslate"><span class="pre">SO_REUSEADDR</span></code> 的行為所致。（由 Hugo van Kemenade 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45129">bpo-45129</a> 中貢獻。）</p></li>
<li><p>移除 Python 3.9 中棄用的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">binhex</span></code> 模組，與其相關且相似的 <a class="reference internal" href="../library/binascii.html#module-binascii" title="binascii: Tools for converting between binary and various ASCII-encoded binary representations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">binascii</span></code></a> 函式也一併被移除：</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">binascii.a2b_hqx()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">binascii.b2a_hqx()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">binascii.rlecode_hqx()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">binascii.rldecode_hqx()</span></code></p></li>
</ul>
<p><a class="reference internal" href="../library/binascii.html#binascii.crc_hqx" title="binascii.crc_hqx"><code class="xref py py-func docutils literal notranslate"><span class="pre">binascii.crc_hqx()</span></code></a> 維持可用。</p>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45085">bpo-45085</a> 中所貢獻。）</p>
</li>
<li><p>移除 Python 3.9 中棄用的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">distutils</span></code> <code class="docutils literal notranslate"><span class="pre">bdist_msi</span></code> 命令。請改用 <code class="docutils literal notranslate"><span class="pre">bdist_wheel</span></code>（wheel 套件）。（由 Hugo van Kemenade 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45124">bpo-45124</a> 中貢獻。）</p></li>
<li><p>將 <a class="reference internal" href="../library/xml.dom.pulldom.html#xml.dom.pulldom.DOMEventStream" title="xml.dom.pulldom.DOMEventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">xml.dom.pulldom.DOMEventStream</span></code></a>、<a class="reference internal" href="../library/wsgiref.html#wsgiref.util.FileWrapper" title="wsgiref.util.FileWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">wsgiref.util.FileWrapper</span></code></a> 和 <a class="reference internal" href="../library/fileinput.html#fileinput.FileInput" title="fileinput.FileInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">fileinput.FileInput</span></code></a> 自 Python 3.9 中棄用的 <a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> 方法移除。(由 Hugo van Kemenade 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45132">bpo-45132</a> 中貢獻。)</p></li>
<li><p>刪除了已棄用的 <a class="reference internal" href="../library/gettext.html#module-gettext" title="gettext: Multilingual internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code></a> 函式 <code class="xref py py-func docutils literal notranslate"><span class="pre">lgettext()</span></code>、<code class="xref py py-func docutils literal notranslate"><span class="pre">ldgettext()</span></code>、<code class="xref py py-func docutils literal notranslate"><span class="pre">lngettext()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">ldngettext()</span></code>，也刪除了 <code class="xref py py-func docutils literal notranslate"><span class="pre">bind_textdomain_codeset()</span></code> 函式、<code class="xref py py-meth docutils literal notranslate"><span class="pre">NullTranslations.output_charset()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">NullTranslations.set_output_charset()</span></code> 方法，以及 <code class="xref py py-func docutils literal notranslate"><span class="pre">translation()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">install()</span></code> 的 <em>codeset</em> 參數，因為它們僅被用於 <code class="xref py py-func docutils literal notranslate"><span class="pre">l*gettext()</span></code> 函式。（由 Donghee Na 和 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44235">bpo-44235</a> 中貢獻。）</p></li>
<li><p>於 <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">inspect</span></code></a> 模組中移除：</p>
<ul class="simple">
<li><p>Python 3.0 中棄用的 <code class="xref py py-func docutils literal notranslate"><span class="pre">getargspec()</span></code>；改用 <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.signature()</span></code></a> 或 <a class="reference internal" href="../library/inspect.html#inspect.getfullargspec" title="inspect.getfullargspec"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.getfullargspec()</span></code></a>。</p></li>
<li><p>Python 3.5 中棄用的 <code class="xref py py-func docutils literal notranslate"><span class="pre">formatargspec()</span></code> 函式；請直接用 <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.signature()</span></code></a> 函式或 <a class="reference internal" href="../library/inspect.html#inspect.Signature" title="inspect.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.Signature</span></code></a> 物件。</p></li>
<li><p>Python 3.5 中停用且沒有被紀錄於文件上的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Signature.from_builtin()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Signature.from_function()</span></code> 方法；改用 <a class="reference internal" href="../library/inspect.html#inspect.Signature.from_callable" title="inspect.Signature.from_callable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signature.from_callable()</span></code></a> 方法。</p></li>
</ul>
<p>（由 Hugo van Kemenade 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45320">bpo-45320</a> 中所貢獻。）</p>
</li>
<li><p>自 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath" title="pathlib.PurePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.PurePath</span></code></a> 中移除 <a class="reference internal" href="../reference/datamodel.html#object.__class_getitem__" title="object.__class_getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__class_getitem__()</span></code></a> 方法，因為它是前一版本中誤加且沒被使用。（由 Nikita Sobolev 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46483">bpo-46483</a> 中所貢獻。）</p></li>
<li><p>移除 <code class="xref py py-mod docutils literal notranslate"><span class="pre">smtpd</span></code> 模組中的 <code class="xref py py-class docutils literal notranslate"><span class="pre">MailmanProxy</span></code> 類別，因為它無法獨立於外部套件 <code class="xref py py-mod docutils literal notranslate"><span class="pre">mailman</span></code> 使用。（由 Donghee Na 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=35800">bpo-35800</a> 貢獻。）</p></li>
<li><p>移除 <code class="xref py py-class docutils literal notranslate"><span class="pre">_tkinter.TkappType</span></code> 已被棄用的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">split()</span></code> 方法。（由 Erlend E. Aasland 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=38371">bpo-38371</a> 貢獻。）</p></li>
<li><p>從 <a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> 中刪除了命名空間套件支援。它在 Python 3.4 中引入，但自 Python 3.7 以來已無法運作。（由 Inada Naoki 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=23882">bpo-23882</a> 中貢獻。）</p></li>
<li><p>將未被記錄於文件中的私有方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">float.__set_format__()</span></code> 移除，它過去是 Python 3.7 中的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">float.__setformat__()</span></code>。它的文件字串 (docstring) 說到：「你大概不會想要使用這個函式，它只為了讓 Python 測試系列套件 (suite) 使用而存在。」（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46852">bpo-46852</a> 中貢獻。）</p></li>
<li><p>移除 <code class="xref std std-option docutils literal notranslate"><span class="pre">--experimental-isolated-subinterpreters</span></code> 配置旗標（與對應的 <code class="xref c c-macro docutils literal notranslate"><span class="pre">EXPERIMENTAL_ISOLATED_SUBINTERPRETERS</span></code> 巨集）。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/Pynche/">Pynche</a> --- Python 風格的自然色彩與色調編輯器 --- 已被移出 <code class="docutils literal notranslate"><span class="pre">Tools/scripts</span></code>，<a class="reference external" href="https://gitlab.com/warsaw/pynche/-/tree/main">獨立開發</a>於 Python 原始碼之外。</p></li>
</ul>
</section>
<section id="porting-to-python-3-11">
<span id="whatsnew311-python-api-porting"></span><span id="whatsnew311-porting"></span><h2>移植至 Python 3.11<a class="headerlink" href="#porting-to-python-3-11" title="連結到這個標頭">¶</a></h2>
<p>本部分列出了之前描述的 Python API 中可能需要你去更改 Python 程式碼的變更和其他錯誤修復。</p>
<p>C API 的移植被<a class="reference internal" href="#whatsnew311-c-api-porting"><span class="std std-ref">獨立列出</span></a>。</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/functions.html#open" title="open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>、<a class="reference internal" href="../library/io.html#io.open" title="io.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">io.open()</span></code></a>、<a class="reference internal" href="../library/codecs.html#codecs.open" title="codecs.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">codecs.open()</span></code></a> 和 <a class="reference internal" href="../library/fileinput.html#fileinput.FileInput" title="fileinput.FileInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">fileinput.FileInput</span></code></a> 不再接受 <code class="docutils literal notranslate"><span class="pre">'U'</span></code>（&quot;universal newline&quot;，通用換行符）文件模式。在 Python 3 中，每當以文本模式 (text mode) 打開檔案時，預設情況下會使用「通用換行符」模式，並且自 Python 3.3 以來就不推薦使用 <code class="docutils literal notranslate"><span class="pre">'U'</span></code> 旗標。這些函式的 <a class="reference internal" href="../library/functions.html#open-newline-parameter"><span class="std std-ref">newline 參數</span></a>控制了通用換行符的作用方式。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=37330">bpo-37330</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/ast.html#ast.AST" title="ast.AST"><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.AST</span></code></a> 節點位置現在會在提供給 <a class="reference internal" href="../library/functions.html#compile" title="compile"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> 和其他相關函式時被驗證。如果檢測到無效位置，則會引發 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。（由 Pablo Galindo 在 <a class="reference external" href="https://github.com/python/cpython/issues/93351">gh-93351</a> 中貢獻）</p></li>
<li><p>在 Python 3.8 中棄用後，禁止將非 <a class="reference internal" href="../library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor" title="concurrent.futures.ThreadPoolExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor</span></code></a> 執行器傳遞給 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.set_default_executor" title="asyncio.loop.set_default_executor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.set_default_executor()</span></code></a>。（由 Illia Volochii 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43234">bpo-43234</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/calendar.html#module-calendar" title="calendar: Functions for working with calendars, including some emulation of the Unix cal program."><code class="xref py py-mod docutils literal notranslate"><span class="pre">calendar</span></code></a>：<a class="reference internal" href="../library/calendar.html#calendar.LocaleTextCalendar" title="calendar.LocaleTextCalendar"><code class="xref py py-class docutils literal notranslate"><span class="pre">calendar.LocaleTextCalendar</span></code></a> 和 <a class="reference internal" href="../library/calendar.html#calendar.LocaleHTMLCalendar" title="calendar.LocaleHTMLCalendar"><code class="xref py py-class docutils literal notranslate"><span class="pre">calendar.LocaleHTMLCalendar</span></code></a> 類別如果沒有指定語言環境，現在會使用 <a class="reference internal" href="../library/locale.html#locale.getlocale" title="locale.getlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getlocale()</span></code></a> 而非 <a class="reference internal" href="../library/locale.html#locale.getdefaultlocale" title="locale.getdefaultlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getdefaultlocale()</span></code></a>。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46659">bpo-46659</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a> 模組現在會讀取 <code class="docutils literal notranslate"><span class="pre">'UTF-8'</span></code> 編碼的 <code class="file docutils literal notranslate"><span class="pre">.pdbrc</span></code> 配置檔案。（Srinivas Reddy Thatiparthy (శ్రీనివాస్  రెడ్డి తాటిపర్తి) 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=41137">bpo-41137</a> 貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/random.html#random.sample" title="random.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">random.sample()</span></code></a> 的 <em>population</em> 參數必須是一個序列，不再支援 <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> 到 <a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> 的自動轉換。此外，如果抽樣大小大於總體大小，則會引發 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。（由 Raymond Hettinger 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40465">bpo-40465</a> 中貢獻。）</p></li>
<li><p>刪除了 <a class="reference internal" href="../library/random.html#random.shuffle" title="random.shuffle"><code class="xref py py-func docutils literal notranslate"><span class="pre">random.shuffle()</span></code></a> 的 <em>random</em> 可選參數。它以前是用於隨機排列 (shuffle) 的任意隨機函式；現在都會使用 <a class="reference internal" href="../library/random.html#random.random" title="random.random"><code class="xref py py-func docutils literal notranslate"><span class="pre">random.random()</span></code></a>（這是它以前的預設值）。</p></li>
<li><p>在 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> <a class="reference internal" href="../library/re.html#re-syntax"><span class="std std-ref">正規表示式語法</span></a> 中，全域行內旗標（例如 <code class="docutils literal notranslate"><span class="pre">(?i)</span></code>）現在只能在規則運算式的開頭使用。自 Python 3.6 以來，在其他地方使用它們已被棄用。（由 Serhiy Storchaka 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=47066">bpo-47066</a> 中貢獻。）</p></li>
<li><p>在 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> 模組中修復了幾個長期存在的錯誤，在極少數情況下，這些錯誤可能會導致捕獲群組 (capture group) 得到錯誤的結果。因此，這可能會在這些情況下更改捕獲的輸出。（Ma Lin 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=35859">bpo-35859</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="build-changes">
<span id="whatsnew311-build-changes"></span><h2>建置變更<a class="headerlink" href="#build-changes" title="連結到這個標頭">¶</a></h2>
<ul>
<li><p>CPython 現在有 <span class="target" id="index-115"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> <span class="target" id="index-116"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-3"><strong>Tier 3 支援</strong></a> 以用於交叉編譯至 <a class="reference external" href="https://webassembly.org/">WebAssembly</a> 平台 <a class="reference external" href="https://emscripten.org/">Emscripten</a>（<code class="docutils literal notranslate"><span class="pre">wasm32-unknown-emscripten</span></code>，即瀏覽器中的 Python）和 <a class="reference external" href="https://wasi.dev/">WebAssembly 系統介面 (WASI)</a> (<code class="docutils literal notranslate"><span class="pre">wasm32-unknown-wasi</span></code>)。這個靈感來自過往的貢獻，例如 <a class="reference external" href="https://pyodide.org/">Pyodide</a>。這些平台提供了有限的 POSIX API 子集；Python 標準函式庫功能和與網路、行程、執行緒、訊號、mmap、用戶/群組相關的模組不開放使用或無法正常使用。（Emscripten 由 Christian Heimes 和 Ethan Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/84461">gh-84461</a> 貢獻，WASI 由 Christian Heimes 在 <a class="reference external" href="https://github.com/python/cpython/issues/90473">gh-90473</a> 貢獻；平台在 <a class="reference external" href="https://github.com/python/cpython/issues/95085">gh-95085</a> 中推廣）</p></li>
<li><p>建置 CPython 現在必須要有：</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.cppreference.com/w/c/11">C11</a> 編譯器與標準函式庫。<a class="reference external" href="https://en.wikipedia.org/wiki/C11_(C_standard_revision)#Optional_features">可選的 C11 特性</a> 並非必要。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46656">bpo-46656</a>、<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45440">bpo-45440</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46640">bpo-46640</a> 中貢獻。）</p></li>
<li><p>Support for <a class="reference external" href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754</a>
floating-point numbers.
(Contributed by Victor Stinner in <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46917">bpo-46917</a>.)</p></li>
</ul>
</li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_NO_NAN</span></code> 巨集已被移除。因為 CPython 現在需要 IEEE 754 浮點數，NaN 數值皆為可得的。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46656">bpo-46656</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a> 套件現在必須要有 <a class="reference external" href="https://www.tcl.tk">Tcl/Tk</a> 8.5.12 或更新的版本。（由 Serhiy Storchaka 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46996">bpo-46996</a> 中所貢獻。）</p></li>
<li><p>大多數 stdlib 擴充模組的依賴套件、編譯器旗標 (compiler flag) 和鏈接器旗標 (linker flags) 現在可以透過 <strong class="program">configure</strong> 檢測出來。（當可用時）<a class="reference external" href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a> 會檢測出 libffi、libnsl、libsqlite3、zlib、bzip2、liblzma、libcrypt、Tcl/Tk 和 uuid 旗標。<a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a> 現在需要一個 pkg-config 命令來檢測 <a class="reference external" href="https://www.tcl.tk">Tcl/Tk</a> 標頭檔和函式庫的開發設定。（由 Christian Heimes 和 Erlend Egeberg Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45847">bpo-45847</a>、<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45747">bpo-45747</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45763">bpo-45763</a> 中貢獻。）</p></li>
<li><p>libpython 不再鏈接到 libcrypt。（由 Mike Gilbert 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45433">bpo-45433</a> 中貢獻。）</p></li>
<li><p>CPython 現在可以透過將 <code class="docutils literal notranslate"><span class="pre">thin</span></code> 傳遞給 <a class="reference internal" href="../using/configure.html#cmdoption-with-lto"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-lto</span></code></a>（也就是 <code class="docutils literal notranslate"><span class="pre">--with-lto=thin</span></code>）來以 <a class="reference external" href="https://clang.llvm.org/docs/ThinLTO.html">ThinLTO</a> 選項建置。（由 Donghee Na 與 Brett Holman 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44340">bpo-44340</a> 中所貢獻。）</p></li>
<li><p>Freelists for object structs can now be disabled. A new <strong class="program">configure</strong>
option <a class="reference internal" href="../using/configure.html#cmdoption-without-freelists"><code class="xref std std-option docutils literal notranslate"><span class="pre">--without-freelists</span></code></a> can be used to disable all freelists
except empty tuple singleton.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45522">bpo-45522</a>.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Modules/Setup</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Modules/makesetup</span></code> 已得到改進和綁定。現在可以通過 <code class="docutils literal notranslate"><span class="pre">makesetup</span></code> 建置擴充模組。除了一些測試模組外，所有模組都可以靜態鏈接到主要的二進制文件或函式庫中。（由 Brett Cannon 和 Christian Heimes 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45548">bpo-45548</a>、<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45570">bpo-45570</a>、<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45571">bpo-45571</a> 和 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43974">bpo-43974</a> 中貢獻。）</p>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>使用環境變數 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">TCLTK_CFLAGS</span></code> 和 <code class="xref std std-envvar docutils literal notranslate"><span class="pre">TCLTK_LIBS</span></code> 以手動指定 Tcl/Tk 標頭檔和函式庫的位置。<strong class="program">configure</strong> 選項 <code class="xref std std-option docutils literal notranslate"><span class="pre">—with-tcltk-includes</span></code> 和 <code class="xref std std-option docutils literal notranslate"><span class="pre">—with-tcltk-libs</span></code> 已被刪除。</p>
<p>RHEL 7 和 CentOS 7 上的開發套件並無提供 <code class="docutils literal notranslate"><span class="pre">tcl.pc</span></code> 和 <code class="docutils literal notranslate"><span class="pre">tk.pc</span></code>；要使用 <code class="docutils literal notranslate"><span class="pre">TCLTK_LIBS=&quot;-ltk8.5</span> <span class="pre">-ltkstub8.5</span> <span class="pre">-ltcl8.5&quot;</span></code>。目錄 <code class="docutils literal notranslate"><span class="pre">Misc/rhel7</span></code> 包含 <code class="docutils literal notranslate"><span class="pre">.pc</span></code> 檔案與如何使用 RHEL 7 和 CentOS 7 的 Tcl/Tk 與 OpenSSL 建置 Python 的指示。</p>
</div>
</li>
<li><p>CPython 現在預設使用 30-bit 數字來實作 Python <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>。以前，在 <code class="docutils literal notranslate"><span class="pre">SIZEOF_VOID_P</span> <span class="pre">&gt;=</span> <span class="pre">8</span></code> 的平台上預設使用 30-bit 數字，否則使用 15-bit 數字，但仍能通過配置腳本的 <a class="reference internal" href="../using/configure.html#cmdoption-enable-big-digits"><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-big-digits</span></code></a> 選項或（於 Windows）<code class="docutils literal notranslate"><span class="pre">PC/pyconfig.h</span></code> 中的 <code class="docutils literal notranslate"><span class="pre">PYLONG_BITS_IN_DIGIT</span></code> 變數來明確請求使用 15-bit 數字，但此選項可能會在將來的某個時候被刪除。（由 Mark Dickinson 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45569">bpo-45569</a> 中貢獻。）</p></li>
</ul>
</section>
<section id="c-api-changes">
<span id="whatsnew311-c-api"></span><h2>C API 變更<a class="headerlink" href="#c-api-changes" title="連結到這個標頭">¶</a></h2>
<section id="whatsnew311-c-api-new-features">
<span id="id5"></span><h3>新增特性<a class="headerlink" href="#whatsnew311-c-api-new-features" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>新增 <a class="reference internal" href="../c-api/type.html#c.PyType_GetName" title="PyType_GetName"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetName()</span></code></a> 函式來取得型別的短名。（由 Hai Shi 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=42035">bpo-42035</a> 中所貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../c-api/type.html#c.PyType_GetQualName" title="PyType_GetQualName"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetQualName()</span></code></a> 函式來取得型別的合格名稱 (qualified name)。（由 Hai Shi 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=42035">bpo-42035</a> 中所貢獻。）</p></li>
<li><p>在受限 C API (limited C API) 中新增 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_EnterTracing" title="PyThreadState_EnterTracing"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_EnterTracing()</span></code></a> 和 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_LeaveTracing" title="PyThreadState_LeaveTracing"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_LeaveTracing()</span></code></a> 函式來中止和繼續追蹤 (tracing) 和性能分析 (profiling)。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43760">bpo-43760</a> 中貢獻。）</p></li>
<li><p>添加了 <a class="reference internal" href="../c-api/apiabiversion.html#c.Py_Version" title="Py_Version"><code class="xref c c-data docutils literal notranslate"><span class="pre">Py_Version</span></code></a> 常數，其值與 <a class="reference internal" href="../c-api/apiabiversion.html#c.PY_VERSION_HEX" title="PY_VERSION_HEX"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PY_VERSION_HEX</span></code></a> 相同。（由 Gabriele N. Tornetta 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43931">bpo-43931</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.Py_buffer" title="Py_buffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_buffer</span></code></a> 與 API 目前是受限 API 與穩定 ABI 中的一部分：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyObject_CheckBuffer" title="PyObject_CheckBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CheckBuffer()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyObject_GetBuffer" title="PyObject_GetBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetBuffer()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_GetPointer" title="PyBuffer_GetPointer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_GetPointer()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_SizeFromFormat" title="PyBuffer_SizeFromFormat"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_SizeFromFormat()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_ToContiguous" title="PyBuffer_ToContiguous"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_ToContiguous()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_FromContiguous" title="PyBuffer_FromContiguous"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_FromContiguous()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyObject_CopyData" title="PyObject_CopyData"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CopyData()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_IsContiguous" title="PyBuffer_IsContiguous"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_IsContiguous()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_FillContiguousStrides" title="PyBuffer_FillContiguousStrides"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_FillContiguousStrides()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_FillInfo" title="PyBuffer_FillInfo"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_FillInfo()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_Release" title="PyBuffer_Release"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_Release()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/memoryview.html#c.PyMemoryView_FromBuffer" title="PyMemoryView_FromBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMemoryView_FromBuffer()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/typeobj.html#c.PyBufferProcs.bf_getbuffer" title="PyBufferProcs.bf_getbuffer"><code class="xref c c-member docutils literal notranslate"><span class="pre">bf_getbuffer</span></code></a> 與 <a class="reference internal" href="../c-api/typeobj.html#c.PyBufferProcs.bf_releasebuffer" title="PyBufferProcs.bf_releasebuffer"><code class="xref c c-member docutils literal notranslate"><span class="pre">bf_releasebuffer</span></code></a> 型別插槽 (type slot)</p></li>
</ul>
<p>（由 Christian Heimes 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45459">bpo-45459</a> 中所貢獻。）</p>
</li>
<li><p>新增 <a class="reference internal" href="../c-api/type.html#c.PyType_GetModuleByDef" title="PyType_GetModuleByDef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetModuleByDef()</span></code></a> 函式，它將被用於取得定義一個方法的模組，以免這項資訊無法直接被取得（透過 <a class="reference internal" href="../c-api/structures.html#c.PyCMethod" title="PyCMethod"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyCMethod</span></code></a>）。（由 Petr Viktorin 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46613">bpo-46613</a> 中所貢獻。）</p></li>
<li><p>新增函式以打包 (pack) 和取出 (unpack) C double（序列化和反序列化）：<a class="reference internal" href="../c-api/float.html#c.PyFloat_Pack2" title="PyFloat_Pack2"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Pack2()</span></code></a>、<a class="reference internal" href="../c-api/float.html#c.PyFloat_Pack4" title="PyFloat_Pack4"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Pack4()</span></code></a>、<a class="reference internal" href="../c-api/float.html#c.PyFloat_Pack8" title="PyFloat_Pack8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Pack8()</span></code></a>、<a class="reference internal" href="../c-api/float.html#c.PyFloat_Unpack2" title="PyFloat_Unpack2"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Unpack2()</span></code></a> , <a class="reference internal" href="../c-api/float.html#c.PyFloat_Unpack4" title="PyFloat_Unpack4"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Unpack4()</span></code></a> 和 <a class="reference internal" href="../c-api/float.html#c.PyFloat_Unpack8" title="PyFloat_Unpack8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFloat_Unpack8()</span></code></a>。（由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46906">bpo-46906</a> 中貢獻。）</p></li>
<li><p>新增取得幀物件屬性的函式：<a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBuiltins" title="PyFrame_GetBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBuiltins()</span></code></a>、<a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGenerator" title="PyFrame_GetGenerator"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGenerator()</span></code></a>、<a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGlobals" title="PyFrame_GetGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGlobals()</span></code></a>、<a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLasti" title="PyFrame_GetLasti"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLasti()</span></code></a>。</p></li>
<li><p>添加了兩個新函式來獲得和設置仍在作用的例外實例：<a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetHandledException" title="PyErr_GetHandledException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetHandledException()</span></code></a> 和 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetHandledException" title="PyErr_SetHandledException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_SetHandledException()</span></code></a>。這些是 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetExcInfo" title="PyErr_SetExcInfo"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_SetExcInfo()</span></code></a> 和 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetExcInfo" title="PyErr_GetExcInfo"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetExcInfo()</span></code></a> 的替代品，它們與例外的遺留三元組表示法一起作用。（由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46343">bpo-46343</a> 中貢獻。）</p></li>
<li><p>新增 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.safe_path" title="PyConfig.safe_path"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.safe_path</span></code></a> 成員。（由 Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/57684">gh-57684</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="whatsnew311-c-api-porting">
<span id="id6"></span><h3>移植至 Python 3.11<a class="headerlink" href="#whatsnew311-c-api-porting" title="連結到這個標頭">¶</a></h3>
<ul id="whatsnew311-pep670">
<li><p>一些巨集已轉換為行內靜態函式以避免<a class="reference external" href="https://gcc.gnu.org/onlinedocs/cpp/Macro-Pitfalls.html">巨集陷阱 (macro pitfalls)</a>。這種變化對用戶來說應該是透明的，因為替換函式會將它們的引數轉換為預期的型別，以避免由於靜態型別檢查而產生的編譯器警告。但是，當受限 C API 設置為 &gt;=3.11 時，這些轉換不會完成，使用者需要將引數轉換為他們期望的型別。有關更多詳細資訊，請參閱 <span class="target" id="index-117"></span><a class="pep reference external" href="https://peps.python.org/pep-0670/"><strong>PEP 670</strong></a>。（由 Victor Stinner 和 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/89653">gh-89653</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetExcInfo" title="PyErr_SetExcInfo"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_SetExcInfo()</span></code></a> 不再使用 <code class="docutils literal notranslate"><span class="pre">type</span></code> 和 <code class="docutils literal notranslate"><span class="pre">traceback</span></code> 引數，直譯器現在從例外實例（<code class="docutils literal notranslate"><span class="pre">value</span></code> 引數）中獲得這些值。該函式仍會偷用這三個引數的參照。（由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetExcInfo" title="PyErr_GetExcInfo"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetExcInfo()</span></code></a> 現在從例外實例的結果（<code class="docutils literal notranslate"><span class="pre">value</span></code> 欄位）中導出 <code class="docutils literal notranslate"><span class="pre">type</span></code> 和 <code class="docutils literal notranslate"><span class="pre">traceback</span></code> 欄位。（由 Irit Katriel 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45711">bpo-45711</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../c-api/import.html#c._frozen" title="_frozen"><code class="xref c c-struct docutils literal notranslate"><span class="pre">_frozen</span></code></a> 有一個新的 <code class="docutils literal notranslate"><span class="pre">is_package</span></code> 欄位來表示凍結模組是否為一個套件。以前 <code class="docutils literal notranslate"><span class="pre">size</span></code> 欄位中的負值是指標，現在只有非負值可用於 <code class="docutils literal notranslate"><span class="pre">size</span></code>。（由 Kumar Aditya 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46608">bpo-46608</a> 中貢獻。）</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c._PyFrameEvalFunction" title="_PyFrameEvalFunction"><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyFrameEvalFunction()</span></code></a> 現在將 <code class="docutils literal notranslate"><span class="pre">_PyInterpreterFrame*</span></code> 作為其第二個參數，而不是 <code class="docutils literal notranslate"><span class="pre">PyFrameObject*</span></code>。有關如何使用此函式指標型別的更多詳細資訊，請參閱 <span class="target" id="index-118"></span><a class="pep reference external" href="https://peps.python.org/pep-0523/"><strong>PEP 523</strong></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_New()</span></code> 和 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_NewWithPosOnlyArgs()</span></code> 現在採用額外的 <code class="docutils literal notranslate"><span class="pre">exception_table</span></code> 引數。如果可能的話應該避免使用這些函式。要獲取自定義程式碼物件，使用編譯器建立一個程式碼物件，然後使用 <code class="docutils literal notranslate"><span class="pre">replace</span></code> 方法來得到修改後的版本。</p></li>
<li><p><a class="reference internal" href="../c-api/code.html#c.PyCodeObject" title="PyCodeObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyCodeObject</span></code></a> 不再會有 <code class="docutils literal notranslate"><span class="pre">co_code</span></code>、<code class="docutils literal notranslate"><span class="pre">co_varnames</span></code>、<code class="docutils literal notranslate"><span class="pre">co_cellvars</span></code> 和 <code class="docutils literal notranslate"><span class="pre">co_freevars</span></code> 欄位。分別被改為透過 C API 的 <a class="reference internal" href="../c-api/code.html#c.PyCode_GetCode" title="PyCode_GetCode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_GetCode()</span></code></a>、<a class="reference internal" href="../c-api/code.html#c.PyCode_GetVarnames" title="PyCode_GetVarnames"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_GetVarnames()</span></code></a>、<a class="reference internal" href="../c-api/code.html#c.PyCode_GetCellvars" title="PyCode_GetCellvars"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_GetCellvars()</span></code></a> 和 <a class="reference internal" href="../c-api/code.html#c.PyCode_GetFreevars" title="PyCode_GetFreevars"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_GetFreevars()</span></code></a> 來存取。（由 Brandt Bucher 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46841">bpo-46841</a>、Ken Jin 在 <a class="reference external" href="https://github.com/python/cpython/issues/92154">gh-92154</a> 與 <a class="reference external" href="https://github.com/python/cpython/issues/94936">gh-94936</a> 中貢獻。）</p></li>
<li><p>舊的回收筒巨集 (trashcan macro) (<code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_BEGIN</span></code>/<code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_END</span></code>) 現在已經被棄用，它們應被新的巨集 <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_BEGIN</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_END</span></code> 所取代。</p>
<p>一個用到老舊巨集的 tp_dealloc 函式，像是：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">void</span>
<span class="n">mytype_dealloc</span><span class="p">(</span><span class="n">mytype</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PyObject_GC_UnTrack</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">Py_TRASHCAN_SAFE_BEGIN</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="o">...</span>
    <span class="n">Py_TRASHCAN_SAFE_END</span>
<span class="p">}</span>
</pre></div>
</div>
<p>應該要搬遷到新的巨集，如下所示：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">void</span>
<span class="n">mytype_dealloc</span><span class="p">(</span><span class="n">mytype</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PyObject_GC_UnTrack</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">Py_TRASHCAN_BEGIN</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">mytype_dealloc</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="n">Py_TRASHCAN_END</span>
<span class="p">}</span>
</pre></div>
</div>
<p>請注意 <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_BEGIN</span></code> 有第二個引數，它應該是它所在的釋放函式 (deallocation function)。</p>
<p>為支援舊版 Python 在同一份程式碼中，你可以定義以下巨集並在程式碼中使用它們（要歸功於 <code class="docutils literal notranslate"><span class="pre">mypy</span></code> 程式碼，這些是從那邊複製過來的）：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &gt;= 0x03080000</span>
<span class="c1">#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_BEGIN(op, dealloc)</span>
<span class="c1">#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_END</span>
<span class="c1">#else</span>
<span class="c1">#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_SAFE_BEGIN(op)</span>
<span class="c1">#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_SAFE_END(op)</span>
<span class="c1">#endif</span>
</pre></div>
</div>
</li>
<li><p>如果一個型別是以 <a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_HAVE_GC" title="Py_TPFLAGS_HAVE_GC"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_TPFLAGS_HAVE_GC</span></code></a> 旗標來定義，但卻沒有遍歷函式 (traverse function) (<a class="reference internal" href="../c-api/typeobj.html#c.PyTypeObject.tp_traverse" title="PyTypeObject.tp_traverse"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyTypeObject.tp_traverse</span></code></a>)，那 <a class="reference internal" href="../c-api/type.html#c.PyType_Ready" title="PyType_Ready"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_Ready()</span></code></a> 函式現在會引發一個錯誤。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44263">bpo-44263</a> 中貢獻。）</p></li>
<li><p>帶有 <a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_IMMUTABLETYPE" title="Py_TPFLAGS_IMMUTABLETYPE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_TPFLAGS_IMMUTABLETYPE</span></code></a> 旗標的堆積型別現在可以繼承 <span class="target" id="index-119"></span><a class="pep reference external" href="https://peps.python.org/pep-0590/"><strong>PEP 590</strong></a> 向量呼叫協定 (vectorcall protocol)。以前這僅適用於 <a class="reference internal" href="../c-api/typeobj.html#static-types"><span class="std std-ref">static types</span></a>。（由 Erlend E. Aasland 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43908">bpo-43908</a> 中貢獻）。</p></li>
<li><p>由於 <a class="reference internal" href="../c-api/structures.html#c.Py_TYPE" title="Py_TYPE"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_TYPE()</span></code></a> 更改為行內靜態函式 (inline static function)，因此 <code class="docutils literal notranslate"><span class="pre">Py_TYPE(obj)</span> <span class="pre">=</span> <span class="pre">new_type</span></code> 必須替換為 <code class="docutils literal notranslate"><span class="pre">Py_SET_TYPE(obj,</span> <span class="pre">new_type)</span></code>：參見 <a class="reference internal" href="../c-api/structures.html#c.Py_SET_TYPE" title="Py_SET_TYPE"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SET_TYPE()</span></code></a> 函式（自 Python 3.9 起可用）。為了向後相容，可以使用這個巨集：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030900A4 &amp;&amp; !defined(Py_SET_TYPE)</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">void</span> <span class="n">_Py_SET_TYPE</span><span class="p">(</span><span class="n">PyObject</span> <span class="o">*</span><span class="n">ob</span><span class="p">,</span> <span class="n">PyTypeObject</span> <span class="o">*</span><span class="nb">type</span><span class="p">)</span>
<span class="p">{</span> <span class="n">ob</span><span class="o">-&gt;</span><span class="n">ob_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">;</span> <span class="p">}</span>
<span class="c1">#define Py_SET_TYPE(ob, type) _Py_SET_TYPE((PyObject*)(ob), type)</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=39573">bpo-39573</a> 中所貢獻。）</p>
</li>
<li><p>由於 <a class="reference internal" href="../c-api/structures.html#c.Py_SIZE" title="Py_SIZE"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SIZE()</span></code></a> 更改為行內靜態函式，因此 <code class="docutils literal notranslate"><span class="pre">Py_SIZE(obj)</span> <span class="pre">=</span> <span class="pre">new_size</span></code> 必須替換為 <code class="docutils literal notranslate"><span class="pre">Py_SET_SIZE(obj,</span> <span class="pre">new_size)</span></code>：參見 <a class="reference internal" href="../c-api/structures.html#c.Py_SET_SIZE" title="Py_SET_SIZE"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SET_SIZE()</span></code></a> 函式（自 Python 3.9 起可用）。為了向後相容，可以使用這個巨集：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030900A4 &amp;&amp; !defined(Py_SET_SIZE)</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">void</span> <span class="n">_Py_SET_SIZE</span><span class="p">(</span><span class="n">PyVarObject</span> <span class="o">*</span><span class="n">ob</span><span class="p">,</span> <span class="n">Py_ssize_t</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span> <span class="n">ob</span><span class="o">-&gt;</span><span class="n">ob_size</span> <span class="o">=</span> <span class="n">size</span><span class="p">;</span> <span class="p">}</span>
<span class="c1">#define Py_SET_SIZE(ob, size) _Py_SET_SIZE((PyVarObject*)(ob), size)</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=39573">bpo-39573</a> 中所貢獻。）</p>
</li>
<li><p>當 <code class="docutils literal notranslate"><span class="pre">Py_LIMITED_API</span></code> 巨集被設定為 <code class="docutils literal notranslate"><span class="pre">0x030b0000</span></code>（Python 3.11）或以上，<code class="docutils literal notranslate"><span class="pre">&lt;Python.h&gt;</span></code> 不再會包含標頭檔 <code class="docutils literal notranslate"><span class="pre">&lt;stdlib.h&gt;</span></code>、<code class="docutils literal notranslate"><span class="pre">&lt;stdio.h&gt;</span></code>、<code class="docutils literal notranslate"><span class="pre">&lt;errno.h&gt;</span></code> 和 <code class="docutils literal notranslate"><span class="pre">&lt;string.h&gt;</span></code>。C 擴充程式應該要清楚的在 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;Python.h&gt;</span></code> 之後引入標頭檔案。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45434">bpo-45434</a> 中貢獻。）</p></li>
<li><p>非受限 API (non-limited API) 檔案 <code class="docutils literal notranslate"><span class="pre">cellobject.h</span></code>、<code class="docutils literal notranslate"><span class="pre">classobject.h</span></code>、<code class="docutils literal notranslate"><span class="pre">code.h</span></code>、<code class="docutils literal notranslate"><span class="pre">context.h</span></code>、<code class="docutils literal notranslate"><span class="pre">funcobject.h</span></code>、<code class="docutils literal notranslate"><span class="pre">genobject.</span> <span class="pre">h</span></code> 和 <code class="docutils literal notranslate"><span class="pre">longintrepr.h</span></code> 已移至 <code class="docutils literal notranslate"><span class="pre">Include/cpython</span></code> 目錄。此外，<code class="docutils literal notranslate"><span class="pre">eval.h</span></code> 標頭檔已被刪除。不能直接引入這些文件，因為它們已被包含在 <code class="docutils literal notranslate"><span class="pre">Python.h</span></code> 中：<a class="reference internal" href="../c-api/intro.html#api-includes"><span class="std std-ref">引入檔案</span></a>。如果它們已被直接引入，請考慮改為引入 <code class="docutils literal notranslate"><span class="pre">Python.h</span></code>。 （由 Victor Stinner 在 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=35134">bpo-35134</a> 中貢獻。）</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_CHECK_INTERNED()</span></code> 巨集已從受限 C API 中移出，它從來沒辦法被使用，因為它使用了受限 C API 不提供的內部結構。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46007">bpo-46007</a> 中所貢獻。）</p></li>
<li><p>以下用於幀 (frame) 的函式與型別現在可直接透過 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;Python.h&gt;</span></code> 來使用，不必再加上 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;frameobject.h&gt;</span></code>：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_Check" title="PyFrame_Check"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_Check()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBack" title="PyFrame_GetBack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBack()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBuiltins" title="PyFrame_GetBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBuiltins()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGenerator" title="PyFrame_GetGenerator"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGenerator()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGlobals" title="PyFrame_GetGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGlobals()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLasti" title="PyFrame_GetLasti"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLasti()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrame_Type" title="PyFrame_Type"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyFrame_Type</span></code></a></p></li>
</ul>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/93937">gh-93937</a> 中所貢獻。）</p>
</li>
</ul>
<ul id="pyframeobject-3-11-hiding">
<li><p><a class="reference internal" href="../c-api/frame.html#c.PyFrameObject" title="PyFrameObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyFrameObject</span></code></a> 結構成員已經從公開的 C API 中移除。</p>
<p>雖然文件指出 <a class="reference internal" href="../c-api/frame.html#c.PyFrameObject" title="PyFrameObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyFrameObject</span></code></a> 欄位隨時可能發生變化，但它們已經穩定了很長時間，並被用於幾個流行的擴充套件中。</p>
<p>Python 3.11 中，幀的結構被重新編制來為性能做最佳化，有些作為舊版實作細節的欄位被整個移除。</p>
<p><a class="reference internal" href="../c-api/frame.html#c.PyFrameObject" title="PyFrameObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyFrameObject</span></code></a> 欄位：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f_back</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBack" title="PyFrame_GetBack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBack()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_blockstack</span></code>：已移除。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_builtins</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBuiltins" title="PyFrame_GetBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBuiltins()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_code</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetCode" title="PyFrame_GetCode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetCode()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_gen</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGenerator" title="PyFrame_GetGenerator"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGenerator()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_globals</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetGlobals" title="PyFrame_GetGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetGlobals()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_iblock</span></code>：已移除。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_lasti</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLasti" title="PyFrame_GetLasti"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLasti()</span></code></a>。程式碼中 <code class="docutils literal notranslate"><span class="pre">f_lasti</span></code> 有與 <code class="docutils literal notranslate"><span class="pre">PyCode_Addr2Line()</span></code> 同時使用的部分應該改用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLineNumber" title="PyFrame_GetLineNumber"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLineNumber()</span></code></a>；它可能會更快。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_lineno</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLineNumber" title="PyFrame_GetLineNumber"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLineNumber()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_locals</span></code>：使用 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_stackdepth</span></code>：已移除。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_state</span></code>：無公開 API（重新命名為 <code class="docutils literal notranslate"><span class="pre">f_frame.f_state</span></code>）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_trace</span></code>：無公開 API。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_trace_lines</span></code>：使用 <code class="docutils literal notranslate"><span class="pre">PyObject_GetAttrString((PyObject*)frame,</span> <span class="pre">&quot;f_trace_lines&quot;)</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_trace_opcodes</span></code>：使用 <code class="docutils literal notranslate"><span class="pre">PyObject_GetAttrString((PyObject*)frame,</span> <span class="pre">&quot;f_trace_opcodes&quot;)</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_localsplus</span></code>：無公開 API（重新命名為 <code class="docutils literal notranslate"><span class="pre">f_frame.localsplus</span></code>）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_valuestack</span></code>：已移除。</p></li>
</ul>
<p>Python 幀物件的建立現為惰性的 (lazily)，一個副作用是 <a class="reference internal" href="../reference/datamodel.html#frame.f_back" title="frame.f_back"><code class="xref py py-attr docutils literal notranslate"><span class="pre">f_back</span></code></a> 成員不能被直接存取，因為其職的計算也是惰性的，要改呼叫 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetBack" title="PyFrame_GetBack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetBack()</span></code></a>。</p>
<p>直接存取 <a class="reference internal" href="../reference/datamodel.html#frame.f_locals" title="frame.f_locals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">f_locals</span></code></a> 的除錯器<em>必須</em>改為呼叫 <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a>。他們不再需要呼叫 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_FastToLocalsWithError()</span></code> 或 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_LocalsToFast()</span></code>，事實上他們不應該呼叫這些函式。框架的必要更新現在由虛擬機管理。</p>
<p><code class="docutils literal notranslate"><span class="pre">PyFrame_GetCode()</span></code> 在 Python 3.8 以前的程式定義：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030900B1</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">PyCodeObject</span><span class="o">*</span> <span class="n">PyFrame_GetCode</span><span class="p">(</span><span class="n">PyFrameObject</span> <span class="o">*</span><span class="n">frame</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Py_INCREF</span><span class="p">(</span><span class="n">frame</span><span class="o">-&gt;</span><span class="n">f_code</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">f_code</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PyFrame_GetBack()</span></code> 在 Python 3.8 以前的程式定義：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030900B1</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">PyFrameObject</span><span class="o">*</span> <span class="n">PyFrame_GetBack</span><span class="p">(</span><span class="n">PyFrameObject</span> <span class="o">*</span><span class="n">frame</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Py_XINCREF</span><span class="p">(</span><span class="n">frame</span><span class="o">-&gt;</span><span class="n">f_back</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">f_back</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>或是使用 <a class="reference external" href="https://github.com/python/pythoncapi-compat">pythoncap_compat 計畫</a>來在舊版 Python 函式中取得這兩個函式。</p>
</li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThreadState" title="PyThreadState"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyThreadState</span></code></a> 結構成員的改動：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">frame</span></code>：已移除，改用 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_GetFrame" title="PyThreadState_GetFrame"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_GetFrame()</span></code></a>（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40429">bpo-40429</a> 於 Python 3.9 新增的函式）。警告：會回傳 <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> 的函式必須呼叫 <a class="reference internal" href="../c-api/refcounting.html#c.Py_XDECREF" title="Py_XDECREF"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_XDECREF()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tracing</span></code>：已變更，改用 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_EnterTracing" title="PyThreadState_EnterTracing"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_EnterTracing()</span></code></a> 和 <a class="reference internal" href="../c-api/init.html#c.PyThreadState_LeaveTracing" title="PyThreadState_LeaveTracing"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_LeaveTracing()</span></code></a>（<a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=43760">bpo-43760</a> 於 Python 3.11 中新增的函式）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recursion_depth</span></code>：已移除，請改用 <code class="docutils literal notranslate"><span class="pre">(tstate-&gt;recursion_limit</span> <span class="pre">-</span> <span class="pre">tstate-&gt;recursion_remaining)</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stackcheck_counter</span></code>：已移除。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">PyThreadState_GetFrame()</span></code> 在 Python 3.8 以前的程式定義：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030900B1</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">PyFrameObject</span><span class="o">*</span> <span class="n">PyThreadState_GetFrame</span><span class="p">(</span><span class="n">PyThreadState</span> <span class="o">*</span><span class="n">tstate</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Py_XINCREF</span><span class="p">(</span><span class="n">tstate</span><span class="o">-&gt;</span><span class="n">frame</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">frame</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PyThreadState_EnterTracing()</span></code> 與 <code class="docutils literal notranslate"><span class="pre">PyThreadState_LeaveTracing()</span></code> 在 Python 3.10 以前的程式定義：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PY_VERSION_HEX &lt; 0x030B00A2</span>
<span class="n">static</span> <span class="n">inline</span> <span class="n">void</span> <span class="n">PyThreadState_EnterTracing</span><span class="p">(</span><span class="n">PyThreadState</span> <span class="o">*</span><span class="n">tstate</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">tracing</span><span class="o">++</span><span class="p">;</span>
<span class="c1">#if PY_VERSION_HEX &gt;= 0x030A00A1</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">cframe</span><span class="o">-&gt;</span><span class="n">use_tracing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">#else</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">use_tracing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">#endif</span>
<span class="p">}</span>

<span class="n">static</span> <span class="n">inline</span> <span class="n">void</span> <span class="n">PyThreadState_LeaveTracing</span><span class="p">(</span><span class="n">PyThreadState</span> <span class="o">*</span><span class="n">tstate</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">use_tracing</span> <span class="o">=</span> <span class="p">(</span><span class="n">tstate</span><span class="o">-&gt;</span><span class="n">c_tracefunc</span> <span class="o">!=</span> <span class="n">NULL</span> <span class="o">||</span> <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">c_profilefunc</span> <span class="o">!=</span> <span class="n">NULL</span><span class="p">);</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">tracing</span><span class="o">--</span><span class="p">;</span>
<span class="c1">#if PY_VERSION_HEX &gt;= 0x030A00A1</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">cframe</span><span class="o">-&gt;</span><span class="n">use_tracing</span> <span class="o">=</span> <span class="n">use_tracing</span><span class="p">;</span>
<span class="c1">#else</span>
    <span class="n">tstate</span><span class="o">-&gt;</span><span class="n">use_tracing</span> <span class="o">=</span> <span class="n">use_tracing</span><span class="p">;</span>
<span class="c1">#endif</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>或是使用 <a class="reference external" href="https://github.com/python/pythoncapi-compat">pythoncap-compat 計畫</a>來在舊版 Python 函式中取得它們。</p>
</li>
<li><p>鼓勵發布者們使用最佳化過的 Blake2 函式庫 <a class="reference external" href="https://www.blake2.net/">libb2</a> 來建置 Python。</p></li>
<li><p>初始化中若是要用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a> 來初始化 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>，則現在 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths_set" title="PyConfig.module_search_paths_set"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths_set</span></code></a> 必須被設為 1。否則，初始化會重新計算路徑並取代所有被加到 <code class="docutils literal notranslate"><span class="pre">module_search_paths</span></code> 的值。</p></li>
<li><p><a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Read" title="PyConfig_Read"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Read()</span></code></a> 不再計算初始搜索路徑，並且不會將任何值填充到 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a> 中。若要計算預設路徑然後修改它們，完成初始化並使用 <a class="reference internal" href="../c-api/sys.html#c.PySys_GetObject" title="PySys_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_GetObject()</span></code></a> 以取得 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> 作為 Python 列表物件並直接修改它。</p></li>
</ul>
</section>
<section id="whatsnew311-c-api-deprecated">
<span id="id7"></span><h3>已棄用<a class="headerlink" href="#whatsnew311-c-api-deprecated" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p>棄用以下用來配置 Python 初始化的函式：</p>
<ul class="simple">
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddWarnOptionUnicode()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddWarnOption()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddXOption()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_HasWarnOptions()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgvEx()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgv()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetPath()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPath()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetProgramName()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPythonHome()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetStandardStreamEncoding()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">_Py_SetProgramFullPath()</span></code></p></li>
</ul>
<p>請改用 <a class="reference internal" href="../c-api/init_config.html#init-config"><span class="std std-ref">Python 初始化配置</span></a>中新的 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> API。（由 Victor Stinner 於 <a class="reference external" href="https://github.com/python/cpython/issues/88279">gh-88279</a> 中所貢獻。）</p>
</li>
<li><p>棄用 <a class="reference internal" href="../c-api/bytes.html#c.PyBytesObject" title="PyBytesObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyBytesObject</span></code></a> 中的 <code class="docutils literal notranslate"><span class="pre">ob_shash</span></code> 成員。請改用 <a class="reference internal" href="../c-api/object.html#c.PyObject_Hash" title="PyObject_Hash"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Hash()</span></code></a>。（由 Inada Naoki 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=46864">bpo-46864</a> 中所貢獻。）</p></li>
</ul>
</section>
<section id="whatsnew311-c-api-pending-removal">
<span id="id8"></span><h3>Python 3.12 中待決議的移除項目<a class="headerlink" href="#whatsnew311-c-api-pending-removal" title="連結到這個標頭">¶</a></h3>
<p>以下 C API 已於先前 Python 發布版本中棄用，並將於 Python 3.12 中移除。</p>
<ul class="simple">
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AS_DATA()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AS_UNICODE()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicodeAndSize()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsUnicode()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromUnicode()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GET_DATA_SIZE()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GET_SIZE()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_GetSize()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_IS_COMPACT()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_IS_READY()</span></code></p></li>
<li><p><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READY" title="PyUnicode_READY"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_READY()</span></code></a></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_WSTR_LENGTH()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyUnicode_AsUnicode()</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">PyUnicode_WCHAR_KIND</span></code></p></li>
<li><p><a class="reference internal" href="../c-api/unicode.html#c.PyUnicodeObject" title="PyUnicodeObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyUnicodeObject</span></code></a></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_InternImmortal()</span></code></p></li>
</ul>
</section>
<section id="whatsnew311-c-api-removed">
<span id="id9"></span><h3>已移除<a class="headerlink" href="#whatsnew311-c-api-removed" title="連結到這個標頭">¶</a></h3>
<ul>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_BlockSetup()</span></code> and <code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_BlockPop()</span></code> have been
removed.
(Contributed by Mark Shannon in <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40222">bpo-40222</a>.)</p></li>
<li><p>移除以下使用到 <code class="docutils literal notranslate"><span class="pre">errno</span></code> 變數的數學巨集：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Py_ADJUST_ERANGE1()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py_ADJUST_ERANGE2()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py_OVERFLOWED()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py_SET_ERANGE_IF_OVERFLOW()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py_SET_ERRNO_ON_MATH_ERROR()</span></code></p></li>
</ul>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45412">bpo-45412</a> 中所貢獻。）</p>
</li>
<li><p>移除在 Python 3.3 中棄用的 <code class="docutils literal notranslate"><span class="pre">Py_UNICODE_COPY()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Py_UNICODE_FILL()</span></code>。請改用 <code class="docutils literal notranslate"><span class="pre">PyUnicode_CopyCharacters()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">memcpy()</span></code>（<code class="docutils literal notranslate"><span class="pre">wchar_t*</span></code> 字串）和 <code class="docutils literal notranslate"><span class="pre">PyUnicode_Fill()</span></code> 函式。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=41123">bpo-41123</a> 中所貢獻。）</p></li>
<li><p>移除 <code class="docutils literal notranslate"><span class="pre">pystrhex.h</span></code> 標頭檔案。它只有包含私有函式。C 的擴充應該只要引入主要的 <code class="docutils literal notranslate"><span class="pre">&lt;Python.h&gt;</span></code> 標頭檔案。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45434">bpo-45434</a> 中所貢獻。）</p></li>
<li><p>移除 <code class="docutils literal notranslate"><span class="pre">Py_FORCE_DOUBLE()</span></code> 巨集。它先前被用於 <code class="docutils literal notranslate"><span class="pre">Py_IS_INFINITY()</span></code> 巨集。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45440">bpo-45440</a> 中所貢獻。）</p></li>
<li><p>當 <a class="reference internal" href="../c-api/stable.html#c.Py_LIMITED_API" title="Py_LIMITED_API"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_LIMITED_API</span></code></a> 有被定義時，以下項目將無法被取得：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/marshal.html#c.PyMarshal_WriteLongToFile" title="PyMarshal_WriteLongToFile"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMarshal_WriteLongToFile()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/marshal.html#c.PyMarshal_WriteObjectToFile" title="PyMarshal_WriteObjectToFile"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMarshal_WriteObjectToFile()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/marshal.html#c.PyMarshal_ReadObjectFromString" title="PyMarshal_ReadObjectFromString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMarshal_ReadObjectFromString()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/marshal.html#c.PyMarshal_WriteObjectToString" title="PyMarshal_WriteObjectToString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMarshal_WriteObjectToString()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Py_MARSHAL_VERSION</span></code> 巨集</p></li>
</ul>
<p>These are not part of the <a class="reference internal" href="../c-api/stable.html#limited-api-list"><span class="std std-ref">limited API</span></a>.</p>
<p>（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45474">bpo-45474</a> 中所貢獻。）</p>
</li>
<li><p>將 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GET_OBJECT" title="PyWeakref_GET_OBJECT"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GET_OBJECT()</span></code></a> 排除於受限 C API 之外，它因為 <code class="xref c c-type docutils literal notranslate"><span class="pre">PyWeakReference</span></code> 結構在受限 C API 中過於晦澀而從未運作。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=35134">bpo-35134</a> 中所貢獻。）</p></li>
<li><p>移除 <code class="docutils literal notranslate"><span class="pre">PyHeapType_GET_MEMBERS()</span></code> 巨集，它是不小心才被放到公開的 C API 中，應該只能被 Python 內部所使用。請改用 <code class="docutils literal notranslate"><span class="pre">PyTypeObject.tp_members</span></code>。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=40170">bpo-40170</a> 中所貢獻。）</p></li>
<li><p>移除 <code class="docutils literal notranslate"><span class="pre">HAVE_PY_SET_53BIT_PRECISION</span></code> 巨集（移動至內部 C API）。（由 Victor Stinner 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=45412">bpo-45412</a> 中所貢獻。）</p></li>
</ul>
<ul id="whatsnew311-pep624">
<li><p>移除 <a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 編碼器 API，它們自從 Python 3.3 就被棄用，非常少用且和推薦的替代方案已無太大關聯。</p>
<p>被移除的函式為：</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_Encode()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeASCII()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeLatin1()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF7()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF8()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF16()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUTF32()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeUnicodeEscape()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeRawUnicodeEscape()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeCharmap()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_TranslateCharmap()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_EncodeDecimal()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">PyUnicode_TransformDecimalToASCII()</span></code></p></li>
</ul>
<p>詳情請見 <span class="target" id="index-120"></span><a class="pep reference external" href="https://peps.python.org/pep-0624/"><strong>PEP 624</strong></a> 與<span class="target" id="index-121"></span><a class="pep reference external" href="https://peps.python.org/pep-0624/#alternative-apis"><strong>搬遷指南</strong></a>。（由 Inada Naoki 於 <a class="reference external" href="https://bugs.python.org/issue?&#64;action=redirect&amp;bpo=44029">bpo-44029</a> 中所貢獻。）</p>
</li>
</ul>
</section>
</section>
<section id="notable-changes-in-3-11-4">
<h2>Notable changes in 3.11.4<a class="headerlink" href="#notable-changes-in-3-11-4" title="連結到這個標頭">¶</a></h2>
<section id="tarfile">
<h3>tarfile<a class="headerlink" href="#tarfile" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>The extraction methods in <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>, and <a class="reference internal" href="../library/shutil.html#shutil.unpack_archive" title="shutil.unpack_archive"><code class="xref py py-func docutils literal notranslate"><span class="pre">shutil.unpack_archive()</span></code></a>,
have a new a <em>filter</em> argument that allows limiting tar features than may be
surprising or dangerous, such as creating files outside the destination
directory.
See <a class="reference internal" href="../library/tarfile.html#tarfile-extraction-filter"><span class="std std-ref">Extraction filters</span></a> for details.
In Python 3.12, use without the <em>filter</em> argument will show a
<a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>.
In Python 3.14, the default will switch to <code class="docutils literal notranslate"><span class="pre">'data'</span></code>.
(Contributed by Petr Viktorin in <span class="target" id="index-41"></span><a class="pep reference external" href="https://peps.python.org/pep-0706/"><strong>PEP 706</strong></a>.)</p></li>
</ul>
</section>
</section>
<section id="notable-changes-in-3-11-5">
<h2>Notable changes in 3.11.5<a class="headerlink" href="#notable-changes-in-3-11-5" title="連結到這個標頭">¶</a></h2>
<section id="openssl">
<h3>OpenSSL<a class="headerlink" href="#openssl" title="連結到這個標頭">¶</a></h3>
<ul class="simple">
<li><p>Windows builds and macOS installers from python.org now use OpenSSL 3.0.</p></li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目錄</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.11 有什麼新功能</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">發布重點摘要</a></li>
<li><a class="reference internal" href="#new-features">新增特性</a><ul>
<li><a class="reference internal" href="#pep-657-fine-grained-error-locations-in-tracebacks">PEP 657：回溯 (traceback) 中更細緻的錯誤位置</a></li>
<li><a class="reference internal" href="#pep-654-exception-groups-and-except">PEP 654：例外群組與 <code class="docutils literal notranslate"><span class="pre">except*</span></code></a></li>
<li><a class="reference internal" href="#pep-678-exceptions-can-be-enriched-with-notes">PEP 678：運用例外註解使其更加詳盡</a></li>
<li><a class="reference internal" href="#windows-py-exe-launcher-improvements">Windows <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> 啟動程式 (launcher) 的改進</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-features-related-to-type-hints">型別提示相關的新特性</a><ul>
<li><a class="reference internal" href="#pep-646-variadic-generics">PEP 646：可變參數泛型 (variadic generics)</a></li>
<li><a class="reference internal" href="#pep-655-marking-individual-typeddict-items-as-required-or-not-required">PEP 655：標記獨立 <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> 項目為必要或不必要</a></li>
<li><a class="reference internal" href="#pep-673-self-type">PEP 673：<code class="docutils literal notranslate"><span class="pre">Self</span></code> 型別</a></li>
<li><a class="reference internal" href="#pep-675-arbitrary-literal-string-type">PEP 675：任意的文本字串型別 (Arbitrary literal string type)</a></li>
<li><a class="reference internal" href="#pep-681-data-class-transforms">PEP 681：資料類別轉換 (Data class transforms)</a></li>
<li><a class="reference internal" href="#pep-563-may-not-be-the-future">PEP 563 可能不是未來</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他語言更動</a></li>
<li><a class="reference internal" href="#other-cpython-implementation-changes">其他 CPython 實作更動</a></li>
<li><a class="reference internal" href="#new-modules">新增模組</a></li>
<li><a class="reference internal" href="#improved-modules">改進的模組</a><ul>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#contextlib">contextlib</a></li>
<li><a class="reference internal" href="#dataclasses">dataclasses</a></li>
<li><a class="reference internal" href="#datetime">datetime</a></li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#fcntl">fcntl</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#gzip">gzip</a></li>
<li><a class="reference internal" href="#hashlib">hashlib</a></li>
<li><a class="reference internal" href="#whatsnew311-idle">IDLE 與 idlelib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#locale">locale</a></li>
<li><a class="reference internal" href="#logging">logging</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#operator">operator</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#string">string</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#sysconfig">sysconfig</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#traceback">traceback</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#venv">venv</a></li>
<li><a class="reference internal" href="#warnings">warnings</a></li>
<li><a class="reference internal" href="#zipfile">zipfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">最佳化</a></li>
<li><a class="reference internal" href="#faster-cpython">更快的 CPython</a><ul>
<li><a class="reference internal" href="#faster-startup">更快的啟動</a><ul>
<li><a class="reference internal" href="#frozen-imports-static-code-objects">凍結引入 (Frozen imports) / 靜態程式碼物件 (Static code objects)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faster-runtime">更快的運行程式</a><ul>
<li><a class="reference internal" href="#cheaper-lazy-python-frames">所需資源更少 (cheaper) 且惰性的 (lazy)) Python 幀 (frame)</a></li>
<li><a class="reference internal" href="#inlined-python-function-calls">行內 Python 函式呼叫</a></li>
<li><a class="reference internal" href="#pep-659-specializing-adaptive-interpreter">PEP 659：特化的適應性直譯器</a></li>
</ul>
</li>
<li><a class="reference internal" href="#misc">雜項</a></li>
<li><a class="reference internal" href="#faq">FAQ</a><ul>
<li><a class="reference internal" href="#how-should-i-write-my-code-to-utilize-these-speedups">我該如何在程式碼中獲取這些加速？</a></li>
<li><a class="reference internal" href="#will-cpython-3-11-use-more-memory">Python 3.11 會不會使用更多記憶體？</a></li>
<li><a class="reference internal" href="#i-don-t-see-any-speedups-in-my-workload-why">我在我的程式當中沒感覺到任何加速，為什麼？</a></li>
<li><a class="reference internal" href="#is-there-a-jit-compiler">有用到 JIT 編譯器嗎？</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about">關於</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 位元組碼 (bytecode) 變更</a><ul>
<li><a class="reference internal" href="#new-opcodes">新增 opcode</a></li>
<li><a class="reference internal" href="#replaced-opcodes">被取代的操作碼 (opcode)</a></li>
<li><a class="reference internal" href="#changed-removed-opcodes">有更動/被移除的 opcode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecated">已棄用</a><ul>
<li><a class="reference internal" href="#language-builtins">語言/內建</a></li>
<li><a class="reference internal" href="#modules">模組</a></li>
<li><a class="reference internal" href="#standard-library">標準函式庫</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pending-removal-in-python-3-12">Python 3.12 中待決議的移除項目</a></li>
<li><a class="reference internal" href="#removed">已移除</a></li>
<li><a class="reference internal" href="#porting-to-python-3-11">移植至 Python 3.11</a></li>
<li><a class="reference internal" href="#build-changes">建置變更</a></li>
<li><a class="reference internal" href="#c-api-changes">C API 變更</a><ul>
<li><a class="reference internal" href="#whatsnew311-c-api-new-features">新增特性</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-porting">移植至 Python 3.11</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-deprecated">已棄用</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-pending-removal">Python 3.12 中待決議的移除項目</a></li>
<li><a class="reference internal" href="#whatsnew311-c-api-removed">已移除</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notable-changes-in-3-11-4">Notable changes in 3.11.4</a><ul>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notable-changes-in-3-11-5">Notable changes in 3.11.5</a><ul>
<li><a class="reference internal" href="#openssl">OpenSSL</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上個主題</h4>
    <p class="topless"><a href="3.12.html"
                          title="上一章">Python 3.12 有什麼新功能</a></p>
  </div>
  <div>
    <h4>下個主題</h4>
    <p class="topless"><a href="3.10.html"
                          title="下一章">Python 3.10 有什麼新功能</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>此頁面</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">回報錯誤</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.11.rst"
            rel="nofollow">顯示原始碼
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="收合側邊欄">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="3.10.html" title="Python 3.10 有什麼新功能"
             >下一頁</a> |</li>
        <li class="right" >
          <a href="3.12.html" title="Python 3.12 有什麼新功能"
             >上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 有什麼新功能？</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.11 有什麼新功能</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="search" name="q" id="search-box" />
          <input type="submit" value="前往" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    版權
    
      </a>
     2001-2024, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="/license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最後更新於 Jul 20, 2024 (06:07 UTC)。
    
      <a href="/bugs.html">Found a bug</a>?
    
    <br />

    使用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.6 建立。
    </div>

  </body>
</html>